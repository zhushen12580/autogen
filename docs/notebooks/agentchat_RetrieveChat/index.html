<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-notebooks/agentchat_RetrieveChat" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Using RetrieveChat for Retrieve Augmented Code Generation and Question Answering | AutoGen</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://microsoft.github.io/autogen/docs/notebooks/agentchat_RetrieveChat"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Using RetrieveChat for Retrieve Augmented Code Generation and Question Answering | AutoGen"><meta data-rh="true" name="description" content="Explore the use of AutoGen&#x27;s RetrieveChat for tasks like code generation from docstrings, answering complex questions with human feedback, and exploiting features like Update Context, custom prompts, and few-shot learning."><meta data-rh="true" property="og:description" content="Explore the use of AutoGen&#x27;s RetrieveChat for tasks like code generation from docstrings, answering complex questions with human feedback, and exploiting features like Update Context, custom prompts, and few-shot learning."><link data-rh="true" rel="icon" href="/autogen/img/ag.ico"><link data-rh="true" rel="canonical" href="https://microsoft.github.io/autogen/docs/notebooks/agentchat_RetrieveChat"><link data-rh="true" rel="alternate" href="https://microsoft.github.io/autogen/docs/notebooks/agentchat_RetrieveChat" hreflang="en"><link data-rh="true" rel="alternate" href="https://microsoft.github.io/autogen/docs/notebooks/agentchat_RetrieveChat" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/autogen/blog/rss.xml" title="AutoGen RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/autogen/blog/atom.xml" title="AutoGen Atom Feed">






<script>!function(e,t,n,c,s,a,r){e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},(a=t.createElement(c)).async=1,a.src="https://www.clarity.ms/tag/lnxpe6skj1",(r=t.getElementsByTagName(c)[0]).parentNode.insertBefore(a,r)}(window,document,"clarity","script")</script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous">
<script src="/autogen/js/custom.js" async defer="defer"></script><link rel="stylesheet" href="/autogen/assets/css/styles.d8ef5d37.css">
<script src="/autogen/assets/js/runtime~main.33d2ca05.js" defer="defer"></script>
<script src="/autogen/assets/js/main.f5c79556.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const a=new URLSearchParams(window.location.search).entries();for(var[t,e]of a)if(t.startsWith("docusaurus-data-")){var n=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(n,e)}}catch(t){}}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="announcementBar_mb4j" style="background-color:#fafbfc;color:#091E42" role="banner"><div class="announcementBarPlaceholder_vyr4"></div><div class="content_knG7 announcementBarContent_xLdY">What's new in AutoGen? Read <a href="/autogen/blog/2024/03/03/AutoGen-Update">this blog</a> for an overview of updates</div><button type="button" aria-label="Close" class="clean-btn close closeButton_CVFx announcementBarClose_gvF7"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/autogen/"><div class="navbar__logo"><img src="/autogen/img/ag.svg" alt="AutoGen" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/autogen/img/ag.svg" alt="AutoGen" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">AutoGen</b></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Docs</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/autogen/docs/Getting-Started">Getting Started</a></li><li><a class="dropdown__link" href="/autogen/docs/installation/">Installation</a></li><li><a class="dropdown__link" href="/autogen/docs/tutorial/introduction">Tutorial</a></li><li><a class="dropdown__link" href="/autogen/docs/topics">User Guide</a></li><li><a class="dropdown__link" href="/autogen/docs/reference/agentchat/conversable_agent">API Reference</a></li><li><a class="dropdown__link" href="/autogen/docs/FAQ">FAQs</a></li><li><a class="dropdown__link" href="/autogen/docs/autogen-studio/getting-started">AutoGen Studio</a></li><li><a class="dropdown__link" href="/autogen/docs/ecosystem">Ecosystem</a></li><li><a class="dropdown__link" href="/autogen/docs/contributor-guide/contributing">Contributor Guide</a></li><li><a class="dropdown__link" href="/autogen/docs/Research">Research</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Examples</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/autogen/docs/Examples">Examples by Category</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/autogen/docs/notebooks">Examples by Notebook</a></li><li><a class="dropdown__link" href="/autogen/docs/Gallery">Application Gallery</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Other Languages</a><ul class="dropdown__menu"><li><a href="https://microsoft.github.io/autogen-for-net/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Dotnet<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a class="navbar__item navbar__link" href="/autogen/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/microsoft/autogen" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://aka.ms/autogen-dc" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://twitter.com/pyautogen" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_Pkmr"><kbd class="searchHint_iIMx">ctrl</kbd><kbd class="searchHint_iIMx">K</kbd></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG menuWithAnnouncementBar_GW3s"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/autogen/docs/notebooks">Notebooks</a><button aria-label="Collapse sidebar category &#x27;Notebooks&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/JSON_mode_example">Mitigating Prompt hacking with JSON Mode in Autogen</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/autogen/docs/notebooks/agentchat_RetrieveChat">Using RetrieveChat for Retrieve Augmented Code Generation and Question Answering</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_RetrieveChat_mongodb">Using RetrieveChat Powered by MongoDB Atlas for Retrieve Augmented Code Generation and Question Answering</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_RetrieveChat_pgvector">Using RetrieveChat Powered by PGVector for Retrieve Augmented Code Generation and Question Answering</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_RetrieveChat_qdrant">Using RetrieveChat with Qdrant for Retrieve Augmented Code Generation and Question Answering</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_agentops">Agent Tracking with AgentOps</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_agentoptimizer">AgentOptimizer: An Agentic Way to Train Your LLM Agent</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_auto_feedback_from_code_execution">Task Solving with Code Generation, Execution and Debugging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_azr_ai_search">Assistants with Azure Cognitive Search and Azure Identity</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_custom_model">Agent Chat with custom model loading</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_databricks_dbrx">Use AutoGen in Databricks with DBRX</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_function_call_async">Task Solving with Provided Tools as Functions (Asynchronous Function Calls)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_function_call_code_writing">Writing a software application using function calls</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_function_call_currency_calculator">Currency Calculator: Task Solving with Provided Tools as Functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_group_chat_with_llamaindex_agents">Groupchat with Llamaindex agents</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_groupchat">Group Chat</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_groupchat_RAG">Group Chat with Retrieval Augmented Generation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_groupchat_customized">Group Chat with Customized Speaker Selection Method</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_groupchat_finite_state_machine">FSM - User can input speaker transition constraints</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_groupchat_research">Perform Research with Multi-Agent Group Chat</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_groupchat_stateflow">StateFlow: Build Workflows through State-Oriented Actions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_groupchat_vis">Group Chat with Coder and Visualization Critic</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_image_generation_capability">Generate Dalle Images With Conversable Agents</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_lmm_gpt-4v">Engaging with Multimodal Models: GPT-4V in AutoGen</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_logging">Runtime Logging with AutoGen</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_multi_task_async_chats">Solving Multiple Tasks in a Sequence of Async Chats</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_multi_task_chats">Solving Multiple Tasks in a Sequence of Chats</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_nested_chats_chess">Nested Chats for Tool Use in Conversational Chess</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_nested_chats_chess_altmodels">Conversational Chess using non-OpenAI clients</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_nested_sequential_chats">Solving Complex Tasks with A Sequence of Nested Chats</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_nestedchat">Solving Complex Tasks with Nested Chats</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_nestedchat_optiguide">OptiGuide with Nested Chats in AutoGen</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_oai_assistant_function_call">Chat with OpenAI Assistant using function call in AutoGen: OSS Insights for Advanced GitHub Data Analysis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_oai_assistant_groupchat">Auto Generated Agent Chat: Group Chat with GPTAssistantAgent</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_oai_code_interpreter">Auto Generated Agent Chat: GPTAssistant with Code Interpreter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_society_of_mind">SocietyOfMindAgent</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_teachability">Chatting with a teachable agent</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_teaching">Auto Generated Agent Chat: Teaching</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_transform_messages">Preprocessing Chat History with `TransformMessages`</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_video_transcript_translate_with_whisper">Translating Video audio using Whisper and GPT-3.5-turbo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_webscraping_with_apify">Web Scraping using Apify Tools</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchat_websockets">Websockets: Streaming input and output using websockets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/agentchats_sequential_chats">Solving Multiple Tasks in a Sequence of Chats with Different Conversable Agent Pairs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/autogen/docs/notebooks/gpt_assistant_agent_function_call">From Dad Jokes To Sad Jokes: Function Calling with GPTAssistantAgent</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/autogen/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/autogen/docs/notebooks"><span itemprop="name">Notebooks</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Using RetrieveChat for Retrieve Augmented Code Generation and Question Answering</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Using RetrieveChat for Retrieve Augmented Code Generation and Question Answering</h1>
<p><a href="https://colab.research.google.com/github/microsoft/autogen/blob/main/notebook/agentchat_RetrieveChat.ipynb" target="_blank" rel="noopener noreferrer"><img decoding="async" loading="lazy" src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab" class="img_ev3q"></a>
<a href="https://github.com/microsoft/autogen/blob/main/notebook/agentchat_RetrieveChat.ipynb" target="_blank" rel="noopener noreferrer"><img decoding="async" loading="lazy" src="https://img.shields.io/badge/Open%20on%20GitHub-grey?logo=github" alt="Open on GitHub" class="img_ev3q"></a></p>
<p>AutoGen offers conversable agents powered by LLM, tool or human, which
can be used to perform tasks collectively via automated chat. This
framework allows tool use and human participation through multi-agent
conversation. Please find documentation about this feature
<a href="https://microsoft.github.io/autogen/docs/Use-Cases/agent_chat" target="_blank" rel="noopener noreferrer">here</a>.</p>
<p>RetrieveChat is a conversational system for retrieval-augmented code
generation and question answering. In this notebook, we demonstrate how
to utilize RetrieveChat to generate code and answer questions based on
customized documentations that are not present in the LLM’s training
dataset. RetrieveChat uses the <code>AssistantAgent</code> and
<code>RetrieveUserProxyAgent</code>, which is similar to the usage of
<code>AssistantAgent</code> and <code>UserProxyAgent</code> in other notebooks (e.g.,
<a href="https://github.com/microsoft/autogen/blob/main/notebook/agentchat_auto_feedback_from_code_execution.ipynb" target="_blank" rel="noopener noreferrer">Automated Task Solving with Code Generation, Execution &amp;
Debugging</a>).
Essentially, <code>RetrieveUserProxyAgent</code> implement a different auto-reply
mechanism corresponding to the RetrieveChat prompts.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="table-of-contents">Table of Contents<a href="#table-of-contents" class="hash-link" aria-label="Direct link to Table of Contents" title="Direct link to Table of Contents">​</a></h2>
<p>We’ll demonstrate six examples of using RetrieveChat for code generation
and question answering:</p>
<ul>
<li><a href="#example-1">Example 1: Generate code based off docstrings w/o human
feedback</a></li>
<li><a href="#example-2">Example 2: Answer a question based off docstrings w/o human
feedback</a></li>
<li><a href="#example-3">Example 3: Generate code based off docstrings w/ human
feedback</a></li>
<li><a href="#example-4">Example 4: Answer a question based off docstrings w/ human
feedback</a></li>
<li><a href="#example-5">Example 5: Solve comprehensive QA problems with RetrieveChat’s
unique feature <code>Update Context</code></a></li>
<li><a href="#example-6">Example 6: Solve comprehensive QA problems with customized prompt
and few-shot learning</a></li>
</ul>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Requirements</div><div class="admonitionContent_BuS1"><p>Some extra dependencies are needed for this notebook, which can be installed via pip:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">pip install pyautogen[retrievechat] flaml[automl]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>For more information, please refer to the <a href="/autogen/docs/installation/">installation guide</a>.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="set-your-api-endpoint">Set your API Endpoint<a href="#set-your-api-endpoint" class="hash-link" aria-label="Direct link to Set your API Endpoint" title="Direct link to Set your API Endpoint">​</a></h2>
<p>The
<a href="https://microsoft.github.io/autogen/docs/reference/oai/openai_utils#config_list_from_json" target="_blank" rel="noopener noreferrer"><code>config_list_from_json</code></a>
function loads a list of configurations from an environment variable or
a json file.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> json</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> chromadb</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> autogen</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> autogen </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> AssistantAgent</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> autogen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">agentchat</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">contrib</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">retrieve_user_proxy_agent </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> RetrieveUserProxyAgent</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Accepted file formats for that can be stored in</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># a vector database instance</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> autogen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">retrieve_utils </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> TEXT_FORMATS</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">config_list </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> autogen</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">config_list_from_json</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;OAI_CONFIG_LIST&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">assert</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">len</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">config_list</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;models to use: &quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">config_list</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;model&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> i </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">range</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token builtin" style="color:rgb(130, 170, 255)">len</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">config_list</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">models to use:  [&#x27;gpt-35-turbo&#x27;, &#x27;gpt4-1106-preview&#x27;, &#x27;gpt-4o&#x27;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Learn more about configuring LLMs for agents <a href="/autogen/docs/topics/llm_configuration">here</a>.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="construct-agents-for-retrievechat">Construct agents for RetrieveChat<a href="#construct-agents-for-retrievechat" class="hash-link" aria-label="Direct link to Construct agents for RetrieveChat" title="Direct link to Construct agents for RetrieveChat">​</a></h2>
<p>We start by initializing the <code>AssistantAgent</code> and
<code>RetrieveUserProxyAgent</code>. The system message needs to be set to “You are
a helpful assistant.” for AssistantAgent. The detailed instructions are
given in the user message. Later we will use the
<code>RetrieveUserProxyAgent.message_generator</code> to combine the instructions
and a retrieval augmented generation task for an initial prompt to be
sent to the LLM assistant.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Accepted file formats for `docs_path`:&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">TEXT_FORMATS</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Accepted file formats for `docs_path`:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[&#x27;txt&#x27;, &#x27;json&#x27;, &#x27;csv&#x27;, &#x27;tsv&#x27;, &#x27;md&#x27;, &#x27;html&#x27;, &#x27;htm&#x27;, &#x27;rtf&#x27;, &#x27;rst&#x27;, &#x27;jsonl&#x27;, &#x27;log&#x27;, &#x27;xml&#x27;, &#x27;yaml&#x27;, &#x27;yml&#x27;, &#x27;pdf&#x27;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 1. create an AssistantAgent instance named &quot;assistant&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">assistant </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> AssistantAgent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;assistant&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    system_message</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;You are a helpful assistant.&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    llm_config</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;timeout&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">600</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;cache_seed&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">42</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;config_list&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> config_list</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 2. create the RetrieveUserProxyAgent instance named &quot;ragproxyagent&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Refer to https://microsoft.github.io/autogen/docs/reference/agentchat/contrib/retrieve_user_proxy_agent</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># and https://microsoft.github.io/autogen/docs/reference/agentchat/contrib/vectordb/chromadb</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># for more information on the RetrieveUserProxyAgent and ChromaVectorDB</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ragproxyagent </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> RetrieveUserProxyAgent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ragproxyagent&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    human_input_mode</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;NEVER&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    max_consecutive_auto_reply</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    retrieve_config</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;task&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;code&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;docs_path&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://raw.githubusercontent.com/microsoft/FLAML/main/website/docs/Examples/Integrate%20-%20Spark.md&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://raw.githubusercontent.com/microsoft/FLAML/main/website/docs/Research.md&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;chunk_token_size&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2000</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;model&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> config_list</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;model&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;vector_db&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;chroma&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;overwrite&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">False</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># set to True if you want to overwrite an existing collection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;get_or_create&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">True</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># set to False if don&#x27;t want to reuse an existing collection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    code_execution_config</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">False</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># set to False if you don&#x27;t want to execute the code</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">/workspace/anaconda3/envs/autogen312/lib/python3.12/site-packages/sentence_transformers/cross_encoder/CrossEncoder.py:11: TqdmExperimentalWarning: Using `tqdm.autonotebook.tqdm` in notebook mode. Use `tqdm.tqdm` instead to force console mode (e.g. in jupyter console)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  from tqdm.autonotebook import tqdm, trange</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-1">Example 1<a href="#example-1" class="hash-link" aria-label="Direct link to Example 1" title="Direct link to Example 1">​</a></h3>
<p><a href="#table-of-contents">Back to top</a></p>
<p>Use RetrieveChat to help generate sample code and automatically run the
code and fix errors if there is any.</p>
<p>Problem: Which API should I use if I want to use FLAML for a
classification task and I want to train the model in 30 seconds. Use
spark to parallel the training. Force cancel jobs if time limit is
reached.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># reset the assistant. Always reset the assistant before starting a new conversation.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">assistant</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">reset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># given a problem, we use the ragproxyagent to generate a prompt to be sent to the assistant as the initial message.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># the assistant receives the message and generates a response. The response will be sent back to the ragproxyagent for processing.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># The conversation continues until the termination condition is met, in RetrieveChat, the termination condition when no human-in-loop is no code block detected.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># With human-in-loop, the conversation will continue until the user says &quot;exit&quot;.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">code_problem </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;How can I use FLAML to perform a classification task and use spark to do parallel training. Train 30 seconds and force cancel jobs if time limit is reached.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">chat_result </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ragproxyagent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">initiate_chat</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    assistant</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> message</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">ragproxyagent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">message_generator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> problem</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">code_problem</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> search_string</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;spark&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># search_string is used as an extra filter for the embeddings search, in this case, we only want to search documents that contain &quot;spark&quot;.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">2024-08-14 06:22:06,884 - autogen.agentchat.contrib.retrieve_user_proxy_agent - INFO - Use the existing collection `autogen-docs`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2024-08-14 06:22:07,353 - autogen.agentchat.contrib.retrieve_user_proxy_agent - INFO - Found 2 chunks.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Number of requested results 20 is greater than number of elements in index 2, updating n_results = 2</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Number of requested results 60 is greater than number of elements in index 2, updating n_results = 2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Trying to create collection.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">VectorDB returns doc_ids:  [[&#x27;bdfbc921&#x27;]]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding content of doc bdfbc921 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You&#x27;re a retrieve augmented coding assistant. You answer user&#x27;s questions based on your own knowledge and the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">context provided by the user.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">If you can&#x27;t answer the question with or without the current context, you should reply exactly `UPDATE CONTEXT`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">For code generation, you must obey the following rules:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Rule 1. You MUST NOT install any packages because all the packages needed are already installed.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Rule 2. You must follow the formats below to write your code:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```language</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># your code</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">User&#x27;s question is: How can I use FLAML to perform a classification task and use spark to do parallel training. Train 30 seconds and force cancel jobs if time limit is reached.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context is: # Integrate - Spark</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">FLAML has integrated Spark for distributed training. There are two main aspects of integration with Spark:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- Use Spark ML estimators for AutoML.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- Use Spark to run training in parallel spark jobs.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## Spark ML Estimators</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">FLAML integrates estimators based on Spark ML models. These models are trained in parallel using Spark, so we called them Spark estimators. To use these models, you first need to organize your data in the required format.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">### Data</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">For Spark estimators, AutoML only consumes Spark data. FLAML provides a convenient function `to_pandas_on_spark` in the `flaml.automl.spark.utils` module to convert your data into a pandas-on-spark (`pyspark.pandas`) dataframe/series, which Spark estimators require.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">This utility function takes data in the form of a `pandas.Dataframe` or `pyspark.sql.Dataframe` and converts it into a pandas-on-spark dataframe. It also takes `pandas.Series` or `pyspark.sql.Dataframe` and converts it into a [pandas-on-spark](https://spark.apache.org/docs/latest/api/python/user_guide/pandas_on_spark/index.html) series. If you pass in a `pyspark.pandas.Dataframe`, it will not make any changes.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">This function also accepts optional arguments `index_col` and `default_index_type`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- `index_col` is the column name to use as the index, default is None.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- `default_index_type` is the default index type, default is &quot;distributed-sequence&quot;. More info about default index type could be found on Spark official [documentation](https://spark.apache.org/docs/latest/api/python/user_guide/pandas_on_spark/options.html#default-index-type)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Here is an example code snippet for Spark Data:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```python</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import pandas as pd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from flaml.automl.spark.utils import to_pandas_on_spark</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Creating a dictionary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">data = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;Square_Feet&quot;: [800, 1200, 1800, 1500, 850],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;Age_Years&quot;: [20, 15, 10, 7, 25],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;Price&quot;: [100000, 200000, 300000, 240000, 120000],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Creating a pandas DataFrame</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">dataframe = pd.DataFrame(data)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">label = &quot;Price&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Convert to pandas-on-spark dataframe</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">psdf = to_pandas_on_spark(dataframe)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">To use Spark ML models you need to format your data appropriately. Specifically, use [`VectorAssembler`](https://spark.apache.org/docs/latest/api/python/reference/api/pyspark.ml.feature.VectorAssembler.html) to merge all feature columns into a single vector column.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Here is an example of how to use it:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```python</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from pyspark.ml.feature import VectorAssembler</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">columns = psdf.columns</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">feature_cols = [col for col in columns if col != label]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">featurizer = VectorAssembler(inputCols=feature_cols, outputCol=&quot;features&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">psdf = featurizer.transform(psdf.to_spark(index_col=&quot;index&quot;))[&quot;index&quot;, &quot;features&quot;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Later in conducting the experiment, use your pandas-on-spark data like non-spark data and pass them using `X_train, y_train` or `dataframe, label`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">### Estimators</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#### Model List</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- `lgbm_spark`: The class for fine-tuning Spark version LightGBM models, using [SynapseML](https://microsoft.github.io/SynapseML/docs/features/lightgbm/about/) API.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#### Usage</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">First, prepare your data in the required format as described in the previous section.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">By including the models you intend to try in the `estimators_list` argument to `flaml.automl`, FLAML will start trying configurations for these models. If your input is Spark data, FLAML will also use estimators with the `_spark` postfix by default, even if you haven&#x27;t specified them.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Here is an example code snippet using SparkML models in AutoML:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```python</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import flaml</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># prepare your data in pandas-on-spark format as we previously mentioned</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl = flaml.AutoML()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">settings = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;time_budget&quot;: 30,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;metric&quot;: &quot;r2&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;estimator_list&quot;: [&quot;lgbm_spark&quot;],  # this setting is optional</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;task&quot;: &quot;regression&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl.fit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    dataframe=psdf,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    label=label,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    **settings,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[Link to notebook](https://github.com/microsoft/FLAML/blob/main/notebook/automl_bankrupt_synapseml.ipynb) | [Open in colab](https://colab.research.google.com/github/microsoft/FLAML/blob/main/notebook/automl_bankrupt_synapseml.ipynb)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## Parallel Spark Jobs</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You can activate Spark as the parallel backend during parallel tuning in both [AutoML](/docs/Use-Cases/Task-Oriented-AutoML#parallel-tuning) and [Hyperparameter Tuning](/docs/Use-Cases/Tune-User-Defined-Function#parallel-tuning), by setting the `use_spark` to `true`. FLAML will dispatch your job to the distributed Spark backend using [`joblib-spark`](https://github.com/joblib/joblib-spark).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Please note that you should not set `use_spark` to `true` when applying AutoML and Tuning for Spark Data. This is because only SparkML models will be used for Spark Data in AutoML and Tuning. As SparkML models run in parallel, there is no need to distribute them with `use_spark` again.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">All the Spark-related arguments are stated below. These arguments are available in both Hyperparameter Tuning and AutoML:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- `use_spark`: boolean, default=False | Whether to use spark to run the training in parallel spark jobs. This can be used to accelerate training on large models and large datasets, but will incur more overhead in time and thus slow down training in some cases. GPU training is not supported yet when use_spark is True. For Spark clusters, by default, we will launch one trial per executor. However, sometimes we want to launch more trials than the number of executors (e.g., local mode). In this case, we can set the environment variable `FLAML_MAX_CONCURRENT` to override the detected `num_executors`. The final number of concurrent trials will be the minimum of `n_concurrent_trials` and `num_executors`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- `n_concurrent_trials`: int, default=1 | The number of concurrent trials. When n_concurrent_trials &gt; 1, FLAML performes parallel tuning.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- `force_cancel`: boolean, default=False | Whether to forcely cancel Spark jobs if the search time exceeded the time budget. Spark jobs include parallel tuning jobs and Spark-based model training jobs.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">An example code snippet for using parallel Spark jobs:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```python</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import flaml</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl_experiment = flaml.AutoML()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl_settings = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;time_budget&quot;: 30,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;metric&quot;: &quot;r2&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;task&quot;: &quot;regression&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;n_concurrent_trials&quot;: 2,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;use_spark&quot;: True,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;force_cancel&quot;: True,  # Activating the force_cancel option can immediately halt Spark jobs once they exceed the allocated time_budget.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl.fit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    dataframe=dataframe,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    label=label,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    **automl_settings,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[Link to notebook](https://github.com/microsoft/FLAML/blob/main/notebook/integrate_spark.ipynb) | [Open in colab](https://colab.research.google.com/github/microsoft/FLAML/blob/main/notebook/integrate_spark.ipynb)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```python</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import flaml</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from flaml.automl.spark.utils import to_pandas_on_spark</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from pyspark.ml.feature import VectorAssembler</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import pandas as pd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Example Data (Please provide real data in practice)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">data = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;feature1&quot;: [0, 1, 2, 3, 4],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;feature2&quot;: [1, 2, 3, 4, 5],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    # ... add all features you need for your classification</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;label&quot;: [&#x27;a&#x27;, &#x27;b&#x27;, &#x27;a&#x27;, &#x27;a&#x27;, &#x27;b&#x27;],  # assuming binary classification with labels &#x27;a&#x27; and &#x27;b&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Convert to Pandas DataFrame</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pdf = pd.DataFrame(data)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Generate pandas-on-spark dataframe</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">psdf = to_pandas_on_spark(pdf)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Organize data into feature vectors and labels</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">label_col = &quot;label&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">feature_cols = [col for col in psdf.columns if col != label_col]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">featurizer = VectorAssembler(inputCols=feature_cols, outputCol=&quot;features&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Apply the transformation</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">psdf = featurizer.transform(psdf.to_spark(index_col=&quot;index&quot;))[&quot;index&quot;, &quot;features&quot;, label_col]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Prepare AutoML settings</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl_settings = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;time_budget&quot;: 30,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;metric&quot;: &quot;accuracy&quot;,  # Change this to a classification metric you prefer</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;task&quot;: &quot;classification&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;n_concurrent_trials&quot;: 2,  # Or other number that fits your Spark cluster configuration</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;use_spark&quot;: True,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;force_cancel&quot;: True,  # Enable force cancel to obey the time constraint</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;estimator_list&quot;: [&quot;lgbm_spark&quot;],  # Specify SparkML estimators you want to try</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Create an AutoML instance</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl = flaml.AutoML()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Run the AutoML search</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl.fit(dataframe=psdf, label=label_col, **automl_settings)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">``` </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Remember to replace the example data with your real dataset and choose an appropriate metric for your classification task. You&#x27;ll also need a configured and running Spark environment to utilize the &quot;use_spark&quot; feature.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">UPDATE CONTEXT</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Updating context and resetting conversation.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">VectorDB returns doc_ids:  [[&#x27;bdfbc921&#x27;]]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">No more context, will terminate.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin" style="color:rgb(130, 170, 255)">TERMINATE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token builtin" style="color:rgb(130, 170, 255)">TERMINATE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-2">Example 2<a href="#example-2" class="hash-link" aria-label="Direct link to Example 2" title="Direct link to Example 2">​</a></h3>
<p><a href="#table-of-contents">Back to top</a></p>
<p>Use RetrieveChat to answer a question that is not related to code
generation.</p>
<p>Problem: Who is the author of FLAML?</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># reset the assistant. Always reset the assistant before starting a new conversation.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">assistant</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">reset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">qa_problem </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Who is the author of FLAML?&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">chat_result </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ragproxyagent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">initiate_chat</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">assistant</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> message</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">ragproxyagent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">message_generator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> problem</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">qa_problem</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Number of requested results 20 is greater than number of elements in index 2, updating n_results = 2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">VectorDB returns doc_ids:  [[&#x27;7968cf3c&#x27;, &#x27;bdfbc921&#x27;]]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding content of doc 7968cf3c to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding content of doc bdfbc921 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You&#x27;re a retrieve augmented coding assistant. You answer user&#x27;s questions based on your own knowledge and the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">context provided by the user.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">If you can&#x27;t answer the question with or without the current context, you should reply exactly `UPDATE CONTEXT`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">For code generation, you must obey the following rules:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Rule 1. You MUST NOT install any packages because all the packages needed are already installed.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Rule 2. You must follow the formats below to write your code:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```language</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># your code</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">User&#x27;s question is: Who is the author of FLAML?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context is: # Research</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">For technical details, please check our research publications.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- [FLAML: A Fast and Lightweight AutoML Library](https://www.microsoft.com/en-us/research/publication/flaml-a-fast-and-lightweight-automl-library/). Chi Wang, Qingyun Wu, Markus Weimer, Erkang Zhu. MLSys 2021.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{wang2021flaml,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={FLAML: A Fast and Lightweight AutoML Library},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Chi Wang and Qingyun Wu and Markus Weimer and Erkang Zhu},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2021},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={MLSys},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- [Frugal Optimization for Cost-related Hyperparameters](https://arxiv.org/abs/2005.01571). Qingyun Wu, Chi Wang, Silu Huang. AAAI 2021.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{wu2021cfo,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={Frugal Optimization for Cost-related Hyperparameters},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Qingyun Wu and Chi Wang and Silu Huang},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2021},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={AAAI},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- [Economical Hyperparameter Optimization With Blended Search Strategy](https://www.microsoft.com/en-us/research/publication/economical-hyperparameter-optimization-with-blended-search-strategy/). Chi Wang, Qingyun Wu, Silu Huang, Amin Saied. ICLR 2021.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{wang2021blendsearch,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={Economical Hyperparameter Optimization With Blended Search Strategy},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Chi Wang and Qingyun Wu and Silu Huang and Amin Saied},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2021},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={ICLR},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- [An Empirical Study on Hyperparameter Optimization for Fine-Tuning Pre-trained Language Models](https://aclanthology.org/2021.acl-long.178.pdf). Susan Xueqing Liu, Chi Wang. ACL 2021.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{liuwang2021hpolm,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={An Empirical Study on Hyperparameter Optimization for Fine-Tuning Pre-trained Language Models},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Susan Xueqing Liu and Chi Wang},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2021},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={ACL},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- [ChaCha for Online AutoML](https://www.microsoft.com/en-us/research/publication/chacha-for-online-automl/). Qingyun Wu, Chi Wang, John Langford, Paul Mineiro and Marco Rossi. ICML 2021.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{wu2021chacha,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={ChaCha for Online AutoML},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Qingyun Wu and Chi Wang and John Langford and Paul Mineiro and Marco Rossi},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2021},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={ICML},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- [Fair AutoML](https://arxiv.org/abs/2111.06495). Qingyun Wu, Chi Wang. ArXiv preprint arXiv:2111.06495 (2021).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{wuwang2021fairautoml,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={Fair AutoML},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Qingyun Wu and Chi Wang},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2021},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={ArXiv preprint arXiv:2111.06495},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- [Mining Robust Default Configurations for Resource-constrained AutoML](https://arxiv.org/abs/2202.09927). Moe Kayali, Chi Wang. ArXiv preprint arXiv:2202.09927 (2022).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{kayaliwang2022default,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={Mining Robust Default Configurations for Resource-constrained AutoML},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Moe Kayali and Chi Wang},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2022},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={ArXiv preprint arXiv:2202.09927},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- [Targeted Hyperparameter Optimization with Lexicographic Preferences Over Multiple Objectives](https://openreview.net/forum?id=0Ij9_q567Ma). Shaokun Zhang, Feiran Jia, Chi Wang, Qingyun Wu. ICLR 2023 (notable-top-5%).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{zhang2023targeted,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={Targeted Hyperparameter Optimization with Lexicographic Preferences Over Multiple Objectives},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Shaokun Zhang and Feiran Jia and Chi Wang and Qingyun Wu},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={International Conference on Learning Representations},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2023},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    url={https://openreview.net/forum?id=0Ij9_q567Ma},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- [Cost-Effective Hyperparameter Optimization for Large Language Model Generation Inference](https://arxiv.org/abs/2303.04673). Chi Wang, Susan Xueqing Liu, Ahmed H. Awadallah. ArXiv preprint arXiv:2303.04673 (2023).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{wang2023EcoOptiGen,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={Cost-Effective Hyperparameter Optimization for Large Language Model Generation Inference},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Chi Wang and Susan Xueqing Liu and Ahmed H. Awadallah},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2023},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={ArXiv preprint arXiv:2303.04673},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- [An Empirical Study on Challenging Math Problem Solving with GPT-4](https://arxiv.org/abs/2306.01337). Yiran Wu, Feiran Jia, Shaokun Zhang, Hangyu Li, Erkang Zhu, Yue Wang, Yin Tat Lee, Richard Peng, Qingyun Wu, Chi Wang. ArXiv preprint arXiv:2306.01337 (2023).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{wu2023empirical,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={An Empirical Study on Challenging Math Problem Solving with GPT-4},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Yiran Wu and Feiran Jia and Shaokun Zhang and Hangyu Li and Erkang Zhu and Yue Wang and Yin Tat Lee and Richard Peng and Qingyun Wu and Chi Wang},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2023},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={ArXiv preprint arXiv:2306.01337},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Integrate - Spark</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">FLAML has integrated Spark for distributed training. There are two main aspects of integration with Spark:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- Use Spark ML estimators for AutoML.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- Use Spark to run training in parallel spark jobs.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## Spark ML Estimators</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">FLAML integrates estimators based on Spark ML models. These models are trained in parallel using Spark, so we called them Spark estimators. To use these models, you first need to organize your data in the required format.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">### Data</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">For Spark estimators, AutoML only consumes Spark data. FLAML provides a convenient function `to_pandas_on_spark` in the `flaml.automl.spark.utils` module to convert your data into a pandas-on-spark (`pyspark.pandas`) dataframe/series, which Spark estimators require.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">This utility function takes data in the form of a `pandas.Dataframe` or `pyspark.sql.Dataframe` and converts it into a pandas-on-spark dataframe. It also takes `pandas.Series` or `pyspark.sql.Dataframe` and converts it into a [pandas-on-spark](https://spark.apache.org/docs/latest/api/python/user_guide/pandas_on_spark/index.html) series. If you pass in a `pyspark.pandas.Dataframe`, it will not make any changes.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">This function also accepts optional arguments `index_col` and `default_index_type`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- `index_col` is the column name to use as the index, default is None.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- `default_index_type` is the default index type, default is &quot;distributed-sequence&quot;. More info about default index type could be found on Spark official [documentation](https://spark.apache.org/docs/latest/api/python/user_guide/pandas_on_spark/options.html#default-index-type)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Here is an example code snippet for Spark Data:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```python</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import pandas as pd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from flaml.automl.spark.utils import to_pandas_on_spark</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Creating a dictionary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">data = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;Square_Feet&quot;: [800, 1200, 1800, 1500, 850],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;Age_Years&quot;: [20, 15, 10, 7, 25],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;Price&quot;: [100000, 200000, 300000, 240000, 120000],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Creating a pandas DataFrame</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">dataframe = pd.DataFrame(data)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">label = &quot;Price&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Convert to pandas-on-spark dataframe</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">psdf = to_pandas_on_spark(dataframe)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">To use Spark ML models you need to format your data appropriately. Specifically, use [`VectorAssembler`](https://spark.apache.org/docs/latest/api/python/reference/api/pyspark.ml.feature.VectorAssembler.html) to merge all feature columns into a single vector column.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Here is an example of how to use it:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```python</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from pyspark.ml.feature import VectorAssembler</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">columns = psdf.columns</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">feature_cols = [col for col in columns if col != label]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">featurizer = VectorAssembler(inputCols=feature_cols, outputCol=&quot;features&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">psdf = featurizer.transform(psdf.to_spark(index_col=&quot;index&quot;))[&quot;index&quot;, &quot;features&quot;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Later in conducting the experiment, use your pandas-on-spark data like non-spark data and pass them using `X_train, y_train` or `dataframe, label`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">### Estimators</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#### Model List</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- `lgbm_spark`: The class for fine-tuning Spark version LightGBM models, using [SynapseML](https://microsoft.github.io/SynapseML/docs/features/lightgbm/about/) API.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#### Usage</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">First, prepare your data in the required format as described in the previous section.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">By including the models you intend to try in the `estimators_list` argument to `flaml.automl`, FLAML will start trying configurations for these models. If your input is Spark data, FLAML will also use estimators with the `_spark` postfix by default, even if you haven&#x27;t specified them.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Here is an example code snippet using SparkML models in AutoML:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```python</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import flaml</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># prepare your data in pandas-on-spark format as we previously mentioned</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl = flaml.AutoML()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">settings = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;time_budget&quot;: 30,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;metric&quot;: &quot;r2&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;estimator_list&quot;: [&quot;lgbm_spark&quot;],  # this setting is optional</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;task&quot;: &quot;regression&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl.fit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    dataframe=psdf,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    label=label,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    **settings,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[Link to notebook](https://github.com/microsoft/FLAML/blob/main/notebook/automl_bankrupt_synapseml.ipynb) | [Open in colab](https://colab.research.google.com/github/microsoft/FLAML/blob/main/notebook/automl_bankrupt_synapseml.ipynb)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## Parallel Spark Jobs</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You can activate Spark as the parallel backend during parallel tuning in both [AutoML](/docs/Use-Cases/Task-Oriented-AutoML#parallel-tuning) and [Hyperparameter Tuning](/docs/Use-Cases/Tune-User-Defined-Function#parallel-tuning), by setting the `use_spark` to `true`. FLAML will dispatch your job to the distributed Spark backend using [`joblib-spark`](https://github.com/joblib/joblib-spark).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Please note that you should not set `use_spark` to `true` when applying AutoML and Tuning for Spark Data. This is because only SparkML models will be used for Spark Data in AutoML and Tuning. As SparkML models run in parallel, there is no need to distribute them with `use_spark` again.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">All the Spark-related arguments are stated below. These arguments are available in both Hyperparameter Tuning and AutoML:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- `use_spark`: boolean, default=False | Whether to use spark to run the training in parallel spark jobs. This can be used to accelerate training on large models and large datasets, but will incur more overhead in time and thus slow down training in some cases. GPU training is not supported yet when use_spark is True. For Spark clusters, by default, we will launch one trial per executor. However, sometimes we want to launch more trials than the number of executors (e.g., local mode). In this case, we can set the environment variable `FLAML_MAX_CONCURRENT` to override the detected `num_executors`. The final number of concurrent trials will be the minimum of `n_concurrent_trials` and `num_executors`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- `n_concurrent_trials`: int, default=1 | The number of concurrent trials. When n_concurrent_trials &gt; 1, FLAML performes parallel tuning.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- `force_cancel`: boolean, default=False | Whether to forcely cancel Spark jobs if the search time exceeded the time budget. Spark jobs include parallel tuning jobs and Spark-based model training jobs.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">An example code snippet for using parallel Spark jobs:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```python</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import flaml</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl_experiment = flaml.AutoML()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl_settings = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;time_budget&quot;: 30,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;metric&quot;: &quot;r2&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;task&quot;: &quot;regression&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;n_concurrent_trials&quot;: 2,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;use_spark&quot;: True,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;force_cancel&quot;: True,  # Activating the force_cancel option can immediately halt Spark jobs once they exceed the allocated time_budget.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl.fit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    dataframe=dataframe,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    label=label,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    **automl_settings,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[Link to notebook](https://github.com/microsoft/FLAML/blob/main/notebook/integrate_spark.ipynb) | [Open in colab](https://colab.research.google.com/github/microsoft/FLAML/blob/main/notebook/integrate_spark.ipynb)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">The authors of FLAML (Fast and Lightweight AutoML) as mentioned in the provided context are Chi Wang, Qingyun Wu, Markus Weimer, and Erkang Zhu. They are listed as the authors of the publication titled &quot;FLAML: A Fast and Lightweight AutoML Library&quot; which appeared in MLSys 2021.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">The authors of FLAML (Fast and Lightweight AutoML) as mentioned in the provided context are Chi Wang, Qingyun Wu, Markus Weimer, and Erkang Zhu. They are listed as the authors of the publication titled &quot;FLAML: A Fast and Lightweight AutoML Library&quot; which appeared in MLSys 2021.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-3">Example 3<a href="#example-3" class="hash-link" aria-label="Direct link to Example 3" title="Direct link to Example 3">​</a></h3>
<p><a href="#table-of-contents">Back to top</a></p>
<p>Use RetrieveChat to help generate sample code and ask for human-in-loop
feedbacks.</p>
<p>Problem: how to build a time series forecasting model for stock price
using FLAML?</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># reset the assistant. Always reset the assistant before starting a new conversation.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">assistant</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">reset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># set `human_input_mode` to be `ALWAYS`, so the agent will ask for human input at every step.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ragproxyagent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">human_input_mode </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ALWAYS&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">code_problem </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;how to build a time series forecasting model for stock price using FLAML?&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">chat_result </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ragproxyagent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">initiate_chat</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">assistant</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> message</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">ragproxyagent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">message_generator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> problem</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">code_problem</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">WARNING:chromadb.segment.impl.vector.local_persistent_hnsw:Number of requested results 20 is greater than number of elements in index 2, updating n_results = 2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">doc_ids:  [[&#x27;doc_0&#x27;, &#x27;doc_1&#x27;]]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_0 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_1 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You&#x27;re a retrieve augmented coding assistant. You answer user&#x27;s questions based on your own knowledge and the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">context provided by the user.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">If you can&#x27;t answer the question with or without the current context, you should reply exactly `UPDATE CONTEXT`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">For code generation, you must obey the following rules:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Rule 1. You MUST NOT install any packages because all the packages needed are already installed.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Rule 2. You must follow the formats below to write your code:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```language</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># your code</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">User&#x27;s question is: how to build a time series forecasting model for stock price using FLAML?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context is: # Integrate - Spark</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">FLAML has integrated Spark for distributed training. There are two main aspects of integration with Spark:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- Use Spark ML estimators for AutoML.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- Use Spark to run training in parallel spark jobs.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## Spark ML Estimators</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">FLAML integrates estimators based on Spark ML models. These models are trained in parallel using Spark, so we called them Spark estimators. To use these models, you first need to organize your data in the required format.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">### Data</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">For Spark estimators, AutoML only consumes Spark data. FLAML provides a convenient function `to_pandas_on_spark` in the `flaml.automl.spark.utils` module to convert your data into a pandas-on-spark (`pyspark.pandas`) dataframe/series, which Spark estimators require.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">This utility function takes data in the form of a `pandas.Dataframe` or `pyspark.sql.Dataframe` and converts it into a pandas-on-spark dataframe. It also takes `pandas.Series` or `pyspark.sql.Dataframe` and converts it into a [pandas-on-spark](https://spark.apache.org/docs/latest/api/python/user_guide/pandas_on_spark/index.html) series. If you pass in a `pyspark.pandas.Dataframe`, it will not make any changes.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">This function also accepts optional arguments `index_col` and `default_index_type`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- `index_col` is the column name to use as the index, default is None.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- `default_index_type` is the default index type, default is &quot;distributed-sequence&quot;. More info about default index type could be found on Spark official [documentation](https://spark.apache.org/docs/latest/api/python/user_guide/pandas_on_spark/options.html#default-index-type)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Here is an example code snippet for Spark Data:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```python</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import pandas as pd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from flaml.automl.spark.utils import to_pandas_on_spark</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Creating a dictionary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">data = {&quot;Square_Feet&quot;: [800, 1200, 1800, 1500, 850],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;Age_Years&quot;: [20, 15, 10, 7, 25],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;Price&quot;: [100000, 200000, 300000, 240000, 120000]}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Creating a pandas DataFrame</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">dataframe = pd.DataFrame(data)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">label = &quot;Price&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Convert to pandas-on-spark dataframe</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">psdf = to_pandas_on_spark(dataframe)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">To use Spark ML models you need to format your data appropriately. Specifically, use [`VectorAssembler`](https://spark.apache.org/docs/latest/api/python/reference/api/pyspark.ml.feature.VectorAssembler.html) to merge all feature columns into a single vector column.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Here is an example of how to use it:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```python</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from pyspark.ml.feature import VectorAssembler</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">columns = psdf.columns</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">feature_cols = [col for col in columns if col != label]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">featurizer = VectorAssembler(inputCols=feature_cols, outputCol=&quot;features&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">psdf = featurizer.transform(psdf.to_spark(index_col=&quot;index&quot;))[&quot;index&quot;, &quot;features&quot;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Later in conducting the experiment, use your pandas-on-spark data like non-spark data and pass them using `X_train, y_train` or `dataframe, label`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">### Estimators</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#### Model List</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- `lgbm_spark`: The class for fine-tuning Spark version LightGBM models, using [SynapseML](https://microsoft.github.io/SynapseML/docs/features/lightgbm/about/) API.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#### Usage</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">First, prepare your data in the required format as described in the previous section.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">By including the models you intend to try in the `estimators_list` argument to `flaml.automl`, FLAML will start trying configurations for these models. If your input is Spark data, FLAML will also use estimators with the `_spark` postfix by default, even if you haven&#x27;t specified them.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Here is an example code snippet using SparkML models in AutoML:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```python</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import flaml</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># prepare your data in pandas-on-spark format as we previously mentioned</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl = flaml.AutoML()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">settings = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;time_budget&quot;: 30,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;metric&quot;: &quot;r2&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;estimator_list&quot;: [&quot;lgbm_spark&quot;],  # this setting is optional</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;task&quot;: &quot;regression&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl.fit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    dataframe=psdf,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    label=label,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    **settings,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[Link to notebook](https://github.com/microsoft/FLAML/blob/main/notebook/automl_bankrupt_synapseml.ipynb) | [Open in colab](https://colab.research.google.com/github/microsoft/FLAML/blob/main/notebook/automl_bankrupt_synapseml.ipynb)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## Parallel Spark Jobs</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You can activate Spark as the parallel backend during parallel tuning in both [AutoML](/docs/Use-Cases/Task-Oriented-AutoML#parallel-tuning) and [Hyperparameter Tuning](/docs/Use-Cases/Tune-User-Defined-Function#parallel-tuning), by setting the `use_spark` to `true`. FLAML will dispatch your job to the distributed Spark backend using [`joblib-spark`](https://github.com/joblib/joblib-spark).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Please note that you should not set `use_spark` to `true` when applying AutoML and Tuning for Spark Data. This is because only SparkML models will be used for Spark Data in AutoML and Tuning. As SparkML models run in parallel, there is no need to distribute them with `use_spark` again.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">All the Spark-related arguments are stated below. These arguments are available in both Hyperparameter Tuning and AutoML:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- `use_spark`: boolean, default=False | Whether to use spark to run the training in parallel spark jobs. This can be used to accelerate training on large models and large datasets, but will incur more overhead in time and thus slow down training in some cases. GPU training is not supported yet when use_spark is True. For Spark clusters, by default, we will launch one trial per executor. However, sometimes we want to launch more trials than the number of executors (e.g., local mode). In this case, we can set the environment variable `FLAML_MAX_CONCURRENT` to override the detected `num_executors`. The final number of concurrent trials will be the minimum of `n_concurrent_trials` and `num_executors`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- `n_concurrent_trials`: int, default=1 | The number of concurrent trials. When n_concurrent_trials &gt; 1, FLAML performs parallel tuning.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- `force_cancel`: boolean, default=False | Whether to forcely cancel Spark jobs if the search time exceeded the time budget. Spark jobs include parallel tuning jobs and Spark-based model training jobs.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">An example code snippet for using parallel Spark jobs:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```python</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import flaml</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl_experiment = flaml.AutoML()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl_settings = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;time_budget&quot;: 30,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;metric&quot;: &quot;r2&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;task&quot;: &quot;regression&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;n_concurrent_trials&quot;: 2,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;use_spark&quot;: True,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;force_cancel&quot;: True, # Activating the force_cancel option can immediately halt Spark jobs once they exceed the allocated time_budget.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl.fit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    dataframe=dataframe,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    label=label,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    **automl_settings,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[Link to notebook](https://github.com/microsoft/FLAML/blob/main/notebook/integrate_spark.ipynb) | [Open in colab](https://colab.research.google.com/github/microsoft/FLAML/blob/main/notebook/integrate_spark.ipynb)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Research</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">For technical details, please check our research publications.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* [FLAML: A Fast and Lightweight AutoML Library](https://www.microsoft.com/en-us/research/publication/flaml-a-fast-and-lightweight-automl-library/). Chi Wang, Qingyun Wu, Markus Weimer, Erkang Zhu. MLSys 2021.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{wang2021flaml,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={FLAML: A Fast and Lightweight AutoML Library},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Chi Wang and Qingyun Wu and Markus Weimer and Erkang Zhu},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2021},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={MLSys},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* [Frugal Optimization for Cost-related Hyperparameters](https://arxiv.org/abs/2005.01571). Qingyun Wu, Chi Wang, Silu Huang. AAAI 2021.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{wu2021cfo,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={Frugal Optimization for Cost-related Hyperparameters},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Qingyun Wu and Chi Wang and Silu Huang},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2021},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={AAAI},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* [Economical Hyperparameter Optimization With Blended Search Strategy](https://www.microsoft.com/en-us/research/publication/economical-hyperparameter-optimization-with-blended-search-strategy/). Chi Wang, Qingyun Wu, Silu Huang, Amin Saied. ICLR 2021.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{wang2021blendsearch,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={Economical Hyperparameter Optimization With Blended Search Strategy},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Chi Wang and Qingyun Wu and Silu Huang and Amin Saied},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2021},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={ICLR},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* [An Empirical Study on Hyperparameter Optimization for Fine-Tuning Pre-trained Language Models](https://aclanthology.org/2021.acl-long.178.pdf). Susan Xueqing Liu, Chi Wang. ACL 2021.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{liuwang2021hpolm,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={An Empirical Study on Hyperparameter Optimization for Fine-Tuning Pre-trained Language Models},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Susan Xueqing Liu and Chi Wang},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2021},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={ACL},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* [ChaCha for Online AutoML](https://www.microsoft.com/en-us/research/publication/chacha-for-online-automl/). Qingyun Wu, Chi Wang, John Langford, Paul Mineiro and Marco Rossi. ICML 2021.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{wu2021chacha,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={ChaCha for Online AutoML},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Qingyun Wu and Chi Wang and John Langford and Paul Mineiro and Marco Rossi},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2021},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={ICML},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* [Fair AutoML](https://arxiv.org/abs/2111.06495). Qingyun Wu, Chi Wang. ArXiv preprint arXiv:2111.06495 (2021).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{wuwang2021fairautoml,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={Fair AutoML},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Qingyun Wu and Chi Wang},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2021},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={ArXiv preprint arXiv:2111.06495},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* [Mining Robust Default Configurations for Resource-constrained AutoML](https://arxiv.org/abs/2202.09927). Moe Kayali, Chi Wang. ArXiv preprint arXiv:2202.09927 (2022).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{kayaliwang2022default,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={Mining Robust Default Configurations for Resource-constrained AutoML},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Moe Kayali and Chi Wang},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2022},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={ArXiv preprint arXiv:2202.09927},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* [Targeted Hyperparameter Optimization with Lexicographic Preferences Over Multiple Objectives](https://openreview.net/forum?id=0Ij9_q567Ma). Shaokun Zhang, Feiran Jia, Chi Wang, Qingyun Wu. ICLR 2023 (notable-top-5%).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{zhang2023targeted,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={Targeted Hyperparameter Optimization with Lexicographic Preferences Over Multiple Objectives},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Shaokun Zhang and Feiran Jia and Chi Wang and Qingyun Wu},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={International Conference on Learning Representations},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2023},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    url={https://openreview.net/forum?id=0Ij9_q567Ma},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* [Cost-Effective Hyperparameter Optimization for Large Language Model Generation Inference](https://arxiv.org/abs/2303.04673). Chi Wang, Susan Xueqing Liu, Ahmed H. Awadallah. ArXiv preprint arXiv:2303.04673 (2023).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{wang2023EcoOptiGen,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={Cost-Effective Hyperparameter Optimization for Large Language Model Generation Inference},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Chi Wang and Susan Xueqing Liu and Ahmed H. Awadallah},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2023},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={ArXiv preprint arXiv:2303.04673},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* [An Empirical Study on Challenging Math Problem Solving with GPT-4](https://arxiv.org/abs/2306.01337). Yiran Wu, Feiran Jia, Shaokun Zhang, Hangyu Li, Erkang Zhu, Yue Wang, Yin Tat Lee, Richard Peng, Qingyun Wu, Chi Wang. ArXiv preprint arXiv:2306.01337 (2023).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{wu2023empirical,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={An Empirical Study on Challenging Math Problem Solving with GPT-4},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Yiran Wu and Feiran Jia and Shaokun Zhang and Hangyu Li and Erkang Zhu and Yue Wang and Yin Tat Lee and Richard Peng and Qingyun Wu and Chi Wang},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2023},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={ArXiv preprint arXiv:2306.01337},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">To build a time series forecasting model for stock price using FLAML, you can use the `lgbm_spark` estimator and organize your data in the required format. First, use `to_pandas_on_spark` function to convert your data into a pandas-on-spark dataframe/series, which Spark estimators require. Next, you should use `VectorAssembler` to merge all feature columns into a single vector column. Finally, use `flaml.AutoML` to try different configurations for the `lgbm_spark` model. Here is an example code snippet: </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```python</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import flaml</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import pandas as pd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from flaml.automl.spark.utils import to_pandas_on_spark</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from pyspark.ml.feature import VectorAssembler</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># load your stock price data into a pandas dataframe</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">data = pd.read_csv(&#x27;stock_price.csv&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># specify label column name</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">label = &#x27;price&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># convert pandas dataframe to pandas-on-spark dataframe</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">psdf = to_pandas_on_spark(data)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># merge feature columns as a single vector column</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">feature_cols = [col for col in psdf.columns if col != label]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">featurizer = VectorAssembler(inputCols=feature_cols, outputCol=&quot;features&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">psdf = featurizer.transform(psdf.to_spark(index_col=&quot;index&quot;))[&quot;index&quot;, &quot;features&quot;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># start an AutoML experiment with lgbm_spark estimator</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl = flaml.AutoML()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">settings = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;time_budget&quot;: 30,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;metric&quot;: &quot;r2&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;estimator_list&quot;: [&quot;lgbm_spark&quot;],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;task&quot;: &quot;regression&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl.fit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    dataframe=psdf,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    label=label,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    **settings,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">I want the time_budget to be 10 mins</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">I want the time_budget to be 10 mins</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You can change the `time_budget` parameter in the `settings` dictionary to 10 minutes (600 seconds) like this:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```python</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import flaml</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import pandas as pd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from flaml.automl.spark.utils import to_pandas_on_spark</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from pyspark.ml.feature import VectorAssembler</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># load your stock price data into a pandas dataframe</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">data = pd.read_csv(&#x27;stock_price.csv&#x27;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># specify label column name</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">label = &#x27;price&#x27;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># convert pandas dataframe to pandas-on-spark dataframe</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">psdf = to_pandas_on_spark(data)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># merge feature columns as a single vector column</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">feature_cols = [col for col in psdf.columns if col != label]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">featurizer = VectorAssembler(inputCols=feature_cols, outputCol=&quot;features&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">psdf = featurizer.transform(psdf.to_spark(index_col=&quot;index&quot;))[&quot;index&quot;, &quot;features&quot;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># start an AutoML experiment with lgbm_spark estimator and time_budget of 10 mins</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl = flaml.AutoML()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">settings = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;time_budget&quot;: 600,  # time_budget in seconds</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;metric&quot;: &quot;r2&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;estimator_list&quot;: [&quot;lgbm_spark&quot;],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;task&quot;: &quot;regression&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl.fit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    dataframe=psdf,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    label=label,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    **settings,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">In this example, the `time_budget` parameter is set to 600, which represents the number of seconds the FLAML AutoML experiment will run. You can adjust this value to control the total time spent on the experiment.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; NO HUMAN INPUT RECEIVED.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; USING AUTO REPLY...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Is there anything else I can help you with?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; NO HUMAN INPUT RECEIVED.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-4">Example 4<a href="#example-4" class="hash-link" aria-label="Direct link to Example 4" title="Direct link to Example 4">​</a></h3>
<p><a href="#table-of-contents">Back to top</a></p>
<p>Use RetrieveChat to answer a question and ask for human-in-loop
feedbacks.</p>
<p>Problem: Is there a function named <code>tune_automl</code> in FLAML?</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># reset the assistant. Always reset the assistant before starting a new conversation.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">assistant</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">reset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># set `human_input_mode` to be `ALWAYS`, so the agent will ask for human input at every step.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ragproxyagent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">human_input_mode </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ALWAYS&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">qa_problem </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Is there a function named `tune_automl` in FLAML?&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">chat_result </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ragproxyagent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">initiate_chat</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    assistant</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> message</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">ragproxyagent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">message_generator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> problem</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">qa_problem</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># type &quot;exit&quot; to exit the conversation</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">WARNING:chromadb.segment.impl.vector.local_persistent_hnsw:Number of requested results 20 is greater than number of elements in index 2, updating n_results = 2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">doc_ids:  [[&#x27;doc_0&#x27;, &#x27;doc_1&#x27;]]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_0 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_1 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You&#x27;re a retrieve augmented coding assistant. You answer user&#x27;s questions based on your own knowledge and the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">context provided by the user.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">If you can&#x27;t answer the question with or without the current context, you should reply exactly `UPDATE CONTEXT`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">For code generation, you must obey the following rules:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Rule 1. You MUST NOT install any packages because all the packages needed are already installed.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Rule 2. You must follow the formats below to write your code:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```language</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># your code</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">User&#x27;s question is: Is there a function named `tune_automl` in FLAML?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context is: # Integrate - Spark</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">FLAML has integrated Spark for distributed training. There are two main aspects of integration with Spark:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- Use Spark ML estimators for AutoML.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- Use Spark to run training in parallel spark jobs.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## Spark ML Estimators</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">FLAML integrates estimators based on Spark ML models. These models are trained in parallel using Spark, so we called them Spark estimators. To use these models, you first need to organize your data in the required format.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">### Data</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">For Spark estimators, AutoML only consumes Spark data. FLAML provides a convenient function `to_pandas_on_spark` in the `flaml.automl.spark.utils` module to convert your data into a pandas-on-spark (`pyspark.pandas`) dataframe/series, which Spark estimators require.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">This utility function takes data in the form of a `pandas.Dataframe` or `pyspark.sql.Dataframe` and converts it into a pandas-on-spark dataframe. It also takes `pandas.Series` or `pyspark.sql.Dataframe` and converts it into a [pandas-on-spark](https://spark.apache.org/docs/latest/api/python/user_guide/pandas_on_spark/index.html) series. If you pass in a `pyspark.pandas.Dataframe`, it will not make any changes.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">This function also accepts optional arguments `index_col` and `default_index_type`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- `index_col` is the column name to use as the index, default is None.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- `default_index_type` is the default index type, default is &quot;distributed-sequence&quot;. More info about default index type could be found on Spark official [documentation](https://spark.apache.org/docs/latest/api/python/user_guide/pandas_on_spark/options.html#default-index-type)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Here is an example code snippet for Spark Data:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```python</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import pandas as pd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from flaml.automl.spark.utils import to_pandas_on_spark</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Creating a dictionary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">data = {&quot;Square_Feet&quot;: [800, 1200, 1800, 1500, 850],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;Age_Years&quot;: [20, 15, 10, 7, 25],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;Price&quot;: [100000, 200000, 300000, 240000, 120000]}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Creating a pandas DataFrame</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">dataframe = pd.DataFrame(data)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">label = &quot;Price&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Convert to pandas-on-spark dataframe</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">psdf = to_pandas_on_spark(dataframe)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">To use Spark ML models you need to format your data appropriately. Specifically, use [`VectorAssembler`](https://spark.apache.org/docs/latest/api/python/reference/api/pyspark.ml.feature.VectorAssembler.html) to merge all feature columns into a single vector column.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Here is an example of how to use it:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```python</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from pyspark.ml.feature import VectorAssembler</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">columns = psdf.columns</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">feature_cols = [col for col in columns if col != label]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">featurizer = VectorAssembler(inputCols=feature_cols, outputCol=&quot;features&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">psdf = featurizer.transform(psdf.to_spark(index_col=&quot;index&quot;))[&quot;index&quot;, &quot;features&quot;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Later in conducting the experiment, use your pandas-on-spark data like non-spark data and pass them using `X_train, y_train` or `dataframe, label`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">### Estimators</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#### Model List</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- `lgbm_spark`: The class for fine-tuning Spark version LightGBM models, using [SynapseML](https://microsoft.github.io/SynapseML/docs/features/lightgbm/about/) API.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#### Usage</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">First, prepare your data in the required format as described in the previous section.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">By including the models you intend to try in the `estimators_list` argument to `flaml.automl`, FLAML will start trying configurations for these models. If your input is Spark data, FLAML will also use estimators with the `_spark` postfix by default, even if you haven&#x27;t specified them.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Here is an example code snippet using SparkML models in AutoML:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```python</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import flaml</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># prepare your data in pandas-on-spark format as we previously mentioned</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl = flaml.AutoML()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">settings = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;time_budget&quot;: 30,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;metric&quot;: &quot;r2&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;estimator_list&quot;: [&quot;lgbm_spark&quot;],  # this setting is optional</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;task&quot;: &quot;regression&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl.fit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    dataframe=psdf,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    label=label,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    **settings,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[Link to notebook](https://github.com/microsoft/FLAML/blob/main/notebook/automl_bankrupt_synapseml.ipynb) | [Open in colab](https://colab.research.google.com/github/microsoft/FLAML/blob/main/notebook/automl_bankrupt_synapseml.ipynb)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## Parallel Spark Jobs</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You can activate Spark as the parallel backend during parallel tuning in both [AutoML](/docs/Use-Cases/Task-Oriented-AutoML#parallel-tuning) and [Hyperparameter Tuning](/docs/Use-Cases/Tune-User-Defined-Function#parallel-tuning), by setting the `use_spark` to `true`. FLAML will dispatch your job to the distributed Spark backend using [`joblib-spark`](https://github.com/joblib/joblib-spark).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Please note that you should not set `use_spark` to `true` when applying AutoML and Tuning for Spark Data. This is because only SparkML models will be used for Spark Data in AutoML and Tuning. As SparkML models run in parallel, there is no need to distribute them with `use_spark` again.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">All the Spark-related arguments are stated below. These arguments are available in both Hyperparameter Tuning and AutoML:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- `use_spark`: boolean, default=False | Whether to use spark to run the training in parallel spark jobs. This can be used to accelerate training on large models and large datasets, but will incur more overhead in time and thus slow down training in some cases. GPU training is not supported yet when use_spark is True. For Spark clusters, by default, we will launch one trial per executor. However, sometimes we want to launch more trials than the number of executors (e.g., local mode). In this case, we can set the environment variable `FLAML_MAX_CONCURRENT` to override the detected `num_executors`. The final number of concurrent trials will be the minimum of `n_concurrent_trials` and `num_executors`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- `n_concurrent_trials`: int, default=1 | The number of concurrent trials. When n_concurrent_trials &gt; 1, FLAML performs parallel tuning.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- `force_cancel`: boolean, default=False | Whether to forcely cancel Spark jobs if the search time exceeded the time budget. Spark jobs include parallel tuning jobs and Spark-based model training jobs.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">An example code snippet for using parallel Spark jobs:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```python</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import flaml</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl_experiment = flaml.AutoML()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl_settings = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;time_budget&quot;: 30,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;metric&quot;: &quot;r2&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;task&quot;: &quot;regression&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;n_concurrent_trials&quot;: 2,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;use_spark&quot;: True,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;force_cancel&quot;: True, # Activating the force_cancel option can immediately halt Spark jobs once they exceed the allocated time_budget.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl.fit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    dataframe=dataframe,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    label=label,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    **automl_settings,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[Link to notebook](https://github.com/microsoft/FLAML/blob/main/notebook/integrate_spark.ipynb) | [Open in colab](https://colab.research.google.com/github/microsoft/FLAML/blob/main/notebook/integrate_spark.ipynb)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Research</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">For technical details, please check our research publications.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* [FLAML: A Fast and Lightweight AutoML Library](https://www.microsoft.com/en-us/research/publication/flaml-a-fast-and-lightweight-automl-library/). Chi Wang, Qingyun Wu, Markus Weimer, Erkang Zhu. MLSys 2021.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{wang2021flaml,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={FLAML: A Fast and Lightweight AutoML Library},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Chi Wang and Qingyun Wu and Markus Weimer and Erkang Zhu},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2021},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={MLSys},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* [Frugal Optimization for Cost-related Hyperparameters](https://arxiv.org/abs/2005.01571). Qingyun Wu, Chi Wang, Silu Huang. AAAI 2021.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{wu2021cfo,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={Frugal Optimization for Cost-related Hyperparameters},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Qingyun Wu and Chi Wang and Silu Huang},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2021},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={AAAI},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* [Economical Hyperparameter Optimization With Blended Search Strategy](https://www.microsoft.com/en-us/research/publication/economical-hyperparameter-optimization-with-blended-search-strategy/). Chi Wang, Qingyun Wu, Silu Huang, Amin Saied. ICLR 2021.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{wang2021blendsearch,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={Economical Hyperparameter Optimization With Blended Search Strategy},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Chi Wang and Qingyun Wu and Silu Huang and Amin Saied},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2021},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={ICLR},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* [An Empirical Study on Hyperparameter Optimization for Fine-Tuning Pre-trained Language Models](https://aclanthology.org/2021.acl-long.178.pdf). Susan Xueqing Liu, Chi Wang. ACL 2021.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{liuwang2021hpolm,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={An Empirical Study on Hyperparameter Optimization for Fine-Tuning Pre-trained Language Models},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Susan Xueqing Liu and Chi Wang},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2021},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={ACL},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* [ChaCha for Online AutoML](https://www.microsoft.com/en-us/research/publication/chacha-for-online-automl/). Qingyun Wu, Chi Wang, John Langford, Paul Mineiro and Marco Rossi. ICML 2021.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{wu2021chacha,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={ChaCha for Online AutoML},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Qingyun Wu and Chi Wang and John Langford and Paul Mineiro and Marco Rossi},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2021},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={ICML},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* [Fair AutoML](https://arxiv.org/abs/2111.06495). Qingyun Wu, Chi Wang. ArXiv preprint arXiv:2111.06495 (2021).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{wuwang2021fairautoml,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={Fair AutoML},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Qingyun Wu and Chi Wang},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2021},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={ArXiv preprint arXiv:2111.06495},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* [Mining Robust Default Configurations for Resource-constrained AutoML](https://arxiv.org/abs/2202.09927). Moe Kayali, Chi Wang. ArXiv preprint arXiv:2202.09927 (2022).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{kayaliwang2022default,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={Mining Robust Default Configurations for Resource-constrained AutoML},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Moe Kayali and Chi Wang},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2022},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={ArXiv preprint arXiv:2202.09927},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* [Targeted Hyperparameter Optimization with Lexicographic Preferences Over Multiple Objectives](https://openreview.net/forum?id=0Ij9_q567Ma). Shaokun Zhang, Feiran Jia, Chi Wang, Qingyun Wu. ICLR 2023 (notable-top-5%).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{zhang2023targeted,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={Targeted Hyperparameter Optimization with Lexicographic Preferences Over Multiple Objectives},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Shaokun Zhang and Feiran Jia and Chi Wang and Qingyun Wu},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={International Conference on Learning Representations},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2023},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    url={https://openreview.net/forum?id=0Ij9_q567Ma},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* [Cost-Effective Hyperparameter Optimization for Large Language Model Generation Inference](https://arxiv.org/abs/2303.04673). Chi Wang, Susan Xueqing Liu, Ahmed H. Awadallah. ArXiv preprint arXiv:2303.04673 (2023).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{wang2023EcoOptiGen,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={Cost-Effective Hyperparameter Optimization for Large Language Model Generation Inference},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Chi Wang and Susan Xueqing Liu and Ahmed H. Awadallah},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2023},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={ArXiv preprint arXiv:2303.04673},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* [An Empirical Study on Challenging Math Problem Solving with GPT-4](https://arxiv.org/abs/2306.01337). Yiran Wu, Feiran Jia, Shaokun Zhang, Hangyu Li, Erkang Zhu, Yue Wang, Yin Tat Lee, Richard Peng, Qingyun Wu, Chi Wang. ArXiv preprint arXiv:2306.01337 (2023).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{wu2023empirical,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={An Empirical Study on Challenging Math Problem Solving with GPT-4},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Yiran Wu and Feiran Jia and Shaokun Zhang and Hangyu Li and Erkang Zhu and Yue Wang and Yin Tat Lee and Richard Peng and Qingyun Wu and Chi Wang},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2023},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={ArXiv preprint arXiv:2306.01337},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_1 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You&#x27;re a retrieve augmented coding assistant. You answer user&#x27;s questions based on your own knowledge and the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">context provided by the user.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">If you can&#x27;t answer the question with or without the current context, you should reply exactly `UPDATE CONTEXT`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">For code generation, you must obey the following rules:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Rule 1. You MUST NOT install any packages because all the packages needed are already installed.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Rule 2. You must follow the formats below to write your code:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```language</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># your code</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">User&#x27;s question is: Is there a function named `tune_automl` in FLAML?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context is: # Integrate - Spark</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">FLAML has integrated Spark for distributed training. There are two main aspects of integration with Spark:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- Use Spark ML estimators for AutoML.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- Use Spark to run training in parallel spark jobs.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## Spark ML Estimators</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">FLAML integrates estimators based on Spark ML models. These models are trained in parallel using Spark, so we called them Spark estimators. To use these models, you first need to organize your data in the required format.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">### Data</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">For Spark estimators, AutoML only consumes Spark data. FLAML provides a convenient function `to_pandas_on_spark` in the `flaml.automl.spark.utils` module to convert your data into a pandas-on-spark (`pyspark.pandas`) dataframe/series, which Spark estimators require.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">This utility function takes data in the form of a `pandas.Dataframe` or `pyspark.sql.Dataframe` and converts it into a pandas-on-spark dataframe. It also takes `pandas.Series` or `pyspark.sql.Dataframe` and converts it into a [pandas-on-spark](https://spark.apache.org/docs/latest/api/python/user_guide/pandas_on_spark/index.html) series. If you pass in a `pyspark.pandas.Dataframe`, it will not make any changes.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">This function also accepts optional arguments `index_col` and `default_index_type`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- `index_col` is the column name to use as the index, default is None.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- `default_index_type` is the default index type, default is &quot;distributed-sequence&quot;. More info about default index type could be found on Spark official [documentation](https://spark.apache.org/docs/latest/api/python/user_guide/pandas_on_spark/options.html#default-index-type)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Here is an example code snippet for Spark Data:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```python</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import pandas as pd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from flaml.automl.spark.utils import to_pandas_on_spark</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Creating a dictionary</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">data = {&quot;Square_Feet&quot;: [800, 1200, 1800, 1500, 850],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;Age_Years&quot;: [20, 15, 10, 7, 25],</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;Price&quot;: [100000, 200000, 300000, 240000, 120000]}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Creating a pandas DataFrame</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">dataframe = pd.DataFrame(data)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">label = &quot;Price&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Convert to pandas-on-spark dataframe</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">psdf = to_pandas_on_spark(dataframe)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">To use Spark ML models you need to format your data appropriately. Specifically, use [`VectorAssembler`](https://spark.apache.org/docs/latest/api/python/reference/api/pyspark.ml.feature.VectorAssembler.html) to merge all feature columns into a single vector column.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Here is an example of how to use it:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```python</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">from pyspark.ml.feature import VectorAssembler</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">columns = psdf.columns</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">feature_cols = [col for col in columns if col != label]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">featurizer = VectorAssembler(inputCols=feature_cols, outputCol=&quot;features&quot;)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">psdf = featurizer.transform(psdf.to_spark(index_col=&quot;index&quot;))[&quot;index&quot;, &quot;features&quot;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Later in conducting the experiment, use your pandas-on-spark data like non-spark data and pass them using `X_train, y_train` or `dataframe, label`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">### Estimators</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#### Model List</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- `lgbm_spark`: The class for fine-tuning Spark version LightGBM models, using [SynapseML](https://microsoft.github.io/SynapseML/docs/features/lightgbm/about/) API.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">#### Usage</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">First, prepare your data in the required format as described in the previous section.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">By including the models you intend to try in the `estimators_list` argument to `flaml.automl`, FLAML will start trying configurations for these models. If your input is Spark data, FLAML will also use estimators with the `_spark` postfix by default, even if you haven&#x27;t specified them.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Here is an example code snippet using SparkML models in AutoML:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```python</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import flaml</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># prepare your data in pandas-on-spark format as we previously mentioned</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl = flaml.AutoML()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">settings = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;time_budget&quot;: 30,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;metric&quot;: &quot;r2&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;estimator_list&quot;: [&quot;lgbm_spark&quot;],  # this setting is optional</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;task&quot;: &quot;regression&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl.fit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    dataframe=psdf,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    label=label,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    **settings,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[Link to notebook](https://github.com/microsoft/FLAML/blob/main/notebook/automl_bankrupt_synapseml.ipynb) | [Open in colab](https://colab.research.google.com/github/microsoft/FLAML/blob/main/notebook/automl_bankrupt_synapseml.ipynb)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">## Parallel Spark Jobs</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You can activate Spark as the parallel backend during parallel tuning in both [AutoML](/docs/Use-Cases/Task-Oriented-AutoML#parallel-tuning) and [Hyperparameter Tuning](/docs/Use-Cases/Tune-User-Defined-Function#parallel-tuning), by setting the `use_spark` to `true`. FLAML will dispatch your job to the distributed Spark backend using [`joblib-spark`](https://github.com/joblib/joblib-spark).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Please note that you should not set `use_spark` to `true` when applying AutoML and Tuning for Spark Data. This is because only SparkML models will be used for Spark Data in AutoML and Tuning. As SparkML models run in parallel, there is no need to distribute them with `use_spark` again.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">All the Spark-related arguments are stated below. These arguments are available in both Hyperparameter Tuning and AutoML:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- `use_spark`: boolean, default=False | Whether to use spark to run the training in parallel spark jobs. This can be used to accelerate training on large models and large datasets, but will incur more overhead in time and thus slow down training in some cases. GPU training is not supported yet when use_spark is True. For Spark clusters, by default, we will launch one trial per executor. However, sometimes we want to launch more trials than the number of executors (e.g., local mode). In this case, we can set the environment variable `FLAML_MAX_CONCURRENT` to override the detected `num_executors`. The final number of concurrent trials will be the minimum of `n_concurrent_trials` and `num_executors`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- `n_concurrent_trials`: int, default=1 | The number of concurrent trials. When n_concurrent_trials &gt; 1, FLAML performs parallel tuning.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- `force_cancel`: boolean, default=False | Whether to forcely cancel Spark jobs if the search time exceeded the time budget. Spark jobs include parallel tuning jobs and Spark-based model training jobs.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">An example code snippet for using parallel Spark jobs:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```python</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">import flaml</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl_experiment = flaml.AutoML()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl_settings = {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;time_budget&quot;: 30,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;metric&quot;: &quot;r2&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;task&quot;: &quot;regression&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;n_concurrent_trials&quot;: 2,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;use_spark&quot;: True,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;force_cancel&quot;: True, # Activating the force_cancel option can immediately halt Spark jobs once they exceed the allocated time_budget.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl.fit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    dataframe=dataframe,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    label=label,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    **automl_settings,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[Link to notebook](https://github.com/microsoft/FLAML/blob/main/notebook/integrate_spark.ipynb) | [Open in colab](https://colab.research.google.com/github/microsoft/FLAML/blob/main/notebook/integrate_spark.ipynb)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"># Research</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">For technical details, please check our research publications.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* [FLAML: A Fast and Lightweight AutoML Library](https://www.microsoft.com/en-us/research/publication/flaml-a-fast-and-lightweight-automl-library/). Chi Wang, Qingyun Wu, Markus Weimer, Erkang Zhu. MLSys 2021.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{wang2021flaml,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={FLAML: A Fast and Lightweight AutoML Library},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Chi Wang and Qingyun Wu and Markus Weimer and Erkang Zhu},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2021},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={MLSys},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* [Frugal Optimization for Cost-related Hyperparameters](https://arxiv.org/abs/2005.01571). Qingyun Wu, Chi Wang, Silu Huang. AAAI 2021.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{wu2021cfo,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={Frugal Optimization for Cost-related Hyperparameters},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Qingyun Wu and Chi Wang and Silu Huang},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2021},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={AAAI},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* [Economical Hyperparameter Optimization With Blended Search Strategy](https://www.microsoft.com/en-us/research/publication/economical-hyperparameter-optimization-with-blended-search-strategy/). Chi Wang, Qingyun Wu, Silu Huang, Amin Saied. ICLR 2021.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{wang2021blendsearch,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={Economical Hyperparameter Optimization With Blended Search Strategy},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Chi Wang and Qingyun Wu and Silu Huang and Amin Saied},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2021},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={ICLR},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* [An Empirical Study on Hyperparameter Optimization for Fine-Tuning Pre-trained Language Models](https://aclanthology.org/2021.acl-long.178.pdf). Susan Xueqing Liu, Chi Wang. ACL 2021.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{liuwang2021hpolm,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={An Empirical Study on Hyperparameter Optimization for Fine-Tuning Pre-trained Language Models},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Susan Xueqing Liu and Chi Wang},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2021},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={ACL},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* [ChaCha for Online AutoML](https://www.microsoft.com/en-us/research/publication/chacha-for-online-automl/). Qingyun Wu, Chi Wang, John Langford, Paul Mineiro and Marco Rossi. ICML 2021.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{wu2021chacha,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={ChaCha for Online AutoML},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Qingyun Wu and Chi Wang and John Langford and Paul Mineiro and Marco Rossi},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2021},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={ICML},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* [Fair AutoML](https://arxiv.org/abs/2111.06495). Qingyun Wu, Chi Wang. ArXiv preprint arXiv:2111.06495 (2021).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{wuwang2021fairautoml,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={Fair AutoML},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Qingyun Wu and Chi Wang},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2021},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={ArXiv preprint arXiv:2111.06495},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* [Mining Robust Default Configurations for Resource-constrained AutoML](https://arxiv.org/abs/2202.09927). Moe Kayali, Chi Wang. ArXiv preprint arXiv:2202.09927 (2022).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{kayaliwang2022default,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={Mining Robust Default Configurations for Resource-constrained AutoML},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Moe Kayali and Chi Wang},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2022},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={ArXiv preprint arXiv:2202.09927},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* [Targeted Hyperparameter Optimization with Lexicographic Preferences Over Multiple Objectives](https://openreview.net/forum?id=0Ij9_q567Ma). Shaokun Zhang, Feiran Jia, Chi Wang, Qingyun Wu. ICLR 2023 (notable-top-5%).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{zhang2023targeted,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={Targeted Hyperparameter Optimization with Lexicographic Preferences Over Multiple Objectives},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Shaokun Zhang and Feiran Jia and Chi Wang and Qingyun Wu},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={International Conference on Learning Representations},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2023},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    url={https://openreview.net/forum?id=0Ij9_q567Ma},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* [Cost-Effective Hyperparameter Optimization for Large Language Model Generation Inference](https://arxiv.org/abs/2303.04673). Chi Wang, Susan Xueqing Liu, Ahmed H. Awadallah. ArXiv preprint arXiv:2303.04673 (2023).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{wang2023EcoOptiGen,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={Cost-Effective Hyperparameter Optimization for Large Language Model Generation Inference},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Chi Wang and Susan Xueqing Liu and Ahmed H. Awadallah},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2023},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={ArXiv preprint arXiv:2303.04673},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">* [An Empirical Study on Challenging Math Problem Solving with GPT-4](https://arxiv.org/abs/2306.01337). Yiran Wu, Feiran Jia, Shaokun Zhang, Hangyu Li, Erkang Zhu, Yue Wang, Yin Tat Lee, Richard Peng, Qingyun Wu, Chi Wang. ArXiv preprint arXiv:2306.01337 (2023).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```bibtex</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">@inproceedings{wu2023empirical,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    title={An Empirical Study on Challenging Math Problem Solving with GPT-4},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    author={Yiran Wu and Feiran Jia and Shaokun Zhang and Hangyu Li and Erkang Zhu and Yue Wang and Yin Tat Lee and Richard Peng and Qingyun Wu and Chi Wang},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    year={2023},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    booktitle={ArXiv preprint arXiv:2306.01337},</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">```</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">There is no function named `tune_automl` in FLAML. However, FLAML has integrated Spark for distributed training. There are two main aspects of integration with Spark: </span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- Use Spark ML Estimators for AutoML.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">- Use Spark to run training in parallel Spark jobs.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-5">Example 5<a href="#example-5" class="hash-link" aria-label="Direct link to Example 5" title="Direct link to Example 5">​</a></h3>
<p><a href="#table-of-contents">Back to top</a></p>
<p>Use RetrieveChat to answer questions for
<a href="https://ai.google.com/research/NaturalQuestions" target="_blank" rel="noopener noreferrer">NaturalQuestion</a>
dataset.</p>
<p>First, we will create a new document collection which includes all the
contextual corpus. Then, we will choose some questions and utilize
RetrieveChat to answer them. For this particular example, we will be
using the <code>gpt-3.5-turbo</code> model, and we will demonstrate RetrieveChat’s
feature of automatically updating context in case the documents
retrieved do not contain sufficient information.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">config_list</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;model&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;gpt-35-turbo&quot;</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># change model to gpt-35-turbo</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">corpus_file </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://huggingface.co/datasets/thinkall/NaturalQuestionsQA/resolve/main/corpus.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Create a new collection for NaturalQuestions dataset</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># `task` indicates the kind of task we&#x27;re working on. In this example, it&#x27;s a `qa` task.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ragproxyagent </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> RetrieveUserProxyAgent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ragproxyagent&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    human_input_mode</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;NEVER&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    max_consecutive_auto_reply</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    retrieve_config</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;task&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;qa&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;docs_path&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> corpus_file</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;chunk_token_size&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2000</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;model&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> config_list</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;model&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;client&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> chromadb</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">PersistentClient</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">path</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/tmp/chromadb&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;collection_name&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;natural-questions&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;chunk_mode&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;one_line&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;embedding_model&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;all-MiniLM-L6-v2&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># queries_file = &quot;https://huggingface.co/datasets/thinkall/NaturalQuestionsQA/resolve/main/queries.jsonl&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">queries </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;{&quot;_id&quot;: &quot;ce2342e1feb4e119cb273c05356b33309d38fa132a1cbeac2368a337e38419b8&quot;, &quot;text&quot;: &quot;what is non controlling interest on balance sheet&quot;, &quot;metadata&quot;: {&quot;answer&quot;: [&quot;the portion of a subsidiary corporation &#x27;s stock that is not owned by the parent corporation&quot;]}}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">{&quot;_id&quot;: &quot;3a10ff0e520530c0aa33b2c7e8d989d78a8cd5d699201fc4b13d3845010994ee&quot;, &quot;text&quot;: &quot;how many episodes are in chicago fire season 4&quot;, &quot;metadata&quot;: {&quot;answer&quot;: [&quot;23&quot;]}}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">{&quot;_id&quot;: &quot;fcdb6b11969d5d3b900806f52e3d435e615c333405a1ff8247183e8db6246040&quot;, &quot;text&quot;: &quot;what are bulls used for on a farm&quot;, &quot;metadata&quot;: {&quot;answer&quot;: [&quot;breeding&quot;, &quot;as work oxen&quot;, &quot;slaughtered for meat&quot;]}}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">{&quot;_id&quot;: &quot;26c3b53ec44533bbdeeccffa32e094cfea0cc2a78c9f6a6c7a008ada1ad0792e&quot;, &quot;text&quot;: &quot;has been honoured with the wisden leading cricketer in the world award for 2016&quot;, &quot;metadata&quot;: {&quot;answer&quot;: [&quot;Virat Kohli&quot;]}}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">{&quot;_id&quot;: &quot;0868d0964c719a52cbcfb116971b0152123dad908ac4e0a01bc138f16a907ab3&quot;, &quot;text&quot;: &quot;who carried the usa flag in opening ceremony&quot;, &quot;metadata&quot;: {&quot;answer&quot;: [&quot;Erin Hamlin&quot;]}}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">queries </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">json</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">loads</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">line</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> line </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> queries</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">split</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;\n&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> line</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">questions </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">q</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;text&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> q </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> queries</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">answers </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">q</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;metadata&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;answer&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> q </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> queries</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">questions</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">answers</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[&#x27;what is non controlling interest on balance sheet&#x27;, &#x27;how many episodes are in chicago fire season 4&#x27;, &#x27;what are bulls used for on a farm&#x27;, &#x27;has been honoured with the wisden leading cricketer in the world award for 2016&#x27;, &#x27;who carried the usa flag in opening ceremony&#x27;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[[&quot;the portion of a subsidiary corporation &#x27;s stock that is not owned by the parent corporation&quot;], [&#x27;23&#x27;], [&#x27;breeding&#x27;, &#x27;as work oxen&#x27;, &#x27;slaughtered for meat&#x27;], [&#x27;Virat Kohli&#x27;], [&#x27;Erin Hamlin&#x27;]]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> i </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">range</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token builtin" style="color:rgb(130, 170, 255)">len</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">questions</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">f&quot;\n\n&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;  Below are outputs of Case </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation operator" style="color:rgb(137, 221, 255)">+</span><span class="token string-interpolation interpolation number" style="color:rgb(247, 140, 108)">1</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">  &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n\n&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># reset the assistant. Always reset the assistant before starting a new conversation.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    assistant</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">reset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    qa_problem </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> questions</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    chat_result </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ragproxyagent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">initiate_chat</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        assistant</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> message</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">ragproxyagent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">message_generator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> problem</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">qa_problem</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> n_results</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">30</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;  Below are outputs of Case 1  &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Trying to create collection.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">doc_ids:  [[&#x27;doc_0&#x27;, &#x27;doc_3334&#x27;, &#x27;doc_720&#x27;, &#x27;doc_2732&#x27;, &#x27;doc_2510&#x27;, &#x27;doc_5084&#x27;, &#x27;doc_5068&#x27;, &#x27;doc_3727&#x27;, &#x27;doc_1938&#x27;, &#x27;doc_4689&#x27;, &#x27;doc_5249&#x27;, &#x27;doc_1751&#x27;, &#x27;doc_480&#x27;, &#x27;doc_3989&#x27;, &#x27;doc_2115&#x27;, &#x27;doc_1233&#x27;, &#x27;doc_2264&#x27;, &#x27;doc_633&#x27;, &#x27;doc_2376&#x27;, &#x27;doc_2293&#x27;, &#x27;doc_5274&#x27;, &#x27;doc_5213&#x27;, &#x27;doc_3991&#x27;, &#x27;doc_2880&#x27;, &#x27;doc_2737&#x27;, &#x27;doc_1257&#x27;, &#x27;doc_1748&#x27;, &#x27;doc_2038&#x27;, &#x27;doc_4073&#x27;, &#x27;doc_2876&#x27;]]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_0 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_3334 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_720 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_2732 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_2510 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_5084 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_5068 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_3727 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_1938 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_4689 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_5249 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_1751 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_480 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_3989 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_3334 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_720 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_2732 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_2510 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_5084 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_5068 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_3727 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_1938 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_4689 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_5249 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_1751 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_480 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_3989 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_2115 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_1233 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_2264 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_633 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_2376 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You&#x27;re a retrieve augmented chatbot. You answer user&#x27;s questions based on your own knowledge and the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">context provided by the user.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">If you can&#x27;t answer the question with or without the current context, you should reply exactly `UPDATE CONTEXT`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You must give as short an answer as possible.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">User&#x27;s question is: what is non controlling interest on balance sheet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context is: &lt;P&gt; In accounting , minority interest ( or non-controlling interest ) is the portion of a subsidiary corporation &#x27;s stock that is not owned by the parent corporation . The magnitude of the minority interest in the subsidiary company is generally less than 50 % of outstanding shares , or the corporation would generally cease to be a subsidiary of the parent . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The balance sheet is the financial statement showing a firm &#x27;s assets , liabilities and equity ( capital ) at a set point in time , usually the end of the fiscal year reported on the accompanying income statement . The total assets always equal the total combined liabilities and equity in dollar amount . This statement best demonstrates the basic accounting equation - Assets = Liabilities + Equity . The statement can be used to help show the status of a company . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The comptroller ( who is also auditor general and head of the National Audit Office ) controls both the Consolidated Fund and the National Loans Fund . The full official title of the role is Comptroller General of the Receipt and Issue of Her Majesty &#x27;s Exchequer . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; Financing activities include the inflow of cash from investors such as banks and shareholders , as well as the outflow of cash to shareholders as dividends as the company generates income . Other activities which impact the long - term liabilities and equity of the company are also listed in the financing activities section of the cash flow statement . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; It is frequently claimed that annual accounts have not been certified by the external auditor since 1994 . In its annual report on the implementation of the 2009 EU Budget , the Court of Auditors found that the two biggest areas of the EU budget , agriculture and regional spending , have not been signed off on and remain `` materially affected by error &#x27;&#x27; . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The Ministry of Finance , Government of India announces the rate of interest for PPF account every quarter . The current interest rate effective from 1 January 2018 is 7.6 % Per Annum &#x27; ( compounded annually ) . Interest will be paid on 31 March every year . Interest is calculated on the lowest balance between the close of the fifth day and the last day of every month . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; Quarter &lt;/Th&gt; &lt;Th&gt; Interest Rate &lt;/Th&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; April 2018 - June 2018 &lt;/Td&gt; &lt;Td&gt; 7.6 % &lt;/Td&gt; &lt;/Tr&gt; &lt;/Table&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; For a percentage of the settlement amount , Public adjusters work exclusively for the policyholder . This means there should be no inherent conflict of interest when it comes to advocating on the policyholder &#x27;s behalf to the insurance company . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; Accounts receivable is a legally enforceable claim for payment held by a business for goods supplied and / or services rendered that customers / clients have ordered but not paid for . These are generally in the form of invoices raised by a business and delivered to the customer for payment within an agreed time frame . Accounts receivable is shown in a balance sheet as an asset . It is one of a series of accounting transactions dealing with the billing of a customer for goods and services that the customer has ordered . These may be distinguished from notes receivable , which are debts created through formal legal instruments called promissory notes . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; A common synonym for net profit when discussing financial statements ( which include a balance sheet and an income statement ) is the bottom line . This term results from the traditional appearance of an income statement which shows all allocated revenues and expenses over a specified time period with the resulting summation on the bottom line of the report . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;Table&gt; Electronic Fund Transfer Act &lt;Tr&gt; &lt;Td colspan=&quot;2&quot;&gt; &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Other short titles &lt;/Th&gt; &lt;Td&gt; &lt;Ul&gt; &lt;Li&gt; Financial Institutions Regulatory and Interest Rate Control Act of 1978 &lt;/Li&gt; &lt;Li&gt; Change in Bank Control Act &lt;/Li&gt; &lt;Li&gt; Change in Savings and Loan Control Act &lt;/Li&gt; &lt;Li&gt; Depository Institution Management Interlocks Act &lt;/Li&gt; &lt;Li&gt; Export - Import Bank Act Amendments &lt;/Li&gt; &lt;Li&gt; Federal Financial Institutions Examination Council Act &lt;/Li&gt; &lt;Li&gt; National Credit Union Central Liquidity Facility Act &lt;/Li&gt; &lt;Li&gt; Right to Financial Privacy Act &lt;/Li&gt; &lt;/Ul&gt; &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Long title &lt;/Th&gt; &lt;Td&gt; An Act to extend the authority for the flexible regulation of interest rates on deposits and accounts in depository institutions . &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Nicknames &lt;/Th&gt; &lt;Td&gt; American Arts Gold Medallion Act &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Enacted by &lt;/Th&gt; &lt;Td&gt; the 95th United States Congress &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Effective &lt;/Th&gt; &lt;Td&gt; November 10 , 1978 &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th colspan=&quot;2&quot;&gt; Citations &lt;/Th&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Public law &lt;/Th&gt; &lt;Td&gt; 95 - 630 &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Statutes at Large &lt;/Th&gt; &lt;Td&gt; 92 Stat. 3641 aka 92 Stat. 3728 &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th colspan=&quot;2&quot;&gt; Codification &lt;/Th&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Titles amended &lt;/Th&gt; &lt;Td&gt; &lt;Ul&gt; &lt;Li&gt; 12 U.S.C. : Banks and Banking &lt;/Li&gt; &lt;Li&gt; 15 U.S.C. : Commerce and Trade &lt;/Li&gt; &lt;/Ul&gt; &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; U.S.C. sections amended &lt;/Th&gt; &lt;Td&gt; &lt;Ul&gt; &lt;Li&gt; 12 U.S.C. ch. 3 § 226 et seq . &lt;/Li&gt; &lt;Li&gt; 15 U.S.C. ch. 41 § 1601 et seq . &lt;/Li&gt; &lt;Li&gt; 15 U.S.C. ch. 41 § 1693 et seq . &lt;/Li&gt; &lt;/Ul&gt; &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th colspan=&quot;2&quot;&gt; Legislative history &lt;/Th&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td colspan=&quot;2&quot;&gt; &lt;Ul&gt; &lt;Li&gt; Introduced in the House as H.R. 14279 by Fernand St. Germain ( D - RI ) on October 10 , 1978 &lt;/Li&gt; &lt;Li&gt; Committee consideration by House Banking , Finance , and Urban Affairs , Senate Banking , Housing , and Urban Affairs &lt;/Li&gt; &lt;Li&gt; Passed the House on October 11 , 1978 ( passed ) &lt;/Li&gt; &lt;Li&gt; Passed the Senate on October 12 , 1978 ( passed ) with amendment &lt;/Li&gt; &lt;Li&gt; House agreed to Senate amendment on October 14 , 1978 ( 341 - 32 , in lieu of H. Res. 1439 ) with further amendment &lt;/Li&gt; &lt;Li&gt; Senate agreed to House amendment on October 14 , 1978 ( agreed ) &lt;/Li&gt; &lt;Li&gt; Signed into law by President Jimmy Carter on November 10 , 1978 &lt;/Li&gt; &lt;/Ul&gt; &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th colspan=&quot;2&quot;&gt; Major amendments &lt;/Th&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td colspan=&quot;2&quot;&gt; Credit CARD Act of 2009 &lt;/Td&gt; &lt;/Tr&gt; &lt;/Table&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; Financial management refers to the efficient and effective management of money ( funds ) in such a manner as to accomplish the objectives of the organization . It is the specialized function directly associated with the top management . The significance of this function is not seen in the &#x27; Line &#x27; but also in the capacity of the &#x27; Staff &#x27; in overall of a company . It has been defined differently by different experts in the field . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; Form 990 ( officially , the `` Return of Organization Exempt From Income Tax &#x27;&#x27; ) is a United States Internal Revenue Service form that provides the public with financial information about a nonprofit organization . It is often the only source of such information . It is also used by government agencies to prevent organizations from abusing their tax - exempt status . Certain nonprofits have more comprehensive reporting requirements , such as hospitals and other health care organizations ( Schedule H ) . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The Board of Governors of the Federal Reserve System , commonly known as the Federal Reserve Board , is the main governing body of the Federal Reserve System . It is charged with overseeing the Federal Reserve Banks and with helping implement monetary policy of the United States . Governors are appointed by the President of the United States and confirmed by the Senate for staggered 14 - year terms . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The International Monetary Fund ( IMF ) is an international organization headquartered in Washington , D.C. , of `` 189 countries working to foster global monetary cooperation , secure financial stability , facilitate international trade , promote high employment and sustainable economic growth , and reduce poverty around the world . &#x27;&#x27; Formed in 1945 at the Bretton Woods Conference primarily by the ideas of Harry Dexter White and John Maynard Keynes , it came into formal existence in 1945 with 29 member countries and the goal of reconstructing the international payment system . It now plays a central role in the management of balance of payments difficulties and international financial crises . Countries contribute funds to a pool through a quota system from which countries experiencing balance of payments problems can borrow money . As of 2016 , the fund had SDR 477 billion ( about $668 billion ) . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;Li&gt; Callability -- Some bonds give the issuer the right to repay the bond before the maturity date on the call dates ; see call option . These bonds are referred to as callable bonds . Most callable bonds allow the issuer to repay the bond at par . With some bonds , the issuer has to pay a premium , the so - called call premium . This is mainly the case for high - yield bonds . These have very strict covenants , restricting the issuer in its operations . To be free from these covenants , the issuer can repay the bonds early , but only at a high cost . &lt;/Li&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; On November 7 , 2016 , debt held by the public was $14.3 trillion or about 76 % of the previous 12 months of GDP . Intragovernmental holdings stood at $5.4 trillion , giving a combined total gross national debt of $19.8 trillion or about 106 % of the previous 12 months of GDP ; $6.2 trillion or approximately 45 % of the debt held by the public was owned by foreign investors , the largest of which were Japan and China at about $1.09 trillion for Japan and $1.06 trillion for China as of December 2016 . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; A currency transaction report ( CTR ) is a report that U.S. financial institutions are required to file with FinCEN for each deposit , withdrawal , exchange of currency , or other payment or transfer , by , through , or to the financial institution which involves a transaction in currency of more than $10,000 . Used in this context , currency means the coin and / or paper money of any country that is designated as legal tender by the country of issuance . Currency also includes U.S. silver certificates , U.S. notes , Federal Reserve notes , and official foreign bank notes . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; Checks and balances is the principle that each of the Branches has the power to limit or check the other two and this creates a balance between the three separate powers of the state , this principle induces that the ambitions of one branch prevent that one of the other branches become supreme , and thus be eternally confronting each other and in that process leaving the people free from government abuses . Checks and Balances are designed to maintain the system of separation of powers keeping each branch in its place . This is based on the idea that it is not enough to separate the powers and guarantee their independence but to give the various branches the constitutional means to defend their own legitimate powers from the encroachments of the other branches . They guarantee that the powers of the State have the same weight ( co-equal ) , that is , to be balanced , so that they can limit each other , avoiding the abuse of state power . the origin of checks and balances , like separation of powers itself , is specifically credited to Montesquieu in the Enlightenment ( in The Spirit of the Laws , 1748 ) , under this influence was implemented in 1787 in the Constitution of the United States . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Non controlling interest on balance sheet refers to the portion of a subsidiary corporation&#x27;s stock that is not owned by the parent corporation. It represents ownership of less than 50% of the outstanding shares. It is shown as a separate line item in the equity section of the balance sheet.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;  Below are outputs of Case 2  &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">doc_ids:  [[&#x27;doc_1&#x27;, &#x27;doc_1097&#x27;, &#x27;doc_4221&#x27;, &#x27;doc_4972&#x27;, &#x27;doc_1352&#x27;, &#x27;doc_96&#x27;, &#x27;doc_988&#x27;, &#x27;doc_2370&#x27;, &#x27;doc_2414&#x27;, &#x27;doc_5038&#x27;, &#x27;doc_302&#x27;, &#x27;doc_1608&#x27;, &#x27;doc_980&#x27;, &#x27;doc_2112&#x27;, &#x27;doc_562&#x27;, &#x27;doc_4204&#x27;, &#x27;doc_3298&#x27;, &#x27;doc_2995&#x27;, &#x27;doc_3978&#x27;, &#x27;doc_1258&#x27;, &#x27;doc_2971&#x27;, &#x27;doc_2171&#x27;, &#x27;doc_1065&#x27;, &#x27;doc_17&#x27;, &#x27;doc_2683&#x27;, &#x27;doc_87&#x27;, &#x27;doc_1767&#x27;, &#x27;doc_158&#x27;, &#x27;doc_482&#x27;, &#x27;doc_3850&#x27;]]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_1 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_1097 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_4221 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_4972 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_1352 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_96 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_988 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_2370 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_2414 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_5038 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_302 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_1608 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_980 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_2112 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_562 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_4204 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_3298 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_2995 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_3978 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_1258 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_2971 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_2171 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_1065 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_17 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_2683 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You&#x27;re a retrieve augmented chatbot. You answer user&#x27;s questions based on your own knowledge and the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">context provided by the user.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">If you can&#x27;t answer the question with or without the current context, you should reply exactly `UPDATE CONTEXT`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You must give as short an answer as possible.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">User&#x27;s question is: how many episodes are in chicago fire season 4</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context is: &lt;P&gt; The fourth season of Chicago Fire , an American drama television series with executive producer Dick Wolf , and producers Derek Haas , Michael Brandt , and Matt Olmstead , was ordered on February 5 , 2015 , by NBC , and premiered on October 13 , 2015 and concluded on May 17 , 2016 . The season contained 23 episodes . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The fourth season began airing on October 10 , 2017 , and is set to run for 23 episodes on The CW until May 22 , 2018 . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The fourth season began airing on October 10 , 2017 , on The CW . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The fifth season of Chicago P.D. , an American police drama television series with executive producer Dick Wolf , and producers Derek Haas , Michael Brandt , and Rick Eid , premiered on September 27 , 2017 . This season featured its 100th episode . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; This was the city of Chicago &#x27;s first professional sports championship since the Chicago Fire won MLS Cup &#x27; 98 ( which came four months after the Chicago Bulls &#x27; sixth NBA championship that year ) . The next major Chicago sports championship came in 2010 , when the NHL &#x27;s Chicago Blackhawks ended a 49 - year Stanley Cup title drought . With the Chicago Bears &#x27; win in Super Bowl XX and the Chicago Cubs &#x27; own World Series championship in 2016 , all Chicago sports teams have won at least one major championship since 1985 . Meanwhile , the Astros themselves made it back to the World Series in 2017 , but this time as an AL team , where they defeated the Los Angeles Dodgers in seven games , resulting in Houston &#x27;s first professional sports championship since the 2006 -- 07 Houston Dynamo won their back - to - back MLS Championships . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The season was ordered in May 2017 , and production began the following month . Ben McKenzie stars as Gordon , alongside Donal Logue , David Mazouz , Morena Baccarin , Sean Pertwee , Robin Lord Taylor , Erin Richards , Camren Bicondova , Cory Michael Smith , Jessica Lucas , Chris Chalk , Drew Powell , Crystal Reed and Alexander Siddig . The fourth season premiered on September 21 , 2017 , on Fox , while the second half premiered on March 1 , 2018 . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; As of May 24 , 2017 , 58 episodes of The 100 have aired , concluding the fourth season . In March 2017 , The CW renewed the series for a fifth season , set to premiere on April 24 , 2018 . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The fifth book , River of Fire , is scheduled to be released on April 10 , 2018 . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; On September 10 , 2013 , AMC officially cancelled the series after 38 episodes and three seasons . However , on November 15 , 2013 , Netflix ordered a fourth and final season of six episodes , that was released on Netflix on August 1 , 2014 . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The second season of Fargo , an American anthology black comedy -- crime drama television series created by Noah Hawley , premiered on October 12 , 2015 , on the basic cable network FX . Its principal cast consists of Kirsten Dunst , Patrick Wilson , Jesse Plemons , Jean Smart , and Ted Danson . The season had ten episodes , and its initial airing concluded on December 14 , 2015 . As an anthology , each Fargo season possesses its own self - contained narrative , following a disparate set of characters in various settings . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The Great Fire of London was a major conflagration that swept through the central parts of the English city of London from Sunday , 2 September to Wednesday , 5 September 1666 . The fire gutted the medieval City of London inside the old Roman city wall . It threatened but did not reach the aristocratic district of Westminster , Charles II &#x27;s Palace of Whitehall , and most of the suburban slums . It consumed 13,200 houses , 87 parish churches , St Paul &#x27;s Cathedral , and most of the buildings of the City authorities . It is estimated to have destroyed the homes of 70,000 of the City &#x27;s 80,000 inhabitants . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The first season consisted of eight one - hour - long episodes which were released worldwide on Netflix on July 15 , 2016 , in Ultra HD 4K . The second season , consisting of nine episodes , was released on October 27 , 2017 in HDR . A teaser for the second season , which also announced the release date , aired during Super Bowl LI . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; `` Two Days Before the Day After Tomorrow &#x27;&#x27; is the eighth episode in the ninth season of the American animated television series South Park . The 133rd overall episode overall , it originally aired on Comedy Central in the United States on October 19 , 2005 . In the episode , Stan and Cartman accidentally destroy a dam , causing the town of Beaverton to be destroyed . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The fourth season consists of a double order of twenty episodes , split into two parts of ten episodes ; the second half premiered on November 30 , 2016 . The season follows the battles between Ragnar and Rollo in Francia , Bjorn &#x27;s raid into the Mediterranean , and the Viking invasion of England . It concluded in its entirety on February 1 , 2017 . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; This is an episode list for Sabrina the Teenage Witch , an American sitcom that debuted on ABC in 1996 . From Season 5 , the program was aired on The WB . The series ran for seven seasons totaling 163 episodes . It originally premiered on September 27 , 1996 on ABC and ended on April 24 , 2003 on The WB . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; Hart of Dixie was renewed by The CW for 10 episode season on May 8 , 2014 . The show &#x27;s fourth and final season premiered on November 15 , 2014 . The series was later cancelled on May 7 , 2015 . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The Burning Maze is the third book in the series . It is scheduled to be released on May 1 , 2018 . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;Table&gt; &lt;Tr&gt; &lt;Th colspan=&quot;2&quot;&gt; My Name Is Earl ( season 4 ) &lt;/Th&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td colspan=&quot;2&quot;&gt; DVD cover &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Country of origin &lt;/Th&gt; &lt;Td&gt; United States &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; No. of episodes &lt;/Th&gt; &lt;Td&gt; 27 &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th colspan=&quot;2&quot;&gt; Release &lt;/Th&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Original network &lt;/Th&gt; &lt;Td&gt; NBC &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Original release &lt;/Th&gt; &lt;Td&gt; September 25 , 2008 -- May 14 , 2009 &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th colspan=&quot;2&quot;&gt; Season chronology &lt;/Th&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td colspan=&quot;2&quot;&gt; ← Previous Season 3 &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td colspan=&quot;2&quot;&gt; List of My Name Is Earl episodes &lt;/Td&gt; &lt;/Tr&gt; &lt;/Table&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The eighteenth season of Law &amp; Order : Special Victims Unit debuted on Wednesday , September 21 , 2016 , on NBC and finished on Wednesday , May 24 , 2017 , with a two - hour season finale . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The eighth and final season of the fantasy drama television series Game of Thrones was announced by HBO in July 2016 . Unlike the first six seasons that each had ten episodes and the seventh that had seven episodes , the eighth season will have only six episodes . Like the previous season , it will largely consist of original content not found currently in George R.R. Martin &#x27;s A Song of Ice and Fire series , and will instead adapt material Martin has revealed to showrunners about the upcoming novels in the series , The Winds of Winter and A Dream of Spring . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; A total of 49 episodes of The Glades were produced and aired over four seasons . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; Sneaky Pete is an American crime drama series created by David Shore and Bryan Cranston . The series follows Marius Josipović ( Giovanni Ribisi ) , a released convict who adopts the identity of his cell mate , Pete Murphy , in order to avoid his past life . The series also stars Marin Ireland , Shane McRae , Libe Barer , Michael Drayer , Peter Gerety , and Margo Martindale . The pilot debuted on August 7 , 2015 , and was followed by a full series order that September . Shore left the project in early 2016 and was replaced by Graham Yost , who served as executive producer and showrunner for the remaining nine episodes . The first season premiered in its entirety on January 13 , 2017 , exclusively on Amazon Video . On January 19 , 2017 , Amazon announced that Sneaky Pete had been renewed for a second season , which was released on March 9 , 2018 . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The eighth season of Blue Bloods , a police procedural drama series created by Robin Green and Mitchell Burgess , premiered on CBS on September 29 , 2017 . The season is set to contain 22 episodes . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The first five seasons of Prison Break have been released on DVD and Blu - ray in Regions 1 , 2 , and 4 . Each DVD boxed set includes all of the broadcast episodes from that season , the associated special episode , commentary from cast and crew , and profiles of various parts of Prison Break , such as Fox River State Penitentiary or the tattoo . Prison Break is also available online , including iTunes , Amazon Video , and Netflix . After the premiere of the second season of Prison Break , Fox began online streaming of the prior week &#x27;s episode , though it originally restricted viewing to the United States . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; In June 2017 , Remini was upped to a series regular starting with Season 2 ; shortly after , it was announced that Erinn Hayes would not be returning for the show &#x27;s second season . Sources cited in a Variety article confirmed that Remini would be returning as Detective Vanessa Cellucci , the character she portrayed in the first - season finale , and that Hayes &#x27; dismissal was for creative reasons and `` not a reflection &#x27;&#x27; of the actress &#x27; performance . In August 2017 , it was reported Hayes &#x27; character will be killed off before season two begins and the season will take place 7 -- 10 months after season one ended , in order to make room for Remini . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">There are 23 episodes in Chicago Fire season 4.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;  Below are outputs of Case 3  &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">doc_ids:  [[&#x27;doc_47&#x27;, &#x27;doc_45&#x27;, &#x27;doc_2570&#x27;, &#x27;doc_2851&#x27;, &#x27;doc_4033&#x27;, &#x27;doc_5320&#x27;, &#x27;doc_3849&#x27;, &#x27;doc_4172&#x27;, &#x27;doc_3202&#x27;, &#x27;doc_2282&#x27;, &#x27;doc_1896&#x27;, &#x27;doc_949&#x27;, &#x27;doc_103&#x27;, &#x27;doc_1552&#x27;, &#x27;doc_2791&#x27;, &#x27;doc_392&#x27;, &#x27;doc_1175&#x27;, &#x27;doc_5315&#x27;, &#x27;doc_832&#x27;, &#x27;doc_3185&#x27;, &#x27;doc_2532&#x27;, &#x27;doc_3409&#x27;, &#x27;doc_824&#x27;, &#x27;doc_4075&#x27;, &#x27;doc_1201&#x27;, &#x27;doc_4116&#x27;, &#x27;doc_1448&#x27;, &#x27;doc_2545&#x27;, &#x27;doc_2251&#x27;, &#x27;doc_2485&#x27;]]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_47 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_45 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_2570 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_2851 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_4033 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_5320 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_3849 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_4172 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_3202 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_2282 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_1896 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_949 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_103 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_1552 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_2791 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_392 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_1175 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_5315 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_832 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_3185 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_2532 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You&#x27;re a retrieve augmented chatbot. You answer user&#x27;s questions based on your own knowledge and the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">context provided by the user.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">If you can&#x27;t answer the question with or without the current context, you should reply exactly `UPDATE CONTEXT`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You must give as short an answer as possible.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">User&#x27;s question is: what are bulls used for on a farm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context is: &lt;P&gt; Many cattle ranches and stations run bulls with cows , and most dairy or beef farms traditionally had at least one , if not several , bulls for purposes of herd maintenance . However , the problems associated with handling a bull ( particularly where cows must be removed from its presence to be worked ) has prompted many dairy farmers to restrict themselves to artificial insemination ( AI ) of the cows . Semen is removed from the bulls and stored in canisters of liquid nitrogen , where it is kept until it can be sold , at which time it can be very profitable , in fact , many ranchers keep bulls specifically for this purpose . AI is also used to increase the quality of a herd , or to introduce an outcross of bloodlines . Some ranchers prefer to use AI to allow them to breed to several different bulls in a season or to breed their best stock to a higher quality bull than they could afford to purchase outright . AI may also be used in conjunction with embryo transfer to allow cattle producers to add new breeding to their herds . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; Other than the few bulls needed for breeding , the vast majority of male cattle are slaughtered for meat before the age of three years , except where they are needed ( castrated ) as work oxen for haulage . Most of these beef animals are castrated as calves to reduce aggressive behavior and prevent unwanted mating , although some are reared as uncastrated bull beef . A bull is typically ready for slaughter one or two months sooner than a castrated male or a female , and produces proportionately more , leaner muscle . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; Pastoral farming is the major land use but there are increases in land area devoted to horticulture . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; Animal fibers are natural fibers that consist largely of particular proteins . Instances are silk , hair / fur ( including wool ) and feathers . The animal fibers used most commonly both in the manufacturing world as well as by the hand spinners are wool from domestic sheep and silk . Also very popular are alpaca fiber and mohair from Angora goats . Unusual fibers such as Angora wool from rabbits and Chiengora from dogs also exist , but are rarely used for mass production . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; In 2012 , there were 3.2 million farmers , ranchers and other agricultural managers and an estimated 757,900 agricultural workers were legally employed in the US . Animal breeders accounted for 11,500 of those workers with the rest categorized as miscellaneous agricultural workers . The median pay was $9.12 per hour or $18,970 per year . In 2009 , about 519,000 people under age 20 worked on farms owned by their family . In addition to the youth who lived on family farms , an additional 230,000 youth were employed in agriculture . In 2004 , women made up approximately 24 % of farmers ; that year , there were 580,000 women employed in agriculture , forestry , and fishing . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The recipe can vary widely . The defining ingredients are minced meat ( commonly beef when named cottage pie or lamb when named shepherd &#x27;s pie ) , typically cooked in a gravy with onions and sometimes other vegetables , such as peas , celery or carrots , and topped with mashed potato . The pie is sometimes also topped with grated cheese . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The history of the domesticated sheep goes back to between 11000 and 9000 BC , and the domestication of the wild mouflon in ancient Mesopotamia . Sheep are among the first animals to have been domesticated by humans , and there is evidence of sheep farming in Iranian statuary dating to that time period . These sheep were primarily raised for meat , milk , and skins . Woolly sheep began to be developed around 6000 BC in Iran , and cultures such as the Persians relied on sheep &#x27;s wool for trading . They were then imported to Africa and Europe via trading . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; Although large - scale use of wheels did not occur in the Americas prior to European contact , numerous small wheeled artifacts , identified as children &#x27;s toys , have been found in Mexican archeological sites , some dating to about 1500 BC . It is thought that the primary obstacle to large - scale development of the wheel in the Americas was the absence of domesticated large animals which could be used to pull wheeled carriages . The closest relative of cattle present in Americas in pre-Columbian times , the American Bison , is difficult to domesticate and was never domesticated by Native Americans ; several horse species existed until about 12,000 years ago , but ultimately became extinct . The only large animal that was domesticated in the Western hemisphere , the llama , did not spread far beyond the Andes by the time of the arrival of Columbus . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The Call of the Wild is a short adventure novel by Jack London published in 1903 and set in Yukon , Canada during the 1890s Klondike Gold Rush , when strong sled dogs were in high demand . The central character of the novel is a dog named Buck . The story opens at a ranch in Santa Clara Valley , California , when Buck is stolen from his home and sold into service as a sled dog in Alaska . He becomes progressively feral in the harsh environment , where he is forced to fight to survive and dominate other dogs . By the end , he sheds the veneer of civilization , and relies on primordial instinct and learned experience to emerge as a leader in the wild . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The Three Little Pigs was included in The Nursery Rhymes of England ( London and New York , c. 1886 ) , by James Halliwell - Phillipps . The story in its arguably best - known form appeared in English Fairy Tales by Joseph Jacobs , first published in 1890 and crediting Halliwell as his source . The story begins with the title characters being sent out into the world by their mother , to `` seek out their fortune &#x27;&#x27; . The first little pig builds a house of straw , but a wolf blows it down and devours him . The second little pig builds a house of sticks , which the wolf also blows down , and the second little pig is also devoured . Each exchange between wolf and pig features ringing proverbial phrases , namely : &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; `` How now brown cow &#x27;&#x27; ( / ˈhaʊ ˈnaʊ ˈbraʊn ˈkaʊ / ) is a phrase used in elocution teaching to demonstrate rounded vowel sounds . Each `` ow &#x27;&#x27; sound in the phrase represents the diphthong / aʊ / . Although orthographies for each of the four words in this utterance is represented by the English spelling `` ow &#x27;&#x27; , the articulation required to create this same diphthong represented by the International Phonetic Association &#x27;s phonetic alphabet as / aʊ / is also represented by the spelling `` ou &#x27;&#x27; . Some examples of these homophonic / aʊ / &#x27;s are the English words `` house &#x27;&#x27; , `` blouse &#x27;&#x27; , `` noun &#x27;&#x27; , and `` cloud &#x27;&#x27; . The use of the phrase `` how now brown cow &#x27;&#x27; in teaching elocution can be dated back to at least 1926 . Although not in use today , the phrase `` how now &#x27;&#x27; is a greeting , short for `` how say you now &#x27;&#x27; , and can be found in archaic literature , such as the plays of William Shakespeare . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; Brisket is a cut of meat from the breast or lower chest of beef or veal . The beef brisket is one of the nine beef primal cuts , though the precise definition of the cut differs internationally . The brisket muscles include the superficial and deep pectorals . As cattle do not have collar bones , these muscles support about 60 % of the body weight of standing / moving cattle . This requires a significant amount of connective tissue , so the resulting meat must be cooked correctly to tenderize the connective tissue . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The music to `` Man Gave Names to All the Animals &#x27;&#x27; is reggae - inspired . The lyrics were inspired by the biblical Book of Genesis , verses 2 : 19 -- 20 in which Adam named the animals and birds . The lyrics have an appeal to children , rhyming the name of the animal with one of its characteristics . So after describing an animal &#x27;s `` muddy trail &#x27;&#x27; and `` curly tail , &#x27;&#x27; Dylan sings that `` he was n&#x27;t too small and he was n&#x27;t too big &#x27;&#x27; and so that animal was named a pig . Similarly , the cow got its name because Adam `` saw milk comin &#x27; out but he did n&#x27;t know how &#x27;&#x27; and the bear got its name because it has a `` great big furry back and furry hair . &#x27;&#x27; &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; As early as 1671 railed roads were in use in Durham to ease the conveyance of coal ; the first of these was the Tanfield Wagonway . Many of these tramroads or wagon ways were built in the 17th and 18th centuries . They used simply straight and parallel rails of timber on which carts with simple flanged iron wheels were drawn by horses , enabling several wagons to be moved simultaneously . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; Unicorns are not found in Greek mythology , but rather in the accounts of natural history , for Greek writers of natural history were convinced of the reality of unicorns , which they believed lived in India , a distant and fabulous realm for them . The earliest description is from Ctesias , who in his book Indika ( `` On India &#x27;&#x27; ) described them as wild asses , fleet of foot , having a horn a cubit and a half ( 700 mm , 28 inches ) in length , and colored white , red and black . Aristotle must be following Ctesias when he mentions two one - horned animals , the oryx ( a kind of antelope ) and the so - called `` Indian ass &#x27;&#x27; . Strabo says that in the Caucasus there were one - horned horses with stag - like heads . Pliny the Elder mentions the oryx and an Indian ox ( perhaps a rhinoceros ) as one - horned beasts , as well as `` a very fierce animal called the monoceros which has the head of the stag , the feet of the elephant , and the tail of the boar , while the rest of the body is like that of the horse ; it makes a deep lowing noise , and has a single black horn , which projects from the middle of its forehead , two cubits ( 900 mm , 35 inches ) in length . &#x27;&#x27; In On the Nature of Animals ( Περὶ Ζῴων Ἰδιότητος , De natura animalium ) , Aelian , quoting Ctesias , adds that India produces also a one - horned horse ( iii. 41 ; iv. 52 ) , and says ( xvi. 20 ) that the monoceros ( Greek : μονόκερως ) was sometimes called cartazonos ( Greek : καρτάζωνος ) , which may be a form of the Arabic karkadann , meaning `` rhinoceros &#x27;&#x27; . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The First Battle of Bull Run ( the name used by Union forces ) , also known as the First Battle of Manassas ( the name used by Confederate forces ) , was fought on July 21 , 1861 in Prince William County , Virginia , just north of the city of Manassas and about 25 miles west - southwest of Washington , D.C. It was the first major battle of the American Civil War . The Union &#x27;s forces were slow in positioning themselves , allowing Confederate reinforcements time to arrive by rail . Each side had about 18,000 poorly trained and poorly led troops in their first battle . It was a Confederate victory , followed by a disorganized retreat of the Union forces . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; Hops production is concentrated in moist temperate climates , with much of the world &#x27;s production occurring near the 48th parallel north . Hop plants prefer the same soils as potatoes and the leading potato - growing states in the United States are also major hops - producing areas ; however , not all potato - growing areas can produce good hops naturally : soils in the Maritime Provinces of Canada , for example , lack the boron that hops prefer . Historically , hops were not grown in Ireland , but were imported from England . In 1752 more than 500 tons of English hops were imported through Dublin alone . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; Shepherd &#x27;s pie or cottage pie is a meat pie with a crust of mashed potato . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; Castles served a range of purposes , the most important of which were military , administrative , and domestic . As well as defensive structures , castles were also offensive tools which could be used as a base of operations in enemy territory . Castles were established by Norman invaders of England for both defensive purposes and to pacify the country &#x27;s inhabitants . As William the Conqueror advanced through England , he fortified key positions to secure the land he had taken . Between 1066 and 1087 , he established 36 castles such as Warwick Castle , which he used to guard against rebellion in the English Midlands . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The Rocky and Bullwinkle Show remained in syndicated reruns and was still available for local television stations through The Program Exchange as late as 2016 ; WBBZ - TV , for instance , aired the show in a strip to counterprogram 10 PM newscasts in the Buffalo , New York market during the summer 2013 season . The underlying rights are now owned by Universal Pictures , which holds the library of predecessor companies DreamWorks Animation and Classic Media , and who in turn with copyright holder Ward Productions forms the joint venture Bullwinkle Studios , which manages the Rocky and Bullwinkle properties ; Universal &#x27;s purchase of Classic Media coincided with The Program Exchange &#x27;s shutdown . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; When Yellowstone National Park was created in 1872 , gray wolf ( Canis lupus ) populations were already in decline in Montana , Wyoming and Idaho . The creation of the national park did not provide protection for wolves or other predators , and government predator control programs in the first decades of the 1900s essentially helped eliminate the gray wolf from Yellowstone . The last wolves were killed in Yellowstone in 1926 . After that time , sporadic reports of wolves still occurred , but scientists confirmed that sustainable wolf populations had been extirpated and were absent from Yellowstone during the mid-1900s . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Bulls are used for breeding and often kept for their semen to sell for AI purposes. Some male cattle are also kept as work oxen for haulage. The vast majority, however, are slaughtered for meat before the age of three years.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;  Below are outputs of Case 4  &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">doc_ids:  [[&#x27;doc_3031&#x27;, &#x27;doc_819&#x27;, &#x27;doc_4521&#x27;, &#x27;doc_3980&#x27;, &#x27;doc_3423&#x27;, &#x27;doc_5275&#x27;, &#x27;doc_745&#x27;, &#x27;doc_753&#x27;, &#x27;doc_3562&#x27;, &#x27;doc_4139&#x27;, &#x27;doc_3678&#x27;, &#x27;doc_4931&#x27;, &#x27;doc_2347&#x27;, &#x27;doc_1115&#x27;, &#x27;doc_2806&#x27;, &#x27;doc_5204&#x27;, &#x27;doc_2707&#x27;, &#x27;doc_3653&#x27;, &#x27;doc_1122&#x27;, &#x27;doc_2398&#x27;, &#x27;doc_309&#x27;, &#x27;doc_3891&#x27;, &#x27;doc_2087&#x27;, &#x27;doc_330&#x27;, &#x27;doc_4844&#x27;, &#x27;doc_2155&#x27;, &#x27;doc_2674&#x27;, &#x27;doc_5357&#x27;, &#x27;doc_1581&#x27;, &#x27;doc_9&#x27;]]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_3031 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_819 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_4521 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_3980 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_3423 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_5275 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_745 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_753 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_3562 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You&#x27;re a retrieve augmented chatbot. You answer user&#x27;s questions based on your own knowledge and the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">context provided by the user.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">If you can&#x27;t answer the question with or without the current context, you should reply exactly `UPDATE CONTEXT`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You must give as short an answer as possible.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">User&#x27;s question is: has been honoured with the wisden leading cricketer in the world award for 2016</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context is: &lt;P&gt; The first recipient was Uttam Kumar from Bengali cinema , who was honoured at the 15th National Film Awards in 1968 for his performances in Anthony Firingee and Chiriyakhana . As of 2017 , Amitabh Bachchan is the most honoured actor , with four awards . Two actors -- Kamal Haasan and Mammootty -- have been honoured three times , while six actors -- Sanjeev Kumar , Mithun Chakraborty , Om Puri , Naseeruddin Shah , Mohanlal , and Ajay Devgn -- have won the award two times . Two actors have achieved the honour for performing in two languages -- Mithun Chakraborty ( Hindi and Bengali ) and Mammootty ( Malayalam and English ) . The most recent recipient is Riddhi Sen , who was honoured at the 65th National Film Awards for his performance in the Bengali film Nagarkirtan . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; There was controversy over the National Film Award for Best Actor , which the committee awarded to Akshay Kumar for his performance in Rustom , snubbing Aamir Khan &#x27;s performance for Dangal . Committee member Priyadarshan , who has worked with Kumar on several films , gave the following explanation for awarding Kumar instead of Khan : &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The 2017 ICC Champions Trophy was the eighth ICC Champions Trophy , a cricket tournament for the eight top - ranked One Day International ( ODI ) teams in the world . It was held in England and Wales from 1 June to 18 June 2017 . Pakistan won the competition for the first time with a 180 - run victory over India in the final at The Oval . The margin of victory was the largest by any team in the final of an ICC ODI tournament in terms of runs . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;Table&gt; List of One Day International cricket double centuries &lt;Tr&gt; &lt;Th&gt; No . &lt;/Th&gt; &lt;Th&gt; Runs &lt;/Th&gt; &lt;Th&gt; Batsman &lt;/Th&gt; &lt;Th&gt; S / R &lt;/Th&gt; &lt;Th&gt; For &lt;/Th&gt; &lt;Th&gt; Against &lt;/Th&gt; &lt;Th&gt; ODI &lt;/Th&gt; &lt;Th&gt; Venue &lt;/Th&gt; &lt;Th&gt; Date &lt;/Th&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; 200 * &lt;/Td&gt; &lt;Td&gt; Tendulkar , Sachin Sachin Tendulkar &lt;/Td&gt; &lt;Td&gt; 136.05 &lt;/Td&gt; &lt;Td&gt; India &lt;/Td&gt; &lt;Td&gt; South Africa &lt;/Td&gt; &lt;Td&gt; 2962 &lt;/Td&gt; &lt;Td&gt; Captain Roop Singh Stadium , Gwalior , India &lt;/Td&gt; &lt;Td&gt; 24 February 2010 &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; 219 &lt;/Td&gt; &lt;Td&gt; Sehwag , Virender Virender Sehwag &lt;/Td&gt; &lt;Td&gt; 146.98 &lt;/Td&gt; &lt;Td&gt; India &lt;/Td&gt; &lt;Td&gt; West Indies &lt;/Td&gt; &lt;Td&gt; 3223 &lt;/Td&gt; &lt;Td&gt; Holkar Stadium , Indore , India &lt;/Td&gt; &lt;Td&gt; 8 December 2011 &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; 209 &lt;/Td&gt; &lt;Td&gt; Sharma , Rohit Rohit Sharma &lt;/Td&gt; &lt;Td&gt; 132.28 &lt;/Td&gt; &lt;Td&gt; India &lt;/Td&gt; &lt;Td&gt; Australia &lt;/Td&gt; &lt;Td&gt; 3428 &lt;/Td&gt; &lt;Td&gt; M. Chinnaswamy Stadium , Bangalore , India &lt;/Td&gt; &lt;Td&gt; 2 November 2013 &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; 264 &lt;/Td&gt; &lt;Td&gt; Sharma , Rohit Rohit Sharma &lt;/Td&gt; &lt;Td&gt; 152.60 &lt;/Td&gt; &lt;Td&gt; India &lt;/Td&gt; &lt;Td&gt; Sri Lanka &lt;/Td&gt; &lt;Td&gt; 3544 &lt;/Td&gt; &lt;Td&gt; Eden Gardens , India &lt;/Td&gt; &lt;Td&gt; 13 November 2014 &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 5 &lt;/Td&gt; &lt;Td&gt; 215 &lt;/Td&gt; &lt;Td&gt; Gayle , Chris Chris Gayle &lt;/Td&gt; &lt;Td&gt; 146.30 &lt;/Td&gt; &lt;Td&gt; West Indies &lt;/Td&gt; &lt;Td&gt; Zimbabwe &lt;/Td&gt; &lt;Td&gt; 3612 &lt;/Td&gt; &lt;Td&gt; Manuka Oval , Canberra , Australia &lt;/Td&gt; &lt;Td&gt; 24 February 2015 &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 6 &lt;/Td&gt; &lt;Td&gt; 237 * &lt;/Td&gt; &lt;Td&gt; Guptill , Martin Martin Guptill &lt;/Td&gt; &lt;Td&gt; 145.40 &lt;/Td&gt; &lt;Td&gt; New Zealand &lt;/Td&gt; &lt;Td&gt; West Indies &lt;/Td&gt; &lt;Td&gt; 3643 &lt;/Td&gt; &lt;Td&gt; Wellington Regional Stadium , Wellington , New Zealand &lt;/Td&gt; &lt;Td&gt; 22 March 2015 &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 7 &lt;/Td&gt; &lt;Td&gt; 208 * &lt;/Td&gt; &lt;Td&gt; Sharma , Rohit Rohit Sharma &lt;/Td&gt; &lt;Td&gt; 135.95 &lt;/Td&gt; &lt;Td&gt; India &lt;/Td&gt; &lt;Td&gt; Sri Lanka &lt;/Td&gt; &lt;Td&gt; 3941 &lt;/Td&gt; &lt;Td&gt; Punjab Cricket Association IS Bindra Stadium , Mohali , India &lt;/Td&gt; &lt;Td&gt; 13 December 2017 &lt;/Td&gt; &lt;/Tr&gt; &lt;/Table&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; G. Sankara Kurup , ( 3 June 1901 , Nayathode , Kingdom of Cochin ( now in Ernakulam district , Kerala , India ) -- 2 February 1978 , Vappalassery , Angamaly , Ernakulam district , Kerala ) , better known as Mahakavi G ( The Great Poet G ) , was the first winner of the Jnanpith Award , India &#x27;s highest literary award . He won the prize in 1965 for his collection of poems in Malayalam Odakkuzhal ( The Bamboo Flute , 1950 ) . With part of the prize money he established the literary award Odakkuzhal in 1968 . He was also the recipient of the Soviet Land Nehru Award , in 1967 , and the Padma Bhushan in 1968 . His poetry collection Viswadarshanam won the Kerala Sahitya Akademi Award in 1961 and Kendra Sahitya Akademi Award in 1963 . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The 2019 Cricket World Cup ( officially ICC Cricket World Cup 2019 ) is the 12th edition of the Cricket World Cup , scheduled to be hosted by England and Wales , from 30 May to 14 July 2019 . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;Table&gt; 2018 Under - 19 Cricket World Cup &lt;Tr&gt; &lt;Td colspan=&quot;2&quot;&gt; &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Dates &lt;/Th&gt; &lt;Td&gt; 13 January -- 3 February 2018 &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Administrator ( s ) &lt;/Th&gt; &lt;Td&gt; International Cricket Council &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Cricket format &lt;/Th&gt; &lt;Td&gt; 50 overs &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Tournament format ( s ) &lt;/Th&gt; &lt;Td&gt; Round - robin and knockout &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Host ( s ) &lt;/Th&gt; &lt;Td&gt; New Zealand &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Champions &lt;/Th&gt; &lt;Td&gt; India ( 4th title ) &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Runners - up &lt;/Th&gt; &lt;Td&gt; Australia &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Participants &lt;/Th&gt; &lt;Td&gt; 16 &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Matches played &lt;/Th&gt; &lt;Td&gt; 48 &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Player of the series &lt;/Th&gt; &lt;Td&gt; Shubman Gill &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Most runs &lt;/Th&gt; &lt;Td&gt; Alick Athanaze ( 418 ) &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Most wickets &lt;/Th&gt; &lt;Td&gt; Anukul Roy ( 14 ) Qais Ahmad ( 14 ) Faisal Jamkhandi ( 14 ) &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Official website &lt;/Th&gt; &lt;Td&gt; Official website &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td colspan=&quot;2&quot;&gt; ← 2016 2020 → &lt;/Td&gt; &lt;/Tr&gt; &lt;/Table&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The 2018 ICC Under - 19 Cricket World Cup was an international limited - overs cricket tournament that was held in New Zealand from 13 January to 3 February 2018 . It was the twelfth edition of the Under - 19 Cricket World Cup , and the third to be held in New Zealand ( after the 2002 and 2010 events ) . New Zealand was the first country to host the event three times . The opening ceremony took place on 7 January 2018 . The West Indies were the defending champions . However , they failed to defend their title , after losing their first two group fixtures . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; Scoring over 10,000 runs across a playing career in any format of cricket is considered a significant achievement . In the year 2001 , Sachin Tendulkar became the first player to score 10,000 runs in ODIs , while playing a match during the bi-lateral series against Australia at home . In the chase for achieving top scores , West Indies &#x27; Desmond Haynes retired as the most prolific run - scorer in One Day Internationals ( ODIs ) , with a total of 8,648 runs in 1994 . The record stood for four years until it was broken by India &#x27;s Mohammed Azharuddin . Azharuddin remained the top - scorer in the format until his compatriot Sachin Tendulkar passed him in October 2000 . As of August 2016 , eleven players -- from six teams that are Full members of the International Cricket Council -- have scored more than 10,000 runs in ODIs . Four of these are from Sri Lanka and three from India . The rest are one player each from Pakistan , Australia , West Indies , and South Africa . Bangladesh , England , New Zealand , and Zimbabwe are yet to have a player reach the 10,000 - run mark in this format . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">I&#x27;m sorry, I couldn&#x27;t find any information about who has been honoured with the Wisden Leading Cricketer in the World award for 2016. UPDATE CONTEXT.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Updating context and resetting conversation.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_4139 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_3678 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_4931 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_2347 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_1115 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_2806 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_5204 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_2707 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_3653 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You&#x27;re a retrieve augmented chatbot. You answer user&#x27;s questions based on your own knowledge and the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">context provided by the user.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">If you can&#x27;t answer the question with or without the current context, you should reply exactly `UPDATE CONTEXT`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You must give as short an answer as possible.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">User&#x27;s question is: has been honoured with the wisden leading cricketer in the world award for 2016</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context is: &lt;Table&gt; List of the Indian Oscar nominee ( s ) / recipient ( s ) , also showing the year , film , category , and result &lt;Tr&gt; &lt;Th&gt; Year &lt;/Th&gt; &lt;Th&gt; Nominee ( s ) / recipient ( s ) &lt;/Th&gt; &lt;Th&gt; Film &lt;/Th&gt; &lt;Th&gt; Category / Honorary Award &lt;/Th&gt; &lt;Th&gt; Result / received &lt;/Th&gt; &lt;Th&gt; Ref . &lt;/Th&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 1958 ( 30th ) &lt;/Td&gt; &lt;Td&gt; Mehboob Khan &lt;/Td&gt; &lt;Td&gt; Mother India &lt;/Td&gt; &lt;Td&gt; Best Foreign Language Film &lt;/Td&gt; &lt;Td&gt; Nominated &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 1961 ( 33rd ) &lt;/Td&gt; &lt;Td&gt; Ismail Merchant &lt;/Td&gt; &lt;Td&gt; The Creation of Woman &lt;/Td&gt; &lt;Td&gt; Best Short Subject ( Live Action ) &lt;/Td&gt; &lt;Td&gt; Nominated &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 1979 ( 51st ) &lt;/Td&gt; &lt;Td&gt; Vidhu Vinod Chopra and K.K. Kapil &lt;/Td&gt; &lt;Td&gt; An Encounter with Faces &lt;/Td&gt; &lt;Td&gt; Best Documentary ( Short Subject ) &lt;/Td&gt; &lt;Td&gt; Nominated &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; ( 55th ) &lt;/Td&gt; &lt;Td&gt; Bhanu Athaiya &lt;/Td&gt; &lt;Td&gt; Gandhi &lt;/Td&gt; &lt;Td&gt; Best Costume Design &lt;/Td&gt; &lt;Td&gt; Won &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; Ravi Shankar &lt;/Td&gt; &lt;Td&gt; Best Original Score &lt;/Td&gt; &lt;Td&gt; Nominated &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; ( 59th ) &lt;/Td&gt; &lt;Td&gt; Ismail Merchant &lt;/Td&gt; &lt;Td&gt; A Room with a View &lt;/Td&gt; &lt;Td&gt; Best Picture &lt;/Td&gt; &lt;Td&gt; Nominated &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; ( 61st ) &lt;/Td&gt; &lt;Td&gt; Mira Nair &lt;/Td&gt; &lt;Td&gt; Salaam Bombay ! &lt;/Td&gt; &lt;Td&gt; Best Foreign Language Film &lt;/Td&gt; &lt;Td&gt; Nominated &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 1992 ( 64th ) &lt;/Td&gt; &lt;Td&gt; Satyajit Ray &lt;/Td&gt; &lt;Td&gt; Pather Pachali &lt;/Td&gt; &lt;Td&gt; Honorary Award &lt;/Td&gt; &lt;Td&gt; Received &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; ( 65th ) &lt;/Td&gt; &lt;Td&gt; Ismail Merchant &lt;/Td&gt; &lt;Td&gt; Howards End &lt;/Td&gt; &lt;Td&gt; Best Picture &lt;/Td&gt; &lt;Td&gt; Nominated &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; ( 66th ) &lt;/Td&gt; &lt;Td&gt; Ismail Merchant &lt;/Td&gt; &lt;Td&gt; The Remains of the Day &lt;/Td&gt; &lt;Td&gt; Best Picture &lt;/Td&gt; &lt;Td&gt; Nominated &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 2002 ( 74th ) &lt;/Td&gt; &lt;Td&gt; Ashutosh Gowarikar &lt;/Td&gt; &lt;Td&gt; Lagaan &lt;/Td&gt; &lt;Td&gt; Best Foreign Language Film &lt;/Td&gt; &lt;Td&gt; Nominated &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 2005 ( 77th ) &lt;/Td&gt; &lt;Td&gt; Ashvin Kumar &lt;/Td&gt; &lt;Td&gt; Little Terrorist &lt;/Td&gt; &lt;Td&gt; Best Short Subject ( Live Action ) &lt;/Td&gt; &lt;Td&gt; Nominated &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 2007 ( 79th ) &lt;/Td&gt; &lt;Td&gt; Deepa Mehta &lt;/Td&gt; &lt;Td&gt; Water &lt;/Td&gt; &lt;Td&gt; Best Foreign Language Film &lt;/Td&gt; &lt;Td&gt; Nominated &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 2009 ( 81st ) &lt;/Td&gt; &lt;Td&gt; Resul Pookutty &lt;/Td&gt; &lt;Td&gt; Slumdog Millionaire &lt;/Td&gt; &lt;Td&gt; Best Sound Mixing &lt;/Td&gt; &lt;Td&gt; Won &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; A.R. Rahman &lt;/Td&gt; &lt;Td&gt; Best Original Score &lt;/Td&gt; &lt;Td&gt; Won &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; A.R. Rahman and Gulzar &lt;/Td&gt; &lt;Td&gt; Best Original Song &lt;/Td&gt; &lt;Td&gt; Won &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 2011 ( 83rd ) &lt;/Td&gt; &lt;Td&gt; A.R. Rahman &lt;/Td&gt; &lt;Td&gt; 127 Hours &lt;/Td&gt; &lt;Td&gt; Best Original Score &lt;/Td&gt; &lt;Td&gt; Nominated &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; A.R. Rahman &lt;/Td&gt; &lt;Td&gt; Best Original Song &lt;/Td&gt; &lt;Td&gt; Nominated &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 2013 ( 85th ) &lt;/Td&gt; &lt;Td&gt; Bombay Jayashri &lt;/Td&gt; &lt;Td&gt; Life of Pi &lt;/Td&gt; &lt;Td&gt; Best Original Song &lt;/Td&gt; &lt;Td&gt; Nominated &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 2016 &lt;/Td&gt; &lt;Td&gt; Rahul Thakkar &lt;/Td&gt; &lt;Td&gt; n / a &lt;/Td&gt; &lt;Td&gt; Sci - Tech Award &lt;/Td&gt; &lt;Td&gt; Received &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 2016 &lt;/Td&gt; &lt;Td&gt; Cottalango Leon &lt;/Td&gt; &lt;Td&gt; n / a &lt;/Td&gt; &lt;Td&gt; Sci - Tech Award &lt;/Td&gt; &lt;Td&gt; Received &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 2018 &lt;/Td&gt; &lt;Td&gt; Vikas Sathaye &lt;/Td&gt; &lt;Td&gt; n / a &lt;/Td&gt; &lt;Td&gt; Sci - Tech Award &lt;/Td&gt; &lt;Td&gt; Received &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;/Tr&gt; &lt;/Table&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The 2017 Nobel Peace Prize was awarded to the International Campaign to Abolish Nuclear Weapons ( ICAN ) `` for its work to draw attention to the catastrophic humanitarian consequences of any use of nuclear weapons and for its ground - breaking efforts to achieve a treaty - based prohibition on such weapons , &#x27;&#x27; according to the Norwegian Nobel Committee announcement on October 6 , 2017 . The award announcement acknowledged the fact that `` the world &#x27;s nine nuclear - armed powers and their allies &#x27;&#x27; neither signed nor supported the treaty - based prohibition known as the Treaty on the Prohibition of Nuclear Weapons or nuclear ban treaty , yet in an interview Committee Chair Berit Reiss - Andersen told reporters that the award was intended to give `` encouragement to all players in the field &#x27;&#x27; to disarm . The award was hailed by civil society as well as governmental and intergovernmental representatives who support the nuclear ban treaty , but drew criticism from those opposed . At the Nobel Peace Prize award ceremony held in Oslo City Hall on December 10 , 2017 , Setsuko Thurlow , an 85 - year - old survivor of the 1945 atomic bombing of Hiroshima , and ICAN Executive Director Beatrice Fihn jointly received a medal and diploma of the award on behalf of ICAN and delivered the Nobel lecture . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; Career records for batting average are usually subject to a minimum qualification of 20 innings played or completed , in order to exclude batsmen who have not played enough games for their skill to be reliably assessed . Under this qualification , the highest Test batting average belongs to Australia &#x27;s Sir Donald Bradman , with 99.94 . Given that a career batting average over 50 is exceptional , and that only five other players have averages over 60 , this is an outstanding statistic . The fact that Bradman &#x27;s average is so far above that of any other cricketer has led several statisticians to argue that , statistically at least , he was the greatest athlete in any sport . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;Table&gt; &lt;Tr&gt; &lt;Th colspan=&quot;4&quot;&gt; Indian cricket team in South Africa in 2017 -- 18 &lt;/Th&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; &lt;/Th&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; &lt;/Th&gt; &lt;Td&gt; South Africa &lt;/Td&gt; &lt;Td&gt; India &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Dates &lt;/Th&gt; &lt;Td colspan=&quot;3&quot;&gt; 5 January 2018 -- 24 February 2018 &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Captains &lt;/Th&gt; &lt;Td&gt; Faf du Plessis ( Tests and ODIs ) JP Duminy ( T20Is ) &lt;/Td&gt; &lt;Td&gt; Virat Kohli &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th colspan=&quot;4&quot;&gt; Test series &lt;/Th&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Result &lt;/Th&gt; &lt;Td colspan=&quot;3&quot;&gt; South Africa won the 3 - match series 2 -- 1 &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Most runs &lt;/Th&gt; &lt;Td&gt; AB de Villiers ( 211 ) &lt;/Td&gt; &lt;Td&gt; Virat Kohli ( 286 ) &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Most wickets &lt;/Th&gt; &lt;Td&gt; Vernon Philander ( 15 ) Kagiso Rabada ( 15 ) &lt;/Td&gt; &lt;Td&gt; Mohammed Shami ( 15 ) &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Player of the series &lt;/Th&gt; &lt;Td colspan=&quot;3&quot;&gt; Vernon Philander ( SA ) &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th colspan=&quot;4&quot;&gt; One Day International series &lt;/Th&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Results &lt;/Th&gt; &lt;Td colspan=&quot;3&quot;&gt; India won the 6 - match series 5 -- 1 &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Most runs &lt;/Th&gt; &lt;Td&gt; Hashim Amla ( 154 ) &lt;/Td&gt; &lt;Td&gt; Virat Kohli ( 558 ) &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Most wickets &lt;/Th&gt; &lt;Td&gt; Lungi Ngidi ( 8 ) &lt;/Td&gt; &lt;Td&gt; Kuldeep Yadav ( 17 ) &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Player of the series &lt;/Th&gt; &lt;Td colspan=&quot;3&quot;&gt; Virat Kohli ( Ind ) &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th colspan=&quot;4&quot;&gt; Twenty20 International series &lt;/Th&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Results &lt;/Th&gt; &lt;Td colspan=&quot;3&quot;&gt; India won the 3 - match series 2 -- 1 &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Most runs &lt;/Th&gt; &lt;Td&gt; JP Duminy ( 122 ) &lt;/Td&gt; &lt;Td&gt; Shikhar Dhawan ( 143 ) &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Most wickets &lt;/Th&gt; &lt;Td&gt; Junior Dala ( 7 ) &lt;/Td&gt; &lt;Td&gt; Bhuvneshwar Kumar ( 7 ) &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Player of the series &lt;/Th&gt; &lt;Td colspan=&quot;3&quot;&gt; Bhuvneshwar Kumar ( Ind ) &lt;/Td&gt; &lt;/Tr&gt; &lt;/Table&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; Brian Lara took the least number of innings ( 195 ) to reach the 10,000 run mark , later equalled by Sachin Tendulkar and Kumar Sangakkara , while Australia &#x27;s Steve Waugh took 244 innings to achieve the feat . Alastair Cook is the fastest in terms of time span , taking 10 years and 87 days . The time taken by Shivnarine Chanderpaul ( 18 years and 37 days ) is the slowest among all . As of May 2017 , Tendulkar leads the list with 15,921 runs followed by Ricky Ponting of Australia with 13,378 . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; 50 + &lt;/Th&gt; &lt;Th&gt; Player &lt;/Th&gt; &lt;Th&gt; Matches &lt;/Th&gt; &lt;Th&gt; Innings &lt;/Th&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; 119 &lt;/Th&gt; &lt;Td&gt; Sachin Tendulkar &lt;/Td&gt; &lt;Td&gt; 200 &lt;/Td&gt; &lt;Td&gt; 329 &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; 103 &lt;/Th&gt; &lt;Td&gt; Jacques Kallis &lt;/Td&gt; &lt;Td&gt; 166 &lt;/Td&gt; &lt;Td&gt; 280 &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; 103 &lt;/Th&gt; &lt;Td&gt; Ricky Ponting &lt;/Td&gt; &lt;Td&gt; 168 &lt;/Td&gt; &lt;Td&gt; 287 &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; 99 &lt;/Th&gt; &lt;Td&gt; Rahul Dravid &lt;/Td&gt; &lt;Td&gt; 164 &lt;/Td&gt; &lt;Td&gt; 286 &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; 96 &lt;/Th&gt; &lt;Td&gt; Shivnarine Chanderpaul &lt;/Td&gt; &lt;Td&gt; 164 &lt;/Td&gt; &lt;Td&gt; 280 &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td colspan=&quot;4&quot;&gt; &lt;P&gt; Last updated : 15 June 2016 &lt;/P&gt; &lt;/Td&gt; &lt;/Tr&gt; &lt;/Table&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; Chandan Shetty emerged as the winner of this season on 28. January. 2018 with Karthik being the runner up . Other finalists Niveditha , Diwakar , Shruti were eliminated &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; Arthur Chung ( January 10 , 1918 -- June 23 , 2008 ) was the first President of Guyana from 1970 to 1980 . During his time as President of Guyana , the office was that of a ceremonial head of state , with real power in the hands of Prime Minister Forbes Burnham . He was honoured with Guyana &#x27;s highest national honour , the Order of Excellence ( O.E. ) . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;Tr&gt; &lt;Td colspan=&quot;2&quot;&gt; Incumbent Achal Kumar Jyoti since 6 July 2017 &lt;/Td&gt; &lt;/Tr&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">UPDATE CONTEXT. The current context does not provide information related to the question.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Updating context and resetting conversation.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_1122 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_2398 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_309 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_3891 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_2087 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_330 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_4844 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You&#x27;re a retrieve augmented chatbot. You answer user&#x27;s questions based on your own knowledge and the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">context provided by the user.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">If you can&#x27;t answer the question with or without the current context, you should reply exactly `UPDATE CONTEXT`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You must give as short an answer as possible.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">User&#x27;s question is: has been honoured with the wisden leading cricketer in the world award for 2016</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context is: &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; No &lt;/Th&gt; &lt;Th&gt; Name ( birth -- death ) &lt;/Th&gt; &lt;Th&gt; Portrait &lt;/Th&gt; &lt;Th&gt; Elected ( % votes ) &lt;/Th&gt; &lt;Th&gt; Took office &lt;/Th&gt; &lt;Th&gt; Left office &lt;/Th&gt; &lt;Th&gt; Term ( in years ) &lt;/Th&gt; &lt;Th&gt; Notes &lt;/Th&gt; &lt;Th&gt; President ( s ) &lt;/Th&gt; &lt;Th colspan=&quot;2&quot;&gt; Candidate of &lt;/Th&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; &lt;/Th&gt; &lt;Td&gt; Sarvepalli Radhakrishnan ( 1888 -- 1975 ) &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; 1952 ( Unopposed ) &lt;P&gt; 1957 ( Unopposed ) &lt;/P&gt; &lt;/Td&gt; &lt;Td&gt; 13 May 1952 &lt;/Td&gt; &lt;Td&gt; 12 May 1962 &lt;/Td&gt; &lt;Td&gt; 10 &lt;/Td&gt; &lt;Td&gt; Radhakrishnan was a prominent scholar . Besides being awarded the Bharat Ratna he also held the position of vice-chancellor in the Banaras Hindu University and the Andhra college . He served as the Vice-President for two terms . &lt;/Td&gt; &lt;Td&gt; Rajendra Prasad &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Independent &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; &lt;/Th&gt; &lt;Td&gt; Zakir Husain ( 1897 -- 1969 ) &lt;/Td&gt; &lt;Td&gt; -- &lt;/Td&gt; &lt;Td&gt; 1962 ( 97.59 ) &lt;/Td&gt; &lt;Td&gt; 13 May 1962 &lt;/Td&gt; &lt;Td&gt; 12 May 1967 &lt;/Td&gt; &lt;Td&gt; 5 &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Sarvepalli Radhakrishnan &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Independent &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; &lt;/Th&gt; &lt;Td&gt; Varahagiri Venkata Giri ( 1894 -- 1980 ) &lt;/Td&gt; &lt;Td&gt; -- &lt;/Td&gt; &lt;Td&gt; 1967 ( 71.45 ) &lt;/Td&gt; &lt;Td&gt; 13 May 1967 &lt;/Td&gt; &lt;Td&gt; 3 May 1969 &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Zakir Husain &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Independent &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; &lt;/Th&gt; &lt;Td&gt; Gopal Swarup Pathak ( 1896 -- 1982 ) &lt;/Td&gt; &lt;Td&gt; -- &lt;/Td&gt; &lt;Td&gt; 1969 -- &lt;/Td&gt; &lt;Td&gt; 31 August 1969 &lt;/Td&gt; &lt;Td&gt; 30 August 1974 &lt;/Td&gt; &lt;Td&gt; 5 &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Varahagiri Venkata Giri ( 1969 -- 1974 ) &lt;P&gt; Fakhruddin Ali Ahmed ( 1974 ) &lt;/P&gt; &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Independent &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; 5 &lt;/Th&gt; &lt;Td&gt; Basappa Danappa Jatti ( 1912 -- 2002 ) &lt;/Td&gt; &lt;Td&gt; -- &lt;/Td&gt; &lt;Td&gt; ( 78.70 ) &lt;/Td&gt; &lt;Td&gt; 31 August 1974 &lt;/Td&gt; &lt;Td&gt; 30 August 1979 &lt;/Td&gt; &lt;Td&gt; 5 &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Fakhruddin Ali Ahmed ( 1974 -- 1977 ) Neelam Sanjiva Reddy ( 1977 -- 1979 ) &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Indian National Congress &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; 6 &lt;/Th&gt; &lt;Td&gt; Mohammad Hidayatullah ( 1905 -- 1992 ) &lt;/Td&gt; &lt;Td&gt; -- &lt;/Td&gt; &lt;Td&gt; 1979 ( Unopposed ) &lt;/Td&gt; &lt;Td&gt; 31 August 1979 &lt;/Td&gt; &lt;Td&gt; 30 August 1984 &lt;/Td&gt; &lt;Td&gt; 5 &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Neelam Sanjiva Reddy ( 1979 -- 1982 ) Giani Zail Singh ( 1982 -- 1984 ) &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Independent &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; 7 &lt;/Th&gt; &lt;Td&gt; Ramaswamy Venkataraman ( 1910 -- 2009 ) &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; 1984 ( 71.05 ) &lt;/Td&gt; &lt;Td&gt; 31 August 1984 &lt;/Td&gt; &lt;Td&gt; 24 July 1987 &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Giani Zail Singh &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Indian National Congress &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; 8 &lt;/Th&gt; &lt;Td&gt; Shankar Dayal Sharma ( 1918 -- 1999 ) &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; ( Unopposed ) &lt;/Td&gt; &lt;Td&gt; 3 September 1987 &lt;/Td&gt; &lt;Td&gt; 24 July 1992 &lt;/Td&gt; &lt;Td&gt; 5 &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Ramaswamy Venkataraman &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Indian National Congress &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; 9 &lt;/Th&gt; &lt;Td&gt; Kocheril Raman Narayanan ( 1920 -- 2005 ) &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; 1992 ( 99.86 ) &lt;/Td&gt; &lt;Td&gt; 21 August 1992 &lt;/Td&gt; &lt;Td&gt; 24 July 1997 &lt;/Td&gt; &lt;Td&gt; 5 &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Shankar Dayal Sharma &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Indian National Congress &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; 10 &lt;/Th&gt; &lt;Td&gt; Krishan Kant ( 1927 -- 2002 ) &lt;/Td&gt; &lt;Td&gt; -- &lt;/Td&gt; &lt;Td&gt; 1997 ( 61.76 ) &lt;/Td&gt; &lt;Td&gt; 21 August 1997 &lt;/Td&gt; &lt;Td&gt; 27 July 2002 &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Kocheril Raman Narayanan ( 1997 -- 2002 ) A.P.J. Abdul Kalam ( 2002 ) &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Janata Dal &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; 11 &lt;/Th&gt; &lt;Td&gt; Bhairon Singh Shekhawat ( 1923 -- 2010 ) &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; 2002 ( 59.82 ) &lt;/Td&gt; &lt;Td&gt; 19 August 2002 &lt;/Td&gt; &lt;Td&gt; 21 July 2007 &lt;/Td&gt; &lt;Td&gt; 5 &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; A.P.J. Abdul Kalam &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Bharatiya Janata Party &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; 12 &lt;/Th&gt; &lt;Td&gt; Mohammad Hamid Ansari ( 1937 -- ) &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; 2007 ( 60.51 ) 2012 ( 67.31 ) &lt;/Td&gt; &lt;Td&gt; 11 August 2007 &lt;/Td&gt; &lt;Td&gt; 11 August 2017 &lt;/Td&gt; &lt;Td&gt; 10 &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Pratibha Patil ( 2007 -- 2012 ) Pranab Mukherjee ( 2012 -- 2017 ) Ram Nath Kovind ( 2017 ) &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Indian National Congress &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; 13 &lt;/Th&gt; &lt;Td&gt; Muppavarapu Venkaiah Naidu ( 1949 -- ) &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; 2017 ( 67.89 ) &lt;/Td&gt; &lt;Td&gt; 11 August 2017 &lt;/Td&gt; &lt;Td&gt; Incumbent &lt;/Td&gt; &lt;Td&gt; -- &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Ram Nath Kovind &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Bharatiya Janata Party &lt;/Td&gt; &lt;/Tr&gt; &lt;/Table&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;Table&gt; &lt;Tr&gt; &lt;Th colspan=&quot;2&quot;&gt; Governor of Maharashtra &lt;/Th&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td colspan=&quot;2&quot;&gt; Incumbent Chennamaneni Vidyasagar Rao since 30 August 2014 &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Style &lt;/Th&gt; &lt;Td&gt; His Excellency &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Residence &lt;/Th&gt; &lt;Td&gt; Main : Raj Bhavan ( Mumbai ) Additional : Raj Bhavan ( Nagpur ) ; Raj Bhavan ( Pune ) &amp; Raj Bhavan ( Mahabaleshwar ) &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Appointer &lt;/Th&gt; &lt;Td&gt; President of India &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Term length &lt;/Th&gt; &lt;Td&gt; Five Years &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Inaugural holder &lt;/Th&gt; &lt;Td&gt; John Colville , PC , GCIE &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Th&gt; Formation &lt;/Th&gt; &lt;Td&gt; 15 August 1947 ; 70 years ago ( 1947 - 08 - 15 ) &lt;/Td&gt; &lt;/Tr&gt; &lt;/Table&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; Every player who has won this award and has been eligible for the Naismith Memorial Basketball Hall of Fame has been inducted . Kareem Abdul - Jabbar won the award a record six times . Both Bill Russell and Michael Jordan won the award five times , while Wilt Chamberlain and LeBron James won the award four times . Russell and James are the only players to have won the award four times in five seasons . Moses Malone , Larry Bird and Magic Johnson each won the award three times , while Bob Pettit , Karl Malone , Tim Duncan , Steve Nash and Stephen Curry have each won it twice . Only two rookies have won the award : Wilt Chamberlain in the 1959 -- 60 season and Wes Unseld in the 1968 -- 69 season . Hakeem Olajuwon of Nigeria , Tim Duncan of the U.S. Virgin Islands , Steve Nash of Canada and Dirk Nowitzki of Germany are the only MVP winners considered `` international players &#x27;&#x27; by the NBA . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The Jawaharlal Nehru Centre for Advanced Scientific Research ( JNCASR ) is a multidisciplinary research institute located at Jakkur , Bangalore , India . It was established by the Department of Science and Technology of the Government of India , to mark the birth centenary of Pandit Jawaharlal Nehru . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; Ajay Tyagi was appointed chairman on 10 January 2017 replacing UK Sinha . And took charge of chairman office on 1 March 2017 . The Board comprises &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; Year &lt;/Th&gt; &lt;Th&gt; Player &lt;/Th&gt; &lt;Th&gt; Country &lt;/Th&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 2003 &lt;/Td&gt; &lt;Th&gt; Ponting , Ricky Ricky Ponting &lt;/Th&gt; &lt;Td&gt; Australia &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Th&gt; Warne , Shane Shane Warne &lt;/Th&gt; &lt;Td&gt; Australia &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 2005 &lt;/Td&gt; &lt;Th&gt; Flintoff , Andrew Andrew Flintoff &lt;/Th&gt; &lt;Td&gt; England &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 2006 &lt;/Td&gt; &lt;Th&gt; Muralitharan , Muttiah Muttiah Muralitharan &lt;/Th&gt; &lt;Td&gt; Sri Lanka &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 2007 &lt;/Td&gt; &lt;Th&gt; Kallis , Jacques Jacques Kallis &lt;/Th&gt; &lt;Td&gt; South Africa &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 2008 &lt;/Td&gt; &lt;Th&gt; Sehwag , Virender Virender Sehwag &lt;/Th&gt; &lt;Td&gt; India &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 2009 &lt;/Td&gt; &lt;Th&gt; Sehwag , Virender Virender Sehwag &lt;/Th&gt; &lt;Td&gt; India &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Th&gt; Tendulkar , Sachin Sachin Tendulkar &lt;/Th&gt; &lt;Td&gt; India &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 2011 &lt;/Td&gt; &lt;Th&gt; Sangakkara , Kumar Kumar Sangakkara &lt;/Th&gt; &lt;Td&gt; Sri Lanka &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 2012 &lt;/Td&gt; &lt;Th&gt; Clarke , Michael Michael Clarke &lt;/Th&gt; &lt;Td&gt; Australia &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 2013 &lt;/Td&gt; &lt;Th&gt; Steyn , Dale Dale Steyn &lt;/Th&gt; &lt;Td&gt; South Africa &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 2014 &lt;/Td&gt; &lt;Th&gt; Sangakkara , Kumar Kumar Sangakkara &lt;/Th&gt; &lt;Td&gt; Sri Lanka &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 2015 &lt;/Td&gt; &lt;Th&gt; Williamson , Kane Kane Williamson &lt;/Th&gt; &lt;Td&gt; New Zealand &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 2016 &lt;/Td&gt; &lt;Th&gt; Kohli , Virat Virat Kohli &lt;/Th&gt; &lt;Td&gt; India &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 2017 &lt;/Td&gt; &lt;Th&gt; Kohli , Virat Virat Kohli &lt;/Th&gt; &lt;Td&gt; India &lt;/Td&gt; &lt;/Tr&gt; &lt;/Table&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; Mankombu Sambasivan Swaminathan ( born 7 August 1925 ) is an Indian geneticist and international administrator , renowned for his leading role in India &#x27;s Green Revolution a program under which high - yield varieties of wheat and rice seedlings were planted in the fields of poor farmers . Swaminathan is known as `` Indian Father of Green Revolution &#x27;&#x27; for his leadership and success in introducing and further developing high - yielding varieties of wheat in India . He is the founder and chairman of the MS Swaminathan Research Foundation . His stated vision is to rid the world of hunger and poverty . Swaminathan is an advocate of moving India to sustainable development , especially using environmentally sustainable agriculture , sustainable food security and the preservation of biodiversity , which he calls an `` evergreen revolution . &#x27;&#x27; &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">I&#x27;m sorry, the provided context doesn&#x27;t contain information about any cricketer being honored with the Wisden Leading Cricketer in the World award for 2016. UPDATE CONTEXT if you have any other query.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;  Below are outputs of Case 5  &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">doc_ids:  [[&#x27;doc_20&#x27;, &#x27;doc_2943&#x27;, &#x27;doc_2059&#x27;, &#x27;doc_3293&#x27;, &#x27;doc_4056&#x27;, &#x27;doc_1914&#x27;, &#x27;doc_2749&#x27;, &#x27;doc_1796&#x27;, &#x27;doc_3468&#x27;, &#x27;doc_1793&#x27;, &#x27;doc_876&#x27;, &#x27;doc_2577&#x27;, &#x27;doc_27&#x27;, &#x27;doc_366&#x27;, &#x27;doc_321&#x27;, &#x27;doc_3103&#x27;, &#x27;doc_715&#x27;, &#x27;doc_3534&#x27;, &#x27;doc_142&#x27;, &#x27;doc_5337&#x27;, &#x27;doc_2426&#x27;, &#x27;doc_5346&#x27;, &#x27;doc_3021&#x27;, &#x27;doc_1596&#x27;, &#x27;doc_316&#x27;, &#x27;doc_1103&#x27;, &#x27;doc_1602&#x27;, &#x27;doc_1677&#x27;, &#x27;doc_1670&#x27;, &#x27;doc_2853&#x27;]]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_20 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_2943 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_2059 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_3293 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_4056 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_1914 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_2749 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_1796 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_3468 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_1793 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_876 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_2577 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_27 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You&#x27;re a retrieve augmented chatbot. You answer user&#x27;s questions based on your own knowledge and the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">context provided by the user.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">If you can&#x27;t answer the question with or without the current context, you should reply exactly `UPDATE CONTEXT`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You must give as short an answer as possible.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">User&#x27;s question is: who carried the usa flag in opening ceremony</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context is: &lt;P&gt; On January 17 , 1899 , under orders from President William McKinley , Commander Edward D. Taussig of USS Bennington landed on Wake and formally took possession of the island for the United States . After a 21 - gun salute , the flag was raised and a brass plate was affixed to the flagstaff with the following inscription : &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;Li&gt; 1960 Flag with 50 stars ( Hawaii ) &lt;/Li&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The flag of the United States of America , often referred to as the American flag , is the national flag of the United States . It consists of thirteen equal horizontal stripes of red ( top and bottom ) alternating with white , with a blue rectangle in the canton ( referred to specifically as the `` union &#x27;&#x27; ) bearing fifty small , white , five - pointed stars arranged in nine offset horizontal rows , where rows of six stars ( top and bottom ) alternate with rows of five stars . The 50 stars on the flag represent the 50 states of the United States of America , and the 13 stripes represent the thirteen British colonies that declared independence from the Kingdom of Great Britain , and became the first states in the U.S. Nicknames for the flag include The Stars and Stripes , Old Glory , and The Star - Spangled Banner . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The Pledge of Allegiance of the United States is an expression of allegiance to the Flag of the United States and the republic of the United States of America . It was originally composed by Captain George Thatcher Balch , a Union Army Officer during the Civil War and later a teacher of patriotism in New York City schools . The form of the pledge used today was largely devised by Francis Bellamy in 1892 , and formally adopted by Congress as the pledge in 1942 . The official name of The Pledge of Allegiance was adopted in 1945 . The most recent alteration of its wording came on Flag Day in 1954 , when the words `` under God &#x27;&#x27; were added . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; In modern times , the U.S. military plays ( or sounds ) `` Reveille &#x27;&#x27; in the morning , generally near sunrise , though its exact time varies from base to base . On U.S. Army posts and Air Force bases , `` Reveille &#x27;&#x27; is played by itself or followed by the bugle call `` To the Colors &#x27;&#x27; at which time the national flag is raised and all U.S. military personnel outdoors are required to come to attention and present a salute in uniform , either to the flag or in the direction of the music if the flag is not visible . While in formation , soldiers are brought to the position of parade rest while `` Reveille &#x27;&#x27; plays then called to attention and present arms as the national flag is raised . On board U.S. Navy , Marine Corps , and Coast Guard facilities , the flag is generally raised at 0800 ( 8 am ) while `` The Star Spangled Banner &#x27;&#x27; or the bugle call `` To the Colors &#x27;&#x27; is played . On some U.S. military bases , `` Reveille &#x27;&#x27; is accompanied by a cannon shot . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; When the National Anthem was first recognized by law in 1932 , there was no prescription as to behavior during its playing . On June 22 , 1942 , the law was revised indicating that those in uniform should salute during its playing , while others should simply stand at attention , men removing their hats . ( The same code also required that women should place their hands over their hearts when the flag is displayed during the playing of the Anthem , but not if the flag was not present . ) On December 23 , 1942 the law was again revised instructing men and women to stand at attention and face in the direction of the music when it was played . That revision also directed men and women to place their hands over their hearts only if the flag was displayed . Those in uniform were required to salute . On July 7 , 1976 , the law was simplified . Men and women were instructed to stand with their hands over their hearts , men removing their hats , irrespective of whether or not the flag was displayed and those in uniform saluting . On August 12 , 1998 , the law was rewritten keeping the same instructions , but differentiating between `` those in uniform &#x27;&#x27; and `` members of the Armed Forces and veterans &#x27;&#x27; who were both instructed to salute during the playing whether or not the flag was displayed . Because of the changes in law over the years and confusion between instructions for the Pledge of Allegence versus the National Anthem , throughout most of the 20th century many people simply stood at attention or with their hands folded in front of them during the playing of the Anthem , and when reciting the Pledge they would hold their hand ( or hat ) over their heart . After 9 / 11 , the custom of placing the hand over the heart during the playing of the Anthem became nearly universal . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; A flag designed by John McConnell in 1969 for the first Earth Day is a dark blue field charged with The Blue Marble , a famous NASA photo of the Earth as seen from outer space . The first edition of McConnell &#x27;s flag used screen - printing and used different colors : ocean and land were blue and the clouds were white . McConnell presented his flag to the United Nations as a symbol for consideration . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The torch - bearing arm was displayed at the Centennial Exposition in Philadelphia in 1876 , and in Madison Square Park in Manhattan from 1876 to 1882 . Fundraising proved difficult , especially for the Americans , and by 1885 work on the pedestal was threatened by lack of funds . Publisher Joseph Pulitzer , of the New York World , started a drive for donations to finish the project and attracted more than 120,000 contributors , most of whom gave less than a dollar . The statue was built in France , shipped overseas in crates , and assembled on the completed pedestal on what was then called Bedloe &#x27;s Island . The statue &#x27;s completion was marked by New York &#x27;s first ticker - tape parade and a dedication ceremony presided over by President Grover Cleveland . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The horizontal stripes on the flag represent the nine original departments of Uruguay , based on the U.S flag , where the stripes represent the original 13 colonies . The first flag designed in 1828 had 9 light blue stripes ; this number was reduced to 4 in 1830 due to visibility problems from distance . The Sun of May represents the May Revolution of 1810 ; according to the historian Diego Abad de Santillán , the Sun of May is a figurative sun that represents Inti , the sun god of the Inca religion . It also appears in the Flag of Argentina and the Coat of Arms of Bolivia . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The anthem has been recorded and performed in many different languages , usually as a result of the hosting of either form of the Games in various countries . The IOC does n&#x27;t require that the anthem be performed in either English or Greek . But in the 2008 Olympic opening and closing ceremonies in Beijing , China , Greek was sung instead of the host country &#x27;s official language , Mandarin . Also in the 2016 Olympic opening ceremonies in Rio de Janeiro , Brazil , English was also sung instead of host country &#x27;s official language , Portuguese . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; The United States Oath of Allegiance , officially referred to as the `` Oath of Allegiance , &#x27;&#x27; 8 C.F.R. Part 337 ( 2008 ) , is an allegiance oath that must be taken by all immigrants who wish to become United States citizens . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; During the first half of the 19th century , seven stars were added to the flag to represent the seven signatories to the Venezuelan declaration of independence , being the provinces of Caracas , Cumaná , Barcelona , Barinas , Margarita , Mérida , and Trujillo . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">&lt;P&gt; With the annexation of Hawaii in 1898 and the seizure of Guam and the Philippines during the Spanish -- American War that same year , the United States began to consider unclaimed and uninhabited Wake Island , located approximately halfway between Honolulu and Manila , as a good location for a telegraph cable station and coaling station for refueling warships of the rapidly expanding United States Navy and passing merchant and passenger steamships . On July 4 , 1898 , United States Army Brigadier General Francis V. Greene of the 2nd Brigade , Philippine Expeditionary Force , of the Eighth Army Corps , stopped at Wake Island and raised the American flag while en route to the Philippines on the steamship liner SS China . &lt;/P&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">I don&#x27;t have the answer with the provided context. UPDATE CONTEXT.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Updating context and resetting conversation.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_366 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You&#x27;re a retrieve augmented chatbot. You answer user&#x27;s questions based on your own knowledge and the</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">context provided by the user.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">If you can&#x27;t answer the question with or without the current context, you should reply exactly `UPDATE CONTEXT`.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You must give as short an answer as possible.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">User&#x27;s question is: who carried the usa flag in opening ceremony</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context is: &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; # &lt;/Th&gt; &lt;Th&gt; Event year &lt;/Th&gt; &lt;Th&gt; Season &lt;/Th&gt; &lt;Th&gt; Ceremony &lt;/Th&gt; &lt;Th&gt; Flag bearer &lt;/Th&gt; &lt;Th&gt; Sex &lt;/Th&gt; &lt;Th&gt; State / Country &lt;/Th&gt; &lt;Th&gt; Sport &lt;/Th&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 62 &lt;/Td&gt; &lt;Td&gt; 2018 &lt;/Td&gt; &lt;Td&gt; Winter &lt;/Td&gt; &lt;Td&gt; Closing &lt;/Td&gt; &lt;Td&gt; Diggins , Jessica Jessica Diggins &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Minnesota &lt;/Td&gt; &lt;Td&gt; Cross-country skiing &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 61 &lt;/Td&gt; &lt;Td&gt; 2018 &lt;/Td&gt; &lt;Td&gt; Winter &lt;/Td&gt; &lt;Td&gt; Opening &lt;/Td&gt; &lt;Td&gt; Hamlin , Erin Erin Hamlin &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; New York &lt;/Td&gt; &lt;Td&gt; Luge &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 60 &lt;/Td&gt; &lt;Td&gt; 2016 &lt;/Td&gt; &lt;Td&gt; Summer &lt;/Td&gt; &lt;Td&gt; Closing &lt;/Td&gt; &lt;Td&gt; Biles , Simone Simone Biles &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Texas &lt;/Td&gt; &lt;Td&gt; Gymnastics &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 59 &lt;/Td&gt; &lt;Td&gt; 2016 &lt;/Td&gt; &lt;Td&gt; Summer &lt;/Td&gt; &lt;Td&gt; Opening &lt;/Td&gt; &lt;Td&gt; Phelps , Michael Michael Phelps &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Maryland &lt;/Td&gt; &lt;Td&gt; Swimming &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 58 &lt;/Td&gt; &lt;Td&gt; 2014 &lt;/Td&gt; &lt;Td&gt; Winter &lt;/Td&gt; &lt;Td&gt; Closing &lt;/Td&gt; &lt;Td&gt; Chu , Julie Julie Chu &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Connecticut &lt;/Td&gt; &lt;Td&gt; Hockey &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 57 &lt;/Td&gt; &lt;Td&gt; 2014 &lt;/Td&gt; &lt;Td&gt; Winter &lt;/Td&gt; &lt;Td&gt; Opening &lt;/Td&gt; &lt;Td&gt; Lodwick , Todd Todd Lodwick &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Colorado &lt;/Td&gt; &lt;Td&gt; Nordic combined &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 56 &lt;/Td&gt; &lt;Td&gt; 2012 &lt;/Td&gt; &lt;Td&gt; Summer &lt;/Td&gt; &lt;Td&gt; Closing &lt;/Td&gt; &lt;Td&gt; Nellum , Bryshon Bryshon Nellum &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; California &lt;/Td&gt; &lt;Td&gt; Athletics &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 55 &lt;/Td&gt; &lt;Td&gt; 2012 &lt;/Td&gt; &lt;Td&gt; Summer &lt;/Td&gt; &lt;Td&gt; Opening &lt;/Td&gt; &lt;Td&gt; Zagunis , Mariel Mariel Zagunis &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Oregon &lt;/Td&gt; &lt;Td&gt; Fencing &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 54 &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Winter &lt;/Td&gt; &lt;Td&gt; Closing &lt;/Td&gt; &lt;Td&gt; Demong , Bill Bill Demong &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; New York &lt;/Td&gt; &lt;Td&gt; Nordic combined &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 53 &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Winter &lt;/Td&gt; &lt;Td&gt; Opening &lt;/Td&gt; &lt;Td&gt; Grimmette , Mark Mark Grimmette &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Michigan &lt;/Td&gt; &lt;Td&gt; Luge &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 52 &lt;/Td&gt; &lt;Td&gt; 2008 &lt;/Td&gt; &lt;Td&gt; Summer &lt;/Td&gt; &lt;Td&gt; Closing &lt;/Td&gt; &lt;Td&gt; Lorig , Khatuna Khatuna Lorig &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Georgia ( country ) &lt;/Td&gt; &lt;Td&gt; Archery &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 51 &lt;/Td&gt; &lt;Td&gt; 2008 &lt;/Td&gt; &lt;Td&gt; Summer &lt;/Td&gt; &lt;Td&gt; Opening &lt;/Td&gt; &lt;Td&gt; Lomong , Lopez Lopez Lomong &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Sudan ( now South Sudan ) &lt;/Td&gt; &lt;Td&gt; Athletics &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 50 &lt;/Td&gt; &lt;Td&gt; 2006 &lt;/Td&gt; &lt;Td&gt; Winter &lt;/Td&gt; &lt;Td&gt; Closing &lt;/Td&gt; &lt;Td&gt; Cheek , Joey Joey Cheek &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; North Carolina &lt;/Td&gt; &lt;Td&gt; Speed skating &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 49 &lt;/Td&gt; &lt;Td&gt; 2006 &lt;/Td&gt; &lt;Td&gt; Winter &lt;/Td&gt; &lt;Td&gt; Opening &lt;/Td&gt; &lt;Td&gt; Witty , Chris Chris Witty &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Wisconsin &lt;/Td&gt; &lt;Td&gt; Speed skating &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 48 &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Summer &lt;/Td&gt; &lt;Td&gt; Closing &lt;/Td&gt; &lt;Td&gt; Hamm , Mia Mia Hamm &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Texas &lt;/Td&gt; &lt;Td&gt; Women &#x27;s soccer &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 47 &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Summer &lt;/Td&gt; &lt;Td&gt; Opening &lt;/Td&gt; &lt;Td&gt; Staley , Dawn Dawn Staley &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Pennsylvania &lt;/Td&gt; &lt;Td&gt; Basketball &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 46 &lt;/Td&gt; &lt;Td&gt; 2002 &lt;/Td&gt; &lt;Td&gt; Winter &lt;/Td&gt; &lt;Td&gt; Closing &lt;/Td&gt; &lt;Td&gt; Shimer , Brian Brian Shimer &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Florida &lt;/Td&gt; &lt;Td&gt; Bobsleigh &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 45 &lt;/Td&gt; &lt;Td&gt; 2002 &lt;/Td&gt; &lt;Td&gt; Winter &lt;/Td&gt; &lt;Td&gt; Opening &lt;/Td&gt; &lt;Td&gt; Peterson , Amy Amy Peterson &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Minnesota &lt;/Td&gt; &lt;Td&gt; Short track speed skating &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 44 &lt;/Td&gt; &lt;Td&gt; 2000 &lt;/Td&gt; &lt;Td&gt; Summer &lt;/Td&gt; &lt;Td&gt; Closing &lt;/Td&gt; &lt;Td&gt; Gardner , Rulon Rulon Gardner &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Wyoming &lt;/Td&gt; &lt;Td&gt; Wrestling &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 43 &lt;/Td&gt; &lt;Td&gt; 2000 &lt;/Td&gt; &lt;Td&gt; Summer &lt;/Td&gt; &lt;Td&gt; Opening &lt;/Td&gt; &lt;Td&gt; Meidl , Cliff Cliff Meidl &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; California &lt;/Td&gt; &lt;Td&gt; Canoeing &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 42 &lt;/Td&gt; &lt;Td&gt; 1998 &lt;/Td&gt; &lt;Td&gt; Winter &lt;/Td&gt; &lt;Td&gt; Closing &lt;/Td&gt; &lt;Td&gt; Granato , Cammi Cammi Granato &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Illinois &lt;/Td&gt; &lt;Td&gt; Hockey &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 41 &lt;/Td&gt; &lt;Td&gt; 1998 &lt;/Td&gt; &lt;Td&gt; Winter &lt;/Td&gt; &lt;Td&gt; Opening &lt;/Td&gt; &lt;Td&gt; Flaim , Eric Eric Flaim &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Massachusetts &lt;/Td&gt; &lt;Td&gt; Speed skating &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 40 &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Summer &lt;/Td&gt; &lt;Td&gt; Closing &lt;/Td&gt; &lt;Td&gt; Matz , Michael Michael Matz &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Pennsylvania &lt;/Td&gt; &lt;Td&gt; Equestrian &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 39 &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Summer &lt;/Td&gt; &lt;Td&gt; Opening &lt;/Td&gt; &lt;Td&gt; Baumgartner , Bruce Bruce Baumgartner &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; New Jersey &lt;/Td&gt; &lt;Td&gt; Wrestling &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 38 &lt;/Td&gt; &lt;Td&gt; 1994 &lt;/Td&gt; &lt;Td&gt; Winter &lt;/Td&gt; &lt;Td&gt; Closing &lt;/Td&gt; &lt;Td&gt; Jansen , Dan Dan Jansen &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; Wisconsin &lt;/Td&gt; &lt;Td&gt; Speed skating &lt;/Td&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; 37 &lt;/Td&gt; &lt;Td&gt; 1994 &lt;/Td&gt; &lt;Td&gt; Winter &lt;/Td&gt; &lt;Td&gt; Opening &lt;/Td&gt; &lt;Td&gt; Myler , Cammy Cammy Myler &lt;/Td&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; New York &lt;/Td&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Erin Hamlin carried the USA flag in the opening ceremony.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; Film &lt;/Th&gt; &lt;Th&gt; Year &lt;/Th&gt; &lt;Th&gt; Fuck count &lt;/Th&gt; &lt;Th&gt; Minutes &lt;/Th&gt; &lt;Th&gt; Uses / mi ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; Character &lt;/Th&gt; &lt;Th&gt; Ultimate Avengers &lt;/Th&gt; &lt;Th&gt; Ultimate Avengers 2 &lt;/Th&gt; &lt;Th&gt; I ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; Position &lt;/Th&gt; &lt;Th&gt; Country &lt;/Th&gt; &lt;Th&gt; Town / City &lt;/Th&gt; &lt;Th&gt; PM2. 5 &lt;/Th&gt; &lt;Th&gt; PM ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; Rank &lt;/Th&gt; &lt;Th&gt; Country ( or dependent territory ) &lt;/Th&gt; &lt;Th&gt; Population &lt;/Th&gt; &lt;Th ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; Rank &lt;/Th&gt; &lt;Th&gt; State &lt;/Th&gt; &lt;Th&gt; Gross collections ( in thousands ) &lt;/Th&gt; &lt;Th&gt; Rev ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; Date &lt;/Th&gt; &lt;Th&gt; Province &lt;/Th&gt; &lt;Th&gt; Mag . &lt;/Th&gt; &lt;Th&gt; MMI &lt;/Th&gt; &lt;Th&gt; Deaths &lt;/Th&gt; &lt; ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; City &lt;/Th&gt; &lt;Th&gt; River &lt;/Th&gt; &lt;Th&gt; State &lt;/Th&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; Gangakhed &lt;/Td&gt; &lt;Td&gt;  ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; Player &lt;/Th&gt; &lt;Th&gt; Pos . &lt;/Th&gt; &lt;Th&gt; Team &lt;/Th&gt; &lt;Th&gt; Career start &lt;/Th&gt; &lt;Th&gt; Career  ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; ABO and Rh blood type distribution by country ( population averages ) &lt;Tr&gt; &lt;Th&gt; Country &lt;/Th ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; &lt;/Th&gt; &lt;Th colspan=&quot;3&quot;&gt; Total area &lt;/Th&gt; &lt;Th colspan=&quot;4&quot;&gt; Land area &lt;/Th&gt; &lt;Th colsp ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; Performance in the European Cup and UEFA Champions League by club &lt;Tr&gt; &lt;Th&gt; &lt;Ul&gt; &lt;Li&gt; &lt;/Li&gt;  ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; Rank &lt;/Th&gt; &lt;Th&gt; City &lt;/Th&gt; &lt;Th&gt; State &lt;/Th&gt; &lt;Th&gt; Land area ( sq mi ) &lt;/Th&gt; &lt;Th&gt; La ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; # &lt;/Th&gt; &lt;Th&gt; Country &lt;/Th&gt; &lt;Th&gt; Name &lt;/Th&gt; &lt;Th&gt; International goals &lt;/Th&gt; &lt;Th&gt; Cap ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; Rank &lt;/Th&gt; &lt;Th&gt; City &lt;/Th&gt; &lt;Th&gt; Image &lt;/Th&gt; &lt;Th&gt; Population &lt;/Th&gt; &lt;Th&gt; Definition  ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; Rank &lt;/Th&gt; &lt;Th&gt; Team &lt;/Th&gt; &lt;Th&gt; Won &lt;/Th&gt; &lt;Th&gt; Lost &lt;/Th&gt; &lt;Th&gt; Tied &lt;/Th&gt; &lt;Th&gt; Pct ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; Territory &lt;/Th&gt; &lt;Th&gt; Rights holder &lt;/Th&gt; &lt;Th&gt; Ref &lt;/Th&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; Asia &lt;/Td&gt; ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; ( hide ) Rank &lt;/Th&gt; &lt;Th&gt; Nat &lt;/Th&gt; &lt;Th&gt; Name &lt;/Th&gt; &lt;Th&gt; Years &lt;/Th&gt; &lt;Th&gt; Goals &lt;/T ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; &lt;/Th&gt; &lt;Th colspan=&quot;3&quot;&gt; Total area &lt;/Th&gt; &lt;Th colspan=&quot;4&quot;&gt; Land area &lt;/Th&gt; &lt;Th colsp ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th colspan=&quot;2&quot;&gt; Bids by school &lt;/Th&gt; &lt;Th colspan=&quot;2&quot;&gt; Most recent &lt;/Th&gt; &lt;Th colspan=&quot;2 ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; Rank &lt;/Th&gt; &lt;Th&gt; Name &lt;/Th&gt; &lt;Th&gt; Nation &lt;/Th&gt; &lt;Th&gt; TP &lt;/Th&gt; &lt;Th colspan=&quot;2&quot;&gt; SP &lt;/T ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; 2014 Rank &lt;/Th&gt; &lt;Th&gt; City &lt;/Th&gt; &lt;Th&gt; 2014 Estimate &lt;/Th&gt; &lt;Th&gt; 2010 Census &lt;/Th&gt; &lt;T ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; S.No . &lt;/Th&gt; &lt;Th&gt; Year &lt;/Th&gt; &lt;Th&gt; Name &lt;/Th&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; 1961 &lt;/Td&gt; ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; Densities of various materials covering a range of values &lt;Tr&gt; &lt;Th&gt; Material &lt;/Th&gt; &lt;Th&gt; ρ (  ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; Club &lt;/Th&gt; &lt;Th&gt; Season &lt;/Th&gt; &lt;Th colspan=&quot;3&quot;&gt; League &lt;/Th&gt; &lt;Th colspan=&quot;2&quot;&gt; Nation ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; Rank ( 2016 ) &lt;/Th&gt; &lt;Th&gt; Airports ( large hubs ) &lt;/Th&gt; &lt;Th&gt; IATA Code &lt;/Th&gt; &lt;Th&gt; M ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; City &lt;/Th&gt; &lt;Th&gt; Region / State &lt;/Th&gt; &lt;Th&gt; Country &lt;/Th&gt; &lt;Th&gt; Park name &lt;/Th&gt; &lt;Th&gt;  ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; Year &lt;/Th&gt; &lt;Th&gt; Winner ( nationally ) &lt;/Th&gt; &lt;Th&gt; Votes &lt;/Th&gt; &lt;Th&gt; Percent &lt;/Th&gt; &lt;T ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; Compound &lt;/Th&gt; &lt;Th&gt; SERT &lt;/Th&gt; &lt;Th&gt; NET &lt;/Th&gt; &lt;Th&gt; DAT &lt;/Th&gt; &lt;Th&gt; 5 - HT &lt;/Th&gt; &lt;Th ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; Rank &lt;/Th&gt; &lt;Th&gt; Name &lt;/Th&gt; &lt;Th&gt; Industry &lt;/Th&gt; &lt;Th&gt; Revenue ( USD millions ) &lt;/Th&gt; ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; Rank &lt;/Th&gt; &lt;Th&gt; Name &lt;/Th&gt; &lt;Th&gt; Name in Georgian &lt;/Th&gt; &lt;Th&gt; Population 1989 &lt;/Th&gt;  ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; Country &lt;/Th&gt; &lt;Th colspan=&quot;2&quot;&gt; The World Factbook &lt;/Th&gt; &lt;Th colspan=&quot;2&quot;&gt; World Res ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; Rank &lt;/Th&gt; &lt;Th&gt; Country &lt;/Th&gt; &lt;Th&gt; Area ( km2 ) &lt;/Th&gt; &lt;Th&gt; Notes &lt;/Th&gt; &lt;/Tr&gt; &lt;Tr&gt;  ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; Rank &lt;/Th&gt; &lt;Th&gt; Country &lt;/Th&gt; &lt;Th&gt; Area ( km2 ) &lt;/Th&gt; &lt;Th&gt; Notes &lt;/Th&gt; &lt;/Tr&gt; &lt;Tr&gt;  ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; Date &lt;/Th&gt; &lt;Th&gt; State ( s ) &lt;/Th&gt; &lt;Th&gt; Magnitude &lt;/Th&gt; &lt;Th&gt; Fatalities &lt;/Th&gt; &lt;Th&gt;  ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; Artist &lt;/Th&gt; &lt;Th&gt; # Gold &lt;/Th&gt; &lt;Th&gt; # Platinum &lt;/Th&gt; &lt;Th&gt; # Multi-Platinum &lt;/Th&gt; &lt; ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; &lt;/Th&gt; &lt;Th colspan=&quot;2&quot;&gt; Name &lt;/Th&gt; &lt;Th&gt; Number of locations &lt;/Th&gt; &lt;Th&gt; Revenue &lt;/Th ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; &lt;/Th&gt; &lt;Th&gt; Name &lt;/Th&gt; &lt;Th&gt; Country &lt;/Th&gt; &lt;Th&gt; Region &lt;/Th&gt; &lt;Th&gt; Depth ( meters ) &lt; ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; Rank &lt;/Th&gt; &lt;Th&gt; Player ( 2017 HRs ) &lt;/Th&gt; &lt;Th&gt; HR &lt;/Th&gt; &lt;/Tr&gt; &lt;Tr&gt; &lt;Td&gt; &lt;/Td&gt; &lt;Td&gt; ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &lt;Table&gt; &lt;Tr&gt; &lt;Th&gt; No . &lt;/Th&gt; &lt;Th&gt; Athlete &lt;/Th&gt; &lt;Th&gt; Nation &lt;/Th&gt; &lt;Th&gt; Sport &lt;/Th&gt; &lt;Th&gt; Years &lt;/Th&gt;  ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In this example, questions were directly selected from the dataset.
RetrieveChat was able to answer the questions correctly in the first
attempt as the retrieved context contained the necessary information in
the first two cases. However, in the last three cases, the context with
the highest similarity to the question embedding did not contain the
required information to answer the question. As a result, the LLM model
responded with <code>UPDATE CONTEXT</code>. With the unique and innovative ability
to update context in RetrieveChat, the agent automatically updated the
context and sent it to the LLM model again. After several rounds of this
process, the agent was able to generate the correct answer to the
questions.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-6">Example 6<a href="#example-6" class="hash-link" aria-label="Direct link to Example 6" title="Direct link to Example 6">​</a></h3>
<p><a href="#table-of-contents">Back to top</a></p>
<p>Use RetrieveChat to answer multi-hop questions for
<a href="https://github.com/Alab-NII/2wikimultihop" target="_blank" rel="noopener noreferrer">2WikiMultihopQA</a> dataset
with customized prompt and few-shot learning.</p>
<p>First, we will create a new document collection which includes all the
contextual corpus. Then, we will choose some questions and utilize
RetrieveChat to answer them. For this particular example, we will be
using the <code>gpt-3.5-turbo</code> model, and we will demonstrate RetrieveChat’s
feature of automatically updating context in case the documents
retrieved do not contain sufficient information. Moreover, we’ll
demonstrate how to use customized prompt and few-shot learning to
address tasks that are not pre-defined in RetrieveChat.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">PROMPT_MULTIHOP </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;You&#x27;re a retrieve augmented chatbot. You answer user&#x27;s questions based on your own knowledge and the context provided by the user. You must think step-by-step.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">First, please learn the following examples of context and question pairs and their corresponding answers.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="display:inline-block;color:rgb(195, 232, 141)"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">Context:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">Kurram Garhi: Kurram Garhi is a small village located near the city of Bannu, which is the part of Khyber Pakhtunkhwa province of Pakistan. Its population is approximately 35000.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">Trojkrsti: Trojkrsti is a village in Municipality of Prilep, Republic of Macedonia.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">Q: Are both Kurram Garhi and Trojkrsti located in the same country?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">A: Kurram Garhi is located in the country of Pakistan. Trojkrsti is located in the country of Republic of Macedonia. Thus, they are not in the same country. So the answer is: no.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="display:inline-block;color:rgb(195, 232, 141)"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="display:inline-block;color:rgb(195, 232, 141)"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">Context:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">Early Side of Later: Early Side of Later is the third studio album by English singer- songwriter Matt Goss. It was released on 21 June 2004 by Concept Music and reached No. 78 on the UK Albums Chart.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">What&#x27;s Inside: What&#x27;s Inside is the fourteenth studio album by British singer- songwriter Joan Armatrading.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">Q: Which album was released earlier, What&#x27;S Inside or Cassandra&#x27;S Dream (Album)?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">A: What&#x27;s Inside was released in the year 1995. Cassandra&#x27;s Dream (album) was released in the year 2008. Thus, of the two, the album to release earlier is What&#x27;s Inside. So the answer is: What&#x27;s Inside.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="display:inline-block;color:rgb(195, 232, 141)"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="display:inline-block;color:rgb(195, 232, 141)"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">Context:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">Maria Alexandrovna (Marie of Hesse): Maria Alexandrovna , born Princess Marie of Hesse and by Rhine (8 August 1824 – 3 June 1880) was Empress of Russia as the first wife of Emperor Alexander II.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">Grand Duke Alexei Alexandrovich of Russia: Grand Duke Alexei Alexandrovich of Russia,(Russian: Алексей Александрович; 14 January 1850 (2 January O.S.) in St. Petersburg – 14 November 1908 in Paris) was the fifth child and the fourth son of Alexander II of Russia and his first wife Maria Alexandrovna (Marie of Hesse).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">Q: What is the cause of death of Grand Duke Alexei Alexandrovich Of Russia&#x27;s mother?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">A: The mother of Grand Duke Alexei Alexandrovich of Russia is Maria Alexandrovna. Maria Alexandrovna died from tuberculosis. So the answer is: tuberculosis.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="display:inline-block;color:rgb(195, 232, 141)"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="display:inline-block;color:rgb(195, 232, 141)"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">Context:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">Laughter in Hell: Laughter in Hell is a 1933 American Pre-Code drama film directed by Edward L. Cahn and starring Pat O&#x27;Brien. The film&#x27;s title was typical of the sensationalistic titles of many Pre-Code films.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">Edward L. Cahn: Edward L. Cahn (February 12, 1899 – August 25, 1963) was an American film director.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">Q: When did the director of film Laughter In Hell die?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">A: The film Laughter In Hell was directed by Edward L. Cahn. Edward L. Cahn died on August 25, 1963. So the answer is: August 25, 1963.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="display:inline-block;color:rgb(195, 232, 141)"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">Second, please complete the answer by thinking step-by-step.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="display:inline-block;color:rgb(195, 232, 141)"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">Context:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">{input_context}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">Q: {input_question}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">A:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># create the RetrieveUserProxyAgent instance named &quot;ragproxyagent&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">corpus_file </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://huggingface.co/datasets/thinkall/2WikiMultihopQA/resolve/main/corpus.txt&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Create a new collection for NaturalQuestions dataset</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ragproxyagent </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> RetrieveUserProxyAgent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ragproxyagent&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    human_input_mode</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;NEVER&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    max_consecutive_auto_reply</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    retrieve_config</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;task&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;qa&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;docs_path&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> corpus_file</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;chunk_token_size&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2000</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;model&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> config_list</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;model&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;client&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> chromadb</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">PersistentClient</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">path</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;/tmp/chromadb&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;collection_name&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;2wikimultihopqa&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;chunk_mode&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;one_line&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;embedding_model&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;all-MiniLM-L6-v2&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;customized_prompt&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> PROMPT_MULTIHOP</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;customized_answer_prefix&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;the answer is&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># queries_file = &quot;https://huggingface.co/datasets/thinkall/2WikiMultihopQA/resolve/main/queries.jsonl&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">queries </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;{&quot;_id&quot;: &quot;61a46987092f11ebbdaeac1f6bf848b6&quot;, &quot;text&quot;: &quot;Which film came out first, Blind Shaft or The Mask Of Fu Manchu?&quot;, &quot;metadata&quot;: {&quot;answer&quot;: [&quot;The Mask Of Fu Manchu&quot;]}}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">{&quot;_id&quot;: &quot;a7b9672009c311ebbdb0ac1f6bf848b6&quot;, &quot;text&quot;: &quot;Are North Marion High School (Oregon) and Seoul High School both located in the same country?&quot;, &quot;metadata&quot;: {&quot;answer&quot;: [&quot;no&quot;]}}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">queries </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">json</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">loads</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">line</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> line </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> queries</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">split</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;\n&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> line</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">questions </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">q</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;text&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> q </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> queries</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">answers </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">q</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;metadata&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;answer&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> q </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> queries</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">questions</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">answers</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[&#x27;Which film came out first, Blind Shaft or The Mask Of Fu Manchu?&#x27;, &#x27;Are North Marion High School (Oregon) and Seoul High School both located in the same country?&#x27;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[[&#x27;The Mask Of Fu Manchu&#x27;], [&#x27;no&#x27;]]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> i </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">range</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token builtin" style="color:rgb(130, 170, 255)">len</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">questions</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">f&quot;\n\n&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;  Below are outputs of Case </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string-interpolation interpolation">i</span><span class="token string-interpolation interpolation operator" style="color:rgb(137, 221, 255)">+</span><span class="token string-interpolation interpolation number" style="color:rgb(247, 140, 108)">1</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token string-interpolation string" style="color:rgb(195, 232, 141)">  &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n\n&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># reset the assistant. Always reset the assistant before starting a new conversation.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    assistant</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">reset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    qa_problem </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> questions</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    chat_result </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> ragproxyagent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">initiate_chat</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        assistant</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> message</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">ragproxyagent</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">message_generator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> problem</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">qa_problem</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> n_results</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;  Below are outputs of Case 1  &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Trying to create collection.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">doc_ids:  [[&#x27;doc_12&#x27;, &#x27;doc_11&#x27;, &#x27;doc_16&#x27;, &#x27;doc_19&#x27;, &#x27;doc_13116&#x27;, &#x27;doc_14&#x27;, &#x27;doc_13&#x27;, &#x27;doc_18&#x27;, &#x27;doc_977&#x27;, &#x27;doc_10&#x27;]]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_12 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_11 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_16 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_19 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_13116 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_14 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_13 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_18 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_977 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_10 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You&#x27;re a retrieve augmented chatbot. You answer user&#x27;s questions based on your own knowledge and the context provided by the user. You must think step-by-step.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">First, please learn the following examples of context and question pairs and their corresponding answers.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Kurram Garhi: Kurram Garhi is a small village located near the city of Bannu, which is the part of Khyber Pakhtunkhwa province of Pakistan. Its population is approximately 35000.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Trojkrsti: Trojkrsti is a village in Municipality of Prilep, Republic of Macedonia.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Q: Are both Kurram Garhi and Trojkrsti located in the same country?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">A: Kurram Garhi is located in the country of Pakistan. Trojkrsti is located in the country of Republic of Macedonia. Thus, they are not in the same country. So the answer is: no.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Early Side of Later: Early Side of Later is the third studio album by English singer- songwriter Matt Goss. It was released on 21 June 2004 by Concept Music and reached No. 78 on the UK Albums Chart.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">What&#x27;s Inside: What&#x27;s Inside is the fourteenth studio album by British singer- songwriter Joan Armatrading.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Q: Which album was released earlier, What&#x27;S Inside or Cassandra&#x27;S Dream (Album)?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">A: What&#x27;s Inside was released in the year 1995. Cassandra&#x27;s Dream (album) was released in the year 2008. Thus, of the two, the album to release earlier is What&#x27;s Inside. So the answer is: What&#x27;s Inside.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Maria Alexandrovna (Marie of Hesse): Maria Alexandrovna , born Princess Marie of Hesse and by Rhine (8 August 1824 – 3 June 1880) was Empress of Russia as the first wife of Emperor Alexander II.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Grand Duke Alexei Alexandrovich of Russia: Grand Duke Alexei Alexandrovich of Russia,(Russian: Алексей Александрович; 14 January 1850 (2 January O.S.) in St. Petersburg – 14 November 1908 in Paris) was the fifth child and the fourth son of Alexander II of Russia and his first wife Maria Alexandrovna (Marie of Hesse).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Q: What is the cause of death of Grand Duke Alexei Alexandrovich Of Russia&#x27;s mother?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">A: The mother of Grand Duke Alexei Alexandrovich of Russia is Maria Alexandrovna. Maria Alexandrovna died from tuberculosis. So the answer is: tuberculosis.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Laughter in Hell: Laughter in Hell is a 1933 American Pre-Code drama film directed by Edward L. Cahn and starring Pat O&#x27;Brien. The film&#x27;s title was typical of the sensationalistic titles of many Pre-Code films.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Edward L. Cahn: Edward L. Cahn (February 12, 1899 – August 25, 1963) was an American film director.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Q: When did the director of film Laughter In Hell die?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">A: The film Laughter In Hell was directed by Edward L. Cahn. Edward L. Cahn died on August 25, 1963. So the answer is: August 25, 1963.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Second, please complete the answer by thinking step-by-step.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">The Mask of Fu Manchu: The Mask of Fu Manchu is a 1932 pre-Code adventure film directed by Charles Brabin. It was written by Irene Kuhn, Edgar Allan Woolf and John Willard based on the 1932 novel of the same name by Sax Rohmer. Starring Boris Karloff as Fu Manchu, and featuring Myrna Loy as his depraved daughter, the movie revolves around Fu Manchu&#x27;s quest for the golden sword and mask of Genghis Khan. Lewis Stone plays his nemesis. Dr. Petrie is absent from this film.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">The Mysterious Dr. Fu Manchu: The Mysterious Dr. Fu Manchu is a 1929 American pre-Code drama film directed by Rowland V. Lee and starring Warner Oland as Dr. Fu Manchu. It was the first Fu Manchu film of the talkie era. Since this was during the transition period to sound, a silent version was also released in the United States.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">The Face of Fu Manchu: The Face of Fu Manchu is a 1965 thriller film directed by Don Sharp and based on the characters created by Sax Rohmer. It stars Christopher Lee as the eponymous villain, a Chinese criminal mastermind, and Nigel Green as his pursuing rival Nayland Smith, a Scotland Yard detective. The film was a British- West German co-production, and was the first in a five- part series starring Lee and produced by Harry Alan Towers for Constantin Film, the second of which was&quot; The Brides of Fu Manchu&quot; released the next year, with the final entry being&quot; The Castle of Fu Manchu&quot; in 1969. It was shot in Technicolor and Techniscope, on- location in County Dublin, Ireland.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">The Return of Dr. Fu Manchu: The Return of Dr. Fu Manchu is a 1930 American pre-Code film directed by Rowland V. Lee. It is the second of three films starring Warner Oland as the fiendish Fu Manchu, who returns from apparent death in the previous film,&quot; The Mysterious Dr. Fu Manchu&quot;( 1929), to seek revenge on those he holds responsible for the death of his wife and child.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">The Vengeance of Fu Manchu: The Vengeance of Fu Manchu is a 1967 British film directed by Jeremy Summers and starring Christopher Lee, Horst Frank, Douglas Wilmer and Tsai Chin. It was the third British/ West German Constantin Film co-production of the Dr. Fu Manchu series and the first to be filmed in Hong Kong. It was generally released in the U.K. through Warner- Pathé( as a support feature to the Lindsay Shonteff film&quot; The Million Eyes of Sumuru&quot;) on 3 December 1967.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">The Brides of Fu Manchu: The Brides of Fu Manchu is a 1966 British/ West German Constantin Film co-production adventure crime film based on the fictional Chinese villain Dr. Fu Manchu, created by Sax Rohmer. It was the second film in a series, and was preceded by&quot; The Face of Fu ManchuThe Vengeance of Fu Manchu&quot; followed in 1967,&quot; The Blood of Fu Manchu&quot; in 1968, and&quot; The Castle of Fu Manchu&quot; in 1969. It was produced by Harry Alan Towers for Hallam Productions. Like the first film, it was directed by Don Sharp, and starred Christopher Lee as Fu Manchu. Nigel Green was replaced by Douglas Wilmer as Scotland Yard detective Nayland Smith. The action takes place mainly in London, where much of the location filming took place.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">The Castle of Fu Manchu: The Castle of Fu Manchu( also known as The Torture Chamber of Dr. Fu Manchu and also known by its German title Die Folterkammer des Dr. Fu Man Chu) is a 1969 film and the fifth and final Dr. Fu Manchu film with Christopher Lee portraying the title character.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">The Blood of Fu Manchu: The Blood of Fu Manchu, also known as Fu Manchu and the Kiss of Death, Kiss of Death, Kiss and Kill( U.S. title) and Against All Odds( original U.S. video title), is a 1968 British adventure crime film directed by Jesús Franco, based on the fictional Asian villain Dr. Fu Manchu created by Sax Rohmer. It was the fourth film in a series, and was preceded by&quot; The Vengeance of Fu Manchu The Castle of Fu Manchu&quot; followed in 1969. It was produced by Harry Alan Towers for Udastex Films. It starred Christopher Lee as Dr. Fu Manchu, Richard Greene as Scotland Yard detective Nayland Smith, and Howard Marion- Crawford as Dr. Petrie. The movie was filmed in Spain and Brazil. Shirley Eaton appears in a scene that she claimed she was never paid for; apparently, the director Jesús Franco had inserted some stock footage of her from one of her films(&quot; The Girl from Rio&quot;( 1968)) into the film without telling her. She only found out years later that she had been in a Fu Manchu film.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Don Sharp: Donald Herman Sharp( 19 April 192114 December 2011) was an Australian- born British film director. His best known films were made for Hammer in the 1960s, and included&quot; The Kiss of the Vampire&quot;( 1962) and&quot; Rasputin, the Mad Monk&quot;( 1966). In 1965 he directed&quot; The Face of Fu Manchu&quot;, based on the character created by Sax Rohmer, and starring Christopher Lee. Sharp also directed the sequel&quot; The Brides of Fu Manchu&quot;( 1966). In the 1980s he was also responsible for several hugely popular miniseries adapted from the novels of Barbara Taylor Bradford.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Blind Shaft: Blind Shaft is a 2003 film about a pair of brutal con artists operating in the illegal coal mines of present- day northern China. The film was written and directed by Li Yang( 李杨), and is based on Chinese writer Liu Qingbang&#x27;s short novel&quot; Shen MuSacred Wood&quot;).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Q: Which film came out first, Blind Shaft or The Mask Of Fu Manchu?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">A:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_11 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_16 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_19 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_13116 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_14 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_13 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_18 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_977 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_10 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You&#x27;re a retrieve augmented chatbot. You answer user&#x27;s questions based on your own knowledge and the context provided by the user. You must think step-by-step.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">First, please learn the following examples of context and question pairs and their corresponding answers.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Kurram Garhi: Kurram Garhi is a small village located near the city of Bannu, which is the part of Khyber Pakhtunkhwa province of Pakistan. Its population is approximately 35000.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Trojkrsti: Trojkrsti is a village in Municipality of Prilep, Republic of Macedonia.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Q: Are both Kurram Garhi and Trojkrsti located in the same country?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">A: Kurram Garhi is located in the country of Pakistan. Trojkrsti is located in the country of Republic of Macedonia. Thus, they are not in the same country. So the answer is: no.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Early Side of Later: Early Side of Later is the third studio album by English singer- songwriter Matt Goss. It was released on 21 June 2004 by Concept Music and reached No. 78 on the UK Albums Chart.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">What&#x27;s Inside: What&#x27;s Inside is the fourteenth studio album by British singer- songwriter Joan Armatrading.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Q: Which album was released earlier, What&#x27;S Inside or Cassandra&#x27;S Dream (Album)?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">A: What&#x27;s Inside was released in the year 1995. Cassandra&#x27;s Dream (album) was released in the year 2008. Thus, of the two, the album to release earlier is What&#x27;s Inside. So the answer is: What&#x27;s Inside.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Maria Alexandrovna (Marie of Hesse): Maria Alexandrovna , born Princess Marie of Hesse and by Rhine (8 August 1824 – 3 June 1880) was Empress of Russia as the first wife of Emperor Alexander II.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Grand Duke Alexei Alexandrovich of Russia: Grand Duke Alexei Alexandrovich of Russia,(Russian: Алексей Александрович; 14 January 1850 (2 January O.S.) in St. Petersburg – 14 November 1908 in Paris) was the fifth child and the fourth son of Alexander II of Russia and his first wife Maria Alexandrovna (Marie of Hesse).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Q: What is the cause of death of Grand Duke Alexei Alexandrovich Of Russia&#x27;s mother?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">A: The mother of Grand Duke Alexei Alexandrovich of Russia is Maria Alexandrovna. Maria Alexandrovna died from tuberculosis. So the answer is: tuberculosis.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Laughter in Hell: Laughter in Hell is a 1933 American Pre-Code drama film directed by Edward L. Cahn and starring Pat O&#x27;Brien. The film&#x27;s title was typical of the sensationalistic titles of many Pre-Code films.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Edward L. Cahn: Edward L. Cahn (February 12, 1899 – August 25, 1963) was an American film director.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Q: When did the director of film Laughter In Hell die?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">A: The film Laughter In Hell was directed by Edward L. Cahn. Edward L. Cahn died on August 25, 1963. So the answer is: August 25, 1963.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Second, please complete the answer by thinking step-by-step.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">The Mask of Fu Manchu: The Mask of Fu Manchu is a 1932 pre-Code adventure film directed by Charles Brabin. It was written by Irene Kuhn, Edgar Allan Woolf and John Willard based on the 1932 novel of the same name by Sax Rohmer. Starring Boris Karloff as Fu Manchu, and featuring Myrna Loy as his depraved daughter, the movie revolves around Fu Manchu&#x27;s quest for the golden sword and mask of Genghis Khan. Lewis Stone plays his nemesis. Dr. Petrie is absent from this film.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">The Mysterious Dr. Fu Manchu: The Mysterious Dr. Fu Manchu is a 1929 American pre-Code drama film directed by Rowland V. Lee and starring Warner Oland as Dr. Fu Manchu. It was the first Fu Manchu film of the talkie era. Since this was during the transition period to sound, a silent version was also released in the United States.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">The Face of Fu Manchu: The Face of Fu Manchu is a 1965 thriller film directed by Don Sharp and based on the characters created by Sax Rohmer. It stars Christopher Lee as the eponymous villain, a Chinese criminal mastermind, and Nigel Green as his pursuing rival Nayland Smith, a Scotland Yard detective. The film was a British- West German co-production, and was the first in a five- part series starring Lee and produced by Harry Alan Towers for Constantin Film, the second of which was&quot; The Brides of Fu Manchu&quot; released the next year, with the final entry being&quot; The Castle of Fu Manchu&quot; in 1969. It was shot in Technicolor and Techniscope, on- location in County Dublin, Ireland.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">The Return of Dr. Fu Manchu: The Return of Dr. Fu Manchu is a 1930 American pre-Code film directed by Rowland V. Lee. It is the second of three films starring Warner Oland as the fiendish Fu Manchu, who returns from apparent death in the previous film,&quot; The Mysterious Dr. Fu Manchu&quot;( 1929), to seek revenge on those he holds responsible for the death of his wife and child.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">The Vengeance of Fu Manchu: The Vengeance of Fu Manchu is a 1967 British film directed by Jeremy Summers and starring Christopher Lee, Horst Frank, Douglas Wilmer and Tsai Chin. It was the third British/ West German Constantin Film co-production of the Dr. Fu Manchu series and the first to be filmed in Hong Kong. It was generally released in the U.K. through Warner- Pathé( as a support feature to the Lindsay Shonteff film&quot; The Million Eyes of Sumuru&quot;) on 3 December 1967.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">The Brides of Fu Manchu: The Brides of Fu Manchu is a 1966 British/ West German Constantin Film co-production adventure crime film based on the fictional Chinese villain Dr. Fu Manchu, created by Sax Rohmer. It was the second film in a series, and was preceded by&quot; The Face of Fu ManchuThe Vengeance of Fu Manchu&quot; followed in 1967,&quot; The Blood of Fu Manchu&quot; in 1968, and&quot; The Castle of Fu Manchu&quot; in 1969. It was produced by Harry Alan Towers for Hallam Productions. Like the first film, it was directed by Don Sharp, and starred Christopher Lee as Fu Manchu. Nigel Green was replaced by Douglas Wilmer as Scotland Yard detective Nayland Smith. The action takes place mainly in London, where much of the location filming took place.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">The Castle of Fu Manchu: The Castle of Fu Manchu( also known as The Torture Chamber of Dr. Fu Manchu and also known by its German title Die Folterkammer des Dr. Fu Man Chu) is a 1969 film and the fifth and final Dr. Fu Manchu film with Christopher Lee portraying the title character.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">The Blood of Fu Manchu: The Blood of Fu Manchu, also known as Fu Manchu and the Kiss of Death, Kiss of Death, Kiss and Kill( U.S. title) and Against All Odds( original U.S. video title), is a 1968 British adventure crime film directed by Jesús Franco, based on the fictional Asian villain Dr. Fu Manchu created by Sax Rohmer. It was the fourth film in a series, and was preceded by&quot; The Vengeance of Fu Manchu The Castle of Fu Manchu&quot; followed in 1969. It was produced by Harry Alan Towers for Udastex Films. It starred Christopher Lee as Dr. Fu Manchu, Richard Greene as Scotland Yard detective Nayland Smith, and Howard Marion- Crawford as Dr. Petrie. The movie was filmed in Spain and Brazil. Shirley Eaton appears in a scene that she claimed she was never paid for; apparently, the director Jesús Franco had inserted some stock footage of her from one of her films(&quot; The Girl from Rio&quot;( 1968)) into the film without telling her. She only found out years later that she had been in a Fu Manchu film.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Don Sharp: Donald Herman Sharp( 19 April 192114 December 2011) was an Australian- born British film director. His best known films were made for Hammer in the 1960s, and included&quot; The Kiss of the Vampire&quot;( 1962) and&quot; Rasputin, the Mad Monk&quot;( 1966). In 1965 he directed&quot; The Face of Fu Manchu&quot;, based on the character created by Sax Rohmer, and starring Christopher Lee. Sharp also directed the sequel&quot; The Brides of Fu Manchu&quot;( 1966). In the 1980s he was also responsible for several hugely popular miniseries adapted from the novels of Barbara Taylor Bradford.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Blind Shaft: Blind Shaft is a 2003 film about a pair of brutal con artists operating in the illegal coal mines of present- day northern China. The film was written and directed by Li Yang( 李杨), and is based on Chinese writer Liu Qingbang&#x27;s short novel&quot; Shen MuSacred Wood&quot;).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Q: Which film came out first, Blind Shaft or The Mask Of Fu Manchu?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">A:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Blind Shaft is a 2003 film while The Mask of Fu Manchu is a 1932 pre-Code adventure film. Thus, The Mask of Fu Manchu came out earlier than Blind Shaft. So the answer is: The Mask of Fu Manchu.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;  Below are outputs of Case 2  &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)"></span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">doc_ids:  [[&#x27;doc_74&#x27;, &#x27;doc_76&#x27;, &#x27;doc_68&#x27;, &#x27;doc_42890&#x27;, &#x27;doc_75&#x27;, &#x27;doc_19596&#x27;, &#x27;doc_45135&#x27;, &#x27;doc_995&#x27;, &#x27;doc_7274&#x27;, &#x27;doc_23187&#x27;]]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_74 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_76 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_68 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_42890 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_75 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_19596 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_45135 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_995 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_7274 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_23187 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You&#x27;re a retrieve augmented chatbot. You answer user&#x27;s questions based on your own knowledge and the context provided by the user. You must think step-by-step.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">First, please learn the following examples of context and question pairs and their corresponding answers.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Kurram Garhi: Kurram Garhi is a small village located near the city of Bannu, which is the part of Khyber Pakhtunkhwa province of Pakistan. Its population is approximately 35000.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Trojkrsti: Trojkrsti is a village in Municipality of Prilep, Republic of Macedonia.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Q: Are both Kurram Garhi and Trojkrsti located in the same country?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">A: Kurram Garhi is located in the country of Pakistan. Trojkrsti is located in the country of Republic of Macedonia. Thus, they are not in the same country. So the answer is: no.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Early Side of Later: Early Side of Later is the third studio album by English singer- songwriter Matt Goss. It was released on 21 June 2004 by Concept Music and reached No. 78 on the UK Albums Chart.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">What&#x27;s Inside: What&#x27;s Inside is the fourteenth studio album by British singer- songwriter Joan Armatrading.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Q: Which album was released earlier, What&#x27;S Inside or Cassandra&#x27;S Dream (Album)?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">A: What&#x27;s Inside was released in the year 1995. Cassandra&#x27;s Dream (album) was released in the year 2008. Thus, of the two, the album to release earlier is What&#x27;s Inside. So the answer is: What&#x27;s Inside.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Maria Alexandrovna (Marie of Hesse): Maria Alexandrovna , born Princess Marie of Hesse and by Rhine (8 August 1824 – 3 June 1880) was Empress of Russia as the first wife of Emperor Alexander II.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Grand Duke Alexei Alexandrovich of Russia: Grand Duke Alexei Alexandrovich of Russia,(Russian: Алексей Александрович; 14 January 1850 (2 January O.S.) in St. Petersburg – 14 November 1908 in Paris) was the fifth child and the fourth son of Alexander II of Russia and his first wife Maria Alexandrovna (Marie of Hesse).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Q: What is the cause of death of Grand Duke Alexei Alexandrovich Of Russia&#x27;s mother?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">A: The mother of Grand Duke Alexei Alexandrovich of Russia is Maria Alexandrovna. Maria Alexandrovna died from tuberculosis. So the answer is: tuberculosis.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Laughter in Hell: Laughter in Hell is a 1933 American Pre-Code drama film directed by Edward L. Cahn and starring Pat O&#x27;Brien. The film&#x27;s title was typical of the sensationalistic titles of many Pre-Code films.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Edward L. Cahn: Edward L. Cahn (February 12, 1899 – August 25, 1963) was an American film director.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Q: When did the director of film Laughter In Hell die?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">A: The film Laughter In Hell was directed by Edward L. Cahn. Edward L. Cahn died on August 25, 1963. So the answer is: August 25, 1963.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Second, please complete the answer by thinking step-by-step.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Seoul High School: Seoul High School( Hangul: 서울고등학교) is a public high school located in the heart of Seoul, South Korea.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">North Marion High School (Oregon): North Marion High School is a public high school in Aurora, Oregon, United States. The school is part of the North Marion School District with all four schools being located on the same campus. The school draws students from the cities of Aurora, Hubbard, and Donald as well as the communities of Broadacres and Butteville.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Marion High School (Kansas): Marion High School is a public high school in Marion, Kansas, USA. It is one of three schools operated by Marion USD 408, and is the sole high school in the district.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Northwest High School: Northwest High School or North West High School may refer to:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Marion High School (Indiana): Marion High School is a high school in Marion, Indiana with more than 1,000 students.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Macon County High School: Macon County High School is located in Montezuma, Georgia, United States, which is a part of Macon County. Enrollment as of the 2017- 2018 school year is 491.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Canyon High School (Ogden, Utah): Canyon High School was a high school in Ogden, Utah.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Northside High School: Northside High School or North Side High School or Northside Christian School or similar can refer to:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Springs Boys&#x27; High School: Springs Boys&#x27; High School is a high school in Springs, Gauteng, South Africa.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">International School of Koje: International School of Koje( ISK) is a privately funded international school located in Geoje, South Korea.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Q: Are North Marion High School (Oregon) and Seoul High School both located in the same country?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">A:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">No, North Marion High School (Oregon) is located in the United States, specifically in the state of Oregon, while Seoul High School is located in South Korea. So they are not in the same country.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Updating context and resetting conversation.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">doc_ids:  [[&#x27;doc_76&#x27;, &#x27;doc_68&#x27;, &#x27;doc_74&#x27;, &#x27;doc_75&#x27;, &#x27;doc_19596&#x27;, &#x27;doc_42890&#x27;, &#x27;doc_24819&#x27;, &#x27;doc_69&#x27;, &#x27;doc_995&#x27;, &#x27;doc_7274&#x27;]]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_24819 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Adding doc_id doc_69 to context.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">You&#x27;re a retrieve augmented chatbot. You answer user&#x27;s questions based on your own knowledge and the context provided by the user. You must think step-by-step.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">First, please learn the following examples of context and question pairs and their corresponding answers.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Kurram Garhi: Kurram Garhi is a small village located near the city of Bannu, which is the part of Khyber Pakhtunkhwa province of Pakistan. Its population is approximately 35000.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Trojkrsti: Trojkrsti is a village in Municipality of Prilep, Republic of Macedonia.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Q: Are both Kurram Garhi and Trojkrsti located in the same country?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">A: Kurram Garhi is located in the country of Pakistan. Trojkrsti is located in the country of Republic of Macedonia. Thus, they are not in the same country. So the answer is: no.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Early Side of Later: Early Side of Later is the third studio album by English singer- songwriter Matt Goss. It was released on 21 June 2004 by Concept Music and reached No. 78 on the UK Albums Chart.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">What&#x27;s Inside: What&#x27;s Inside is the fourteenth studio album by British singer- songwriter Joan Armatrading.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Q: Which album was released earlier, What&#x27;S Inside or Cassandra&#x27;S Dream (Album)?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">A: What&#x27;s Inside was released in the year 1995. Cassandra&#x27;s Dream (album) was released in the year 2008. Thus, of the two, the album to release earlier is What&#x27;s Inside. So the answer is: What&#x27;s Inside.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Maria Alexandrovna (Marie of Hesse): Maria Alexandrovna , born Princess Marie of Hesse and by Rhine (8 August 1824 – 3 June 1880) was Empress of Russia as the first wife of Emperor Alexander II.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Grand Duke Alexei Alexandrovich of Russia: Grand Duke Alexei Alexandrovich of Russia,(Russian: Алексей Александрович; 14 January 1850 (2 January O.S.) in St. Petersburg – 14 November 1908 in Paris) was the fifth child and the fourth son of Alexander II of Russia and his first wife Maria Alexandrovna (Marie of Hesse).</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Q: What is the cause of death of Grand Duke Alexei Alexandrovich Of Russia&#x27;s mother?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">A: The mother of Grand Duke Alexei Alexandrovich of Russia is Maria Alexandrovna. Maria Alexandrovna died from tuberculosis. So the answer is: tuberculosis.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Laughter in Hell: Laughter in Hell is a 1933 American Pre-Code drama film directed by Edward L. Cahn and starring Pat O&#x27;Brien. The film&#x27;s title was typical of the sensationalistic titles of many Pre-Code films.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Edward L. Cahn: Edward L. Cahn (February 12, 1899 – August 25, 1963) was an American film director.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Q: When did the director of film Laughter In Hell die?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">A: The film Laughter In Hell was directed by Edward L. Cahn. Edward L. Cahn died on August 25, 1963. So the answer is: August 25, 1963.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Second, please complete the answer by thinking step-by-step.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Context:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Seoul High School: Seoul High School( Hangul: 서울고등학교) is a public high school located in the heart of Seoul, South Korea.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">North Marion High School (Oregon): North Marion High School is a public high school in Aurora, Oregon, United States. The school is part of the North Marion School District with all four schools being located on the same campus. The school draws students from the cities of Aurora, Hubbard, and Donald as well as the communities of Broadacres and Butteville.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Marion High School (Kansas): Marion High School is a public high school in Marion, Kansas, USA. It is one of three schools operated by Marion USD 408, and is the sole high school in the district.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Northwest High School: Northwest High School or North West High School may refer to:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Marion High School (Indiana): Marion High School is a high school in Marion, Indiana with more than 1,000 students.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Macon County High School: Macon County High School is located in Montezuma, Georgia, United States, which is a part of Macon County. Enrollment as of the 2017- 2018 school year is 491.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Canyon High School (Ogden, Utah): Canyon High School was a high school in Ogden, Utah.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Northside High School: Northside High School or North Side High School or Northside Christian School or similar can refer to:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Springs Boys&#x27; High School: Springs Boys&#x27; High School is a high school in Springs, Gauteng, South Africa.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">International School of Koje: International School of Koje( ISK) is a privately funded international school located in Geoje, South Korea.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Anderson High School (Anderson, Indiana): Anderson High School is a public high school located in Anderson, Indiana.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">North Marion High School (West Virginia): North Marion High School is a public Double A (&quot;AA&quot;) high school in the U.S. state of West Virginia, with a current enrollment of 851 students. North Marion High School is located approximately 4 miles from Farmington, West Virginia on US Route 250 north. While it is closer to the city of Mannington, West Virginia, and is often considered to be located in Rachel, West Virginia, the school mailing address is Farmington. Rachel is a small coal mining community located adjacent to the school, and is an unincorporated municipality. North Marion High School is represented as &quot;Grantville High School&quot; in the popular alternative history novel &quot;1632&quot; by writer Eric Flint. The novel is set in the fictional town of Grantville, which is based on the real town and surroundings of Mannington.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Q: Are North Marion High School (Oregon) and Seoul High School both located in the same country?</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">A:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">assistant</span><span class="token message-id"> </span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token message-id keyword" style="font-style:italic">to</span><span class="token message-id"> </span><span class="token message-id class-name" style="color:rgb(255, 203, 107)">ragproxyagent</span><span class="token message-id punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token message-id">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">North Marion High School (Oregon) is located in the country of United States. Seoul High School is located in the country of South Korea. Thus, they are not in the same country. So the answer is: no.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">--------------------------------------------------------------------------------</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Clyde Thompson: Clyde Thompson( 1910 – July 1, 1979) was an American prisoner turned chaplain. He is ...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">max_tokens is too small to fit a single line of text. Breaking this line:</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Australian Historical Monographs: The Australian Historical Monographs are a series of Historical st ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/autogen/docs/tags/rag">RAG</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/microsoft/autogen/edit/main/notebook/agentchat_RetrieveChat.ipynb" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/autogen/docs/notebooks/JSON_mode_example"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Mitigating Prompt hacking with JSON Mode in Autogen</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/autogen/docs/notebooks/agentchat_RetrieveChat_mongodb"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Using RetrieveChat Powered by MongoDB Atlas for Retrieve Augmented Code Generation and Question Answering</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#table-of-contents" class="table-of-contents__link toc-highlight">Table of Contents</a></li><li><a href="#set-your-api-endpoint" class="table-of-contents__link toc-highlight">Set your API Endpoint</a></li><li><a href="#construct-agents-for-retrievechat" class="table-of-contents__link toc-highlight">Construct agents for RetrieveChat</a><ul><li><a href="#example-1" class="table-of-contents__link toc-highlight">Example 1</a></li><li><a href="#example-2" class="table-of-contents__link toc-highlight">Example 2</a></li><li><a href="#example-3" class="table-of-contents__link toc-highlight">Example 3</a></li><li><a href="#example-4" class="table-of-contents__link toc-highlight">Example 4</a></li><li><a href="#example-5" class="table-of-contents__link toc-highlight">Example 5</a></li><li><a href="#example-6" class="table-of-contents__link toc-highlight">Example 6</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://aka.ms/autogen-dc" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/pyautogen" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 AutoGen Authors |  <a target="_blank" style="color:#10adff" href="https://go.microsoft.com/fwlink/?LinkId=521839">Privacy and Cookies</a></div></div></div></footer></div>
</body>
</html>